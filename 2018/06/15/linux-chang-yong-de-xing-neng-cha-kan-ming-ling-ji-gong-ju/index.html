<!-- build time:Sun Dec 03 2023 14:39:06 GMT+0800 (GMT+08:00) --><!DOCTYPE html><html class="theme-next gemini use-motion" lang="zh-Hans"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1"><script src="//cdn.bootcss.com/pace/1.0.2/pace.min.js"></script><link href="//cdn.bootcss.com/pace/1.0.2/themes/pink/pace-theme-flash.css" rel="stylesheet"><script></script><meta name="theme-color" content="#222"><style>.pace .pace-progress{background:#1E92FB;height:3px}.pace .pace-progress-inner{box-shadow:0 0 10px #1E92FB,0 0 5px #1E92FB}.pace .pace-activity{border-top-color:#1E92FB;border-left-color:#1E92FB}</style><meta http-equiv="Cache-Control" content="no-transform"><meta http-equiv="Cache-Control" content="no-siteapp"><meta name="google-site-verification" content="HGM141IpbHrSmnAmR6W_zE4bo9Z3f-yXLeHYT3bg1fk"><meta name="baidu-site-verification" content="code-5Ai1DA8e6T"><link href="/lib/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css"><link href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css"><link href="/css/main.css?v=5.1.4" rel="stylesheet" type="text/css"><link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png?v=5.1.4"><link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png?v=5.1.4"><link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png?v=5.1.4"><link rel="mask-icon" href="/images/logo.svg?v=5.1.4" color="#222"><meta name="keywords" content="Linux,"><link rel="alternate" href="/atom.xml" title="凡间的精灵" type="application/atom+xml"><meta name="description" content="1 、常用的命令及工具1.1 常用的查看系统性能的命令及工具（后面会有相关命令及工具的用法）1.1.1 查看CPU使用情况每5秒刷新一次，最右侧有CPU的占用率的数据1$ vmstat 5top 然后按Shift+P，按照进程处理器占用率排序1$ top1.1.2 查看内存使用情况用free命令查看内存占用情况1$ freetop 然后按Shift+M, 按照进程内存占用率排序1$ top1.1."><meta name="keywords" content="Linux"><meta property="og:type" content="article"><meta property="og:title" content="Linux常用的性能查看命令及工具"><meta property="og:url" content="http:&#x2F;&#x2F;chenzhonzhou.github.io&#x2F;2018&#x2F;06&#x2F;15&#x2F;linux-chang-yong-de-xing-neng-cha-kan-ming-ling-ji-gong-ju&#x2F;index.html"><meta property="og:site_name" content="凡间的精灵"><meta property="og:description" content="1 、常用的命令及工具1.1 常用的查看系统性能的命令及工具（后面会有相关命令及工具的用法）1.1.1 查看CPU使用情况每5秒刷新一次，最右侧有CPU的占用率的数据1$ vmstat 5top 然后按Shift+P，按照进程处理器占用率排序1$ top1.1.2 查看内存使用情况用free命令查看内存占用情况1$ freetop 然后按Shift+M, 按照进程内存占用率排序1$ top1.1."><meta property="og:locale" content="zh-Hans"><meta property="og:image" content="http:&#x2F;&#x2F;chenzhonzhou.github.io&#x2F;2018&#x2F;06&#x2F;15&#x2F;linux-chang-yong-de-xing-neng-cha-kan-ming-ling-ji-gong-ju&#x2F;%E5%9B%BE%E7%89%871.png"><meta property="og:image" content="http:&#x2F;&#x2F;chenzhonzhou.github.io&#x2F;2018&#x2F;06&#x2F;15&#x2F;linux-chang-yong-de-xing-neng-cha-kan-ming-ling-ji-gong-ju&#x2F;%E5%9B%BE%E7%89%872.png"><meta property="og:image" content="http:&#x2F;&#x2F;chenzhonzhou.github.io&#x2F;2018&#x2F;06&#x2F;15&#x2F;linux-chang-yong-de-xing-neng-cha-kan-ming-ling-ji-gong-ju&#x2F;%E5%9B%BE%E7%89%873.png"><meta property="og:image" content="http:&#x2F;&#x2F;chenzhonzhou.github.io&#x2F;2018&#x2F;06&#x2F;15&#x2F;linux-chang-yong-de-xing-neng-cha-kan-ming-ling-ji-gong-ju&#x2F;%E5%9B%BE%E7%89%874.png"><meta property="og:image" content="http:&#x2F;&#x2F;chenzhonzhou.github.io&#x2F;2018&#x2F;06&#x2F;15&#x2F;linux-chang-yong-de-xing-neng-cha-kan-ming-ling-ji-gong-ju&#x2F;%E5%9B%BE%E7%89%875.png"><meta property="og:image" content="http:&#x2F;&#x2F;chenzhonzhou.github.io&#x2F;2018&#x2F;06&#x2F;15&#x2F;linux-chang-yong-de-xing-neng-cha-kan-ming-ling-ji-gong-ju&#x2F;%E5%9B%BE%E7%89%876.png"><meta property="og:image" content="http:&#x2F;&#x2F;chenzhonzhou.github.io&#x2F;2018&#x2F;06&#x2F;15&#x2F;linux-chang-yong-de-xing-neng-cha-kan-ming-ling-ji-gong-ju&#x2F;%E5%9B%BE%E7%89%877.png"><meta property="og:image" content="http:&#x2F;&#x2F;chenzhonzhou.github.io&#x2F;2018&#x2F;06&#x2F;15&#x2F;linux-chang-yong-de-xing-neng-cha-kan-ming-ling-ji-gong-ju&#x2F;%E5%9B%BE%E7%89%878.png"><meta property="og:image" content="http:&#x2F;&#x2F;chenzhonzhou.github.io&#x2F;2018&#x2F;06&#x2F;15&#x2F;linux-chang-yong-de-xing-neng-cha-kan-ming-ling-ji-gong-ju&#x2F;%E5%9B%BE%E7%89%879.png"><meta property="og:image" content="http:&#x2F;&#x2F;chenzhonzhou.github.io&#x2F;2018&#x2F;06&#x2F;15&#x2F;linux-chang-yong-de-xing-neng-cha-kan-ming-ling-ji-gong-ju&#x2F;%E5%9B%BE%E7%89%8710.png"><meta property="og:image" content="http:&#x2F;&#x2F;chenzhonzhou.github.io&#x2F;2018&#x2F;06&#x2F;15&#x2F;linux-chang-yong-de-xing-neng-cha-kan-ming-ling-ji-gong-ju&#x2F;%E5%9B%BE%E7%89%8711.png"><meta property="og:image" content="http:&#x2F;&#x2F;chenzhonzhou.github.io&#x2F;2018&#x2F;06&#x2F;15&#x2F;linux-chang-yong-de-xing-neng-cha-kan-ming-ling-ji-gong-ju&#x2F;%E5%9B%BE%E7%89%8712.png"><meta property="og:image" content="http:&#x2F;&#x2F;chenzhonzhou.github.io&#x2F;2018&#x2F;06&#x2F;15&#x2F;linux-chang-yong-de-xing-neng-cha-kan-ming-ling-ji-gong-ju&#x2F;%E5%9B%BE%E7%89%8713.png"><meta property="og:image" content="http:&#x2F;&#x2F;chenzhonzhou.github.io&#x2F;2018&#x2F;06&#x2F;15&#x2F;linux-chang-yong-de-xing-neng-cha-kan-ming-ling-ji-gong-ju&#x2F;%E5%9B%BE%E7%89%8714.png"><meta property="og:updated_time" content="2019-11-14T08:49:13.115Z"><meta name="twitter:card" content="summary"><meta name="twitter:image" content="http:&#x2F;&#x2F;chenzhonzhou.github.io&#x2F;2018&#x2F;06&#x2F;15&#x2F;linux-chang-yong-de-xing-neng-cha-kan-ming-ling-ji-gong-ju&#x2F;%E5%9B%BE%E7%89%871.png"><script type="text/javascript" id="hexo.configurations">var NexT=window.NexT||{},CONFIG={root:"/",scheme:"Gemini",version:"5.1.4",sidebar:{position:"left",display:"always",offset:12,b2t:!0,scrollpercent:!0,onmobile:!0},fancybox:!0,tabs:!0,motion:{enable:!0,async:!1,transition:{post_block:"fadeIn",post_header:"slideDownIn",post_body:"slideDownIn",coll_header:"slideLeftIn",sidebar:"slideUpIn"}},duoshuo:{userId:"0",author:"博主"},algolia:{applicationID:"",apiKey:"",indexName:"",hits:{per_page:10},labels:{input_placeholder:"Search for Posts",hits_empty:"We didn't find any results for the search: ${query}",hits_stats:"${hits} results found in ${time} ms"}}}</script><link rel="canonical" href="http://chenzhonzhou.github.io/2018/06/15/linux-chang-yong-de-xing-neng-cha-kan-ming-ling-ji-gong-ju/"><title>Linux常用的性能查看命令及工具 | 凡间的精灵</title><link rel="stylesheet" href="/css/prism-tomorrow.css" type="text/css"></head><body itemscope itemtype="http://schema.org/WebPage" lang="zh-Hans"><div class="container sidebar-position-left page-post-detail"><div class="headband"></div><header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader"><div class="header-inner"><div class="site-brand-wrapper"><div class="site-meta"><div class="custom-logo-site-title"><a href="/" class="brand" rel="start"><span class="logo-line-before"><i></i></span> <span class="site-title">凡间的精灵</span> <span class="logo-line-after"><i></i></span></a></div><p class="site-subtitle">凡尘落素一精灵</p></div><div class="site-nav-toggle"><button><span class="btn-bar"></span> <span class="btn-bar"></span> <span class="btn-bar"></span></button></div></div><nav class="site-nav"><ul id="menu" class="menu"><li class="menu-item menu-item-home"><a href="/" rel="section"><i class="menu-item-icon fa fa-fw fa-home"></i><br>首页</a></li><li class="menu-item menu-item-archives"><a href="/archives/" rel="section"><i class="menu-item-icon fa fa-fw fa-archive"></i><br>归档</a></li><li class="menu-item menu-item-categories"><a href="/categories" rel="section"><i class="menu-item-icon fa fa-fw fa-th"></i><br>分类</a></li><li class="menu-item menu-item-tags"><a href="/tags" rel="section"><i class="menu-item-icon fa fa-fw fa-tags"></i><br>标签</a></li><li class="menu-item menu-item-sitemap"><a href="/sitemap.xml" rel="section"><i class="menu-item-icon fa fa-fw fa-sitemap"></i><br>站点地图</a></li><li class="menu-item menu-item-search"><a href="javascript:;" class="popup-trigger"><i class="menu-item-icon fa fa-search fa-fw"></i><br>搜索</a></li></ul><div class="site-search"><div class="popup search-popup local-search-popup"><div class="local-search-header clearfix"><span class="search-icon"><i class="fa fa-search"></i> </span><span class="popup-btn-close"><i class="fa fa-times-circle"></i></span><div class="local-search-input-wrapper"><input autocomplete="off" placeholder="搜索..." spellcheck="false" type="text" id="local-search-input"></div></div><div id="local-search-result"></div></div></div></nav></div></header><main id="main" class="main"><div class="main-inner"><div class="content-wrap"><div id="content" class="content"><div id="posts" class="posts-expand"><article class="post post-type-normal" itemscope itemtype="http://schema.org/Article"><div class="post-block"><link itemprop="mainEntityOfPage" href="http://chenzhonzhou.github.io/2018/06/15/linux-chang-yong-de-xing-neng-cha-kan-ming-ling-ji-gong-ju/"><span hidden itemprop="author" itemscope itemtype="http://schema.org/Person"><meta itemprop="name" content="Zhongzhou Chen"><meta itemprop="description" content=""><meta itemprop="image" content="/images/chen.png"></span><span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization"><meta itemprop="name" content="凡间的精灵"></span><header class="post-header"><h1 class="post-title" itemprop="name headline">Linux常用的性能查看命令及工具</h1><div class="post-meta"><span class="post-time"><span class="post-meta-item-icon"><i class="fa fa-calendar-o"></i> </span><span class="post-meta-item-text">发表于</span> <time title="创建于" itemprop="dateCreated datePublished" datetime="2018-06-15T15:08:17+08:00">2018-06-15 </time></span><span class="post-category"><span class="post-meta-divider">|</span> <span class="post-meta-item-icon"><i class="fa fa-folder-o"></i> </span><span class="post-meta-item-text">分类于</span> <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/Linux/" itemprop="url" rel="index"><span itemprop="name">Linux</span></a></span></span><div class="post-wordcount"><span class="post-meta-item-icon"><i class="fa fa-file-word-o"></i> </span><span class="post-meta-item-text">字数统计&#58;</span> <span title="字数统计">12.3k </span><span class="post-meta-divider">|</span> <span class="post-meta-item-icon"><i class="fa fa-clock-o"></i> </span><span class="post-meta-item-text">阅读时长 &asymp;</span> <span title="阅读时长">54</span></div></div></header><div class="post-body" itemprop="articleBody"><h2 id="1-、常用的命令及工具"><a href="#1-、常用的命令及工具" class="headerlink" title="1 、常用的命令及工具"></a>1 、常用的命令及工具</h2><h3 id="1-1-常用的查看系统性能的命令及工具"><a href="#1-1-常用的查看系统性能的命令及工具" class="headerlink" title="1.1 常用的查看系统性能的命令及工具"></a>1.1 常用的查看系统性能的命令及工具</h3><p>（后面会有相关命令及工具的用法）</p><h4 id="1-1-1-查看CPU使用情况"><a href="#1-1-1-查看CPU使用情况" class="headerlink" title="1.1.1 查看CPU使用情况"></a>1.1.1 查看CPU使用情况</h4><p>每5秒刷新一次，最右侧有CPU的占用率的数据</p><figure class="highlight plain"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ vmstat 5</span><br></pre></td></tr></tbody></table></figure><p>top 然后按Shift+P，按照进程处理器占用率排序</p><figure class="highlight plain"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ top</span><br></pre></td></tr></tbody></table></figure><h4 id="1-1-2-查看内存使用情况"><a href="#1-1-2-查看内存使用情况" class="headerlink" title="1.1.2 查看内存使用情况"></a>1.1.2 查看内存使用情况</h4><p>用free命令查看内存占用情况</p><figure class="highlight plain"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ free</span><br></pre></td></tr></tbody></table></figure><p>top 然后按Shift+M, 按照进程内存占用率排序</p><figure class="highlight plain"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ top</span><br></pre></td></tr></tbody></table></figure><h4 id="1-1-3-查看网络流量"><a href="#1-1-3-查看网络流量" class="headerlink" title="1.1.3 查看网络流量"></a>1.1.3 查看网络流量</h4><p>可以用工具iptraf工具</p><figure class="highlight plain"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ iptraf -g</span><br></pre></td></tr></tbody></table></figure><p>针对某个Interface的网络流量可以通过比较两个时间网络接口的RX和TX数据来获得</p><figure class="highlight plain"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">$ date; ifconfig eth1</span><br><span class="line">$ date; ifconfig eth1</span><br></pre></td></tr></tbody></table></figure><h4 id="1-1-4-查看磁盘i-o"><a href="#1-1-4-查看磁盘i-o" class="headerlink" title="1.1.4 查看磁盘i/o"></a>1.1.4 查看磁盘i/o</h4><p>用iostat查看磁盘/dev/sdc3的磁盘i/o情况，每两秒刷新一次</p><figure class="highlight plain"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ iostat -d -x /dev/sdc3 2</span><br></pre></td></tr></tbody></table></figure><p>用vmstat查看io部分的信息</p><h3 id="1-2-Linux-查看CPU，内存，硬盘"><a href="#1-2-Linux-查看CPU，内存，硬盘" class="headerlink" title="1.2 Linux 查看CPU，内存，硬盘"></a>1.2 Linux 查看CPU，内存，硬盘</h3><h4 id="1-2-1-查看CPU"><a href="#1-2-1-查看CPU" class="headerlink" title="1.2.1 查看CPU"></a>1.2.1 查看CPU</h4><p><strong>查看CPU个数</strong></p><figure class="highlight plain"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">cat /proc/cpuinfo | grep "physical id" | uniq | wc -l</span><br><span class="line"></span><br><span class="line">2</span><br></pre></td></tr></tbody></table></figure><p>uniq命令：删除重复行；wc –l命令：统计行数<br>总结：该服务器有2颗CPU</p><p><strong>查看CPU核数</strong></p><figure class="highlight plain"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">cat /proc/cpuinfo | grep "cpu cores" | uniq</span><br><span class="line"></span><br><span class="line">cpu cores : 4</span><br></pre></td></tr></tbody></table></figure><p>总结：该服务器CPU的核心数为4</p><p><strong>查看CPU型号</strong></p><figure class="highlight plain"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">cat /proc/cpuinfo | grep 'model name' |uniq</span><br><span class="line"></span><br><span class="line">model name : Intel(R) Xeon(R) CPU E5630 @ 2.53GHz</span><br></pre></td></tr></tbody></table></figure><p>总结：该服务器有2个4核CPU，型号Intel(R) Xeon(R) CPU E5630 @ 2.53GHz</p><h4 id="1-2-2-查看内存"><a href="#1-2-2-查看内存" class="headerlink" title="1.2.2 查看内存"></a>1.2.2 查看内存</h4><p><strong>查看内存总数</strong></p><figure class="highlight plain"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">#cat /proc/meminfo | grep MemTotal</span><br><span class="line">MemTotal: 4001826 kB</span><br></pre></td></tr></tbody></table></figure><p>总结：该服务器内存大小为4G</p><p>查看内存条数<br>具体个数大小：dmidecode|grep -P -A5 “Memory\s+Device”|grep Size|grep -v Range</p><figure class="highlight plain"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">dmidecode |grep -A16 "Memory Device$"</span><br></pre></td></tr></tbody></table></figure><blockquote><p>Memory Device<br>Array Handle: 0x1000<br>Error Information Handle: Not Provided<br>Total Width: 72 bits<br>Data Width: 64 bits<br><font color="Blue"><strong>Size: 2048 MB //1条2G内存</strong></font><br>Form Factor: DIMM<br>Set: 1<br>Locator: DIMM1<br>Bank Locator: Not Specified<br>Type: DDR2<br>Type Detail: Synchronous<br>Speed: 667 MHz<br>Manufacturer: 7F7F7F7F7F510000<br>Serial Number: 0403E324<br>Asset Tag: 450721</p><p>Part Number: 72T256220HR3SA</p><p>Memory Device<br>Array Handle: 0x1000<br>Error Information Handle: Not Provided<br>Total Width: 72 bits<br>Data Width: 64 bits<br><font color="Blue"><strong>Size: 2048 MB //1条2G内存</strong></font><br>Form Factor: DIMM<br>Set: 1<br>Locator: DIMM2<br>Bank Locator: Not Specified<br>Type: DDR2<br>Type Detail: Synchronous<br>Speed: 667 MHz<br>Manufacturer: 7F7F7F7F7F510000<br>Serial Number: 0403E324<br>Asset Tag: 450721</p><p>Part Number: 72T256220HR3SA</p><p>Memory Device<br>Array Handle: 0x1000<br>Error Information Handle: Not Provided<br>Total Width: 72 bits<br>Data Width: 64 bits<br><font color="Blue"><strong>Size: No Module Installed //1个内存空槽</strong></font><br>Form Factor: DIMM<br>Set: 2<br>Locator: DIMM3<br>Bank Locator: Not Specified<br>Type: DDR2<br>Type Detail: Synchronous<br>Speed: Unknown<br>Manufacturer:<br>Serial Number:<br>Asset Tag:</p><p>Part Number:</p><p>Memory Device<br>Array Handle: 0x1000<br>Error Information Handle: Not Provided<br>Total Width: 72 bits<br>Data Width: 64 bits<br><font color="Blue"><strong>Size: No Module Installed //1个内存空槽</strong></font><br>Form Factor: DIMM<br>Set: 2<br>Locator: DIMM4<br>Bank Locator: Not Specified<br>Type: DDR2<br>Type Detail: Synchronous<br>Speed: Unknown<br>Manufacturer:<br>Serial Number:<br>Asset Tag:</p><p>Part Number:</p><p>Memory Device<br>Array Handle: 0x1000<br>Error Information Handle: Not Provided<br>Total Width: 72 bits<br>Data Width: 64 bits<br><font color="Blue"><strong>Size: No Module Installed //1个内存空槽</strong></font><br>Form Factor: DIMM<br>Set: 3<br>Locator: DIMM5<br>Bank Locator: Not Specified<br>Type: DDR2<br>Type Detail: Synchronous<br>Speed: Unknown<br>Manufacturer:<br>Serial Number:<br>Asset Tag:</p><p>Part Number:</p><p>Memory Device<br>Array Handle: 0x1000<br>Error Information Handle: Not Provided<br>Total Width: 72 bits<br>Data Width: 64 bits<br><font color="Blue"><strong>Size: No Module Installed //1个内存空槽</strong></font><br>Form Factor: DIMM<br>Set: 3<br>Locator: DIMM6<br>Bank Locator: Not Specified<br>Type: DDR2<br>Type Detail: Synchronous<br>Speed: Unknown<br>Manufacturer:<br>Serial Number:<br>Asset Tag:<br>Part Number:</p></blockquote><p>总结：该服务器有两条2G内存 ，空余4个插槽</p><h4 id="1-2-3-查看硬盘"><a href="#1-2-3-查看硬盘" class="headerlink" title="1.2.3 查看硬盘"></a>1.2.3 查看硬盘</h4><p>查看硬盘大小</p><figure class="highlight plain"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">fdisk -l | grep Disk</span><br><span class="line"></span><br><span class="line">Disk /dev/sda: 107.4 GB, 107374182400 bytes, 209715200 sectors</span><br><span class="line">Disk label type: dos</span><br><span class="line">Disk identifier: 0x0005efd6</span><br><span class="line">Disk /dev/mapper/centos-root: 53.7 GB, 53687091200 bytes, 104857600 sectors</span><br><span class="line">Disk /dev/mapper/centos-swap: 2147 MB, 2147483648 bytes, 4194304 sectors</span><br><span class="line">Disk /dev/mapper/centos-home: 50.9 GB, 50944016384 bytes, 99500032 sectors</span><br><span class="line">Disk /dev/mapper/docker-253:0-204147193-pool: 107.4 GB, 107374182400 bytes, 209715200 sectors</span><br></pre></td></tr></tbody></table></figure><p>总结：硬盘大小107.4G，即厂商标称的120G</p><h2 id="2、常用命令及工具的用法"><a href="#2、常用命令及工具的用法" class="headerlink" title="2、常用命令及工具的用法"></a>2、常用命令及工具的用法</h2><h3 id="2-1-top"><a href="#2-1-top" class="headerlink" title="2.1 top"></a>2.1 top</h3><p><strong>Top命令显示当天的正常运行时间、系统负载、处理器的数量、内存的使用率和哪些进程使用了大多数CPU资源</strong>（包括每个进程的大量相关信息，例如在线用户和正在执行的命令等）。默认地，TOP命令每隔五分钟自动更新一次这个数据（这个更新间隔是可设置的）。</p><p><img src="/2018/06/15/linux-chang-yong-de-xing-neng-cha-kan-ming-ling-ji-gong-ju/%E5%9B%BE%E7%89%871.png" alt="image-20191114160404283"></p><p><strong>第一行：</strong><br><strong>10:01:23</strong> 当前系统时间<br><strong>126 days</strong>, 14:29 系统已经运行了126天14小时29分钟（在这期间没有重启过）<br><strong>2 users</strong> 当前有2个用户登录系统<br><strong>load average</strong>: 1.15, 1.42, 1.44 load average后面的三个数分别是1分钟、5分钟、15分钟的负载情况。<br><strong>load average</strong>数据是每隔5秒钟检查一次活跃的进程数，然后按特定算法计算出的数值。如果这个数除以逻辑CPU的数量，结果高于5的时候就表明系统在超负荷运转了。</p><p><strong>第二行：</strong><br><strong>Tasks</strong> 任务（进程），系统现在共有183个进程，其中处于运行中的有1个，182个在休眠（sleep），stoped状态的有0个，zombie状态（僵尸）的有0个。</p><p><strong>第三行：cpu状态</strong><br><strong>6.7% us</strong> 用户空间占用CPU的百分比。<br><strong>0.4% sy</strong> 内核空间占用CPU的百分比。<br><strong>0.0% ni</strong> 改变过优先级的进程占用CPU的百分比<br><strong>92.9% id</strong> 空闲CPU百分比<br><strong>0.0% wa</strong> IO等待占用CPU的百分比<br><strong>0.0% hi</strong> 硬中断（Hardware IRQ）占用CPU的百分比<br><strong>0.0% si</strong> 软中断（Software Interrupts）占用CPU的百分比</p><p><strong>第四行：内存状态</strong><br>8306544k total 物理内存总量（8GB）<br>7775876k used 使用中的内存总量（7.7GB）<br>530668k free 空闲内存总量（530M）<br>79236k buffers 缓存的内存量 （79M）</p><p><strong>第五行：swap交换分区</strong><br>2031608k total 交换区总量（2GB）<br>2556k used 使用的交换区总量（2.5M）<br>2029052k free 空闲交换区总量（2GB）<br>4231276k cached 缓冲的交换区总量（4GB）</p><h3 id="2-2-vmstat"><a href="#2-2-vmstat" class="headerlink" title="2.2 vmstat"></a>2.2 vmstat</h3><p>vmstat是Virtual Meomory Statistics（虚拟内存统计）的缩写, 是实时系统监控工具。该命令通过使用knlist子程序和/dev/kmen伪设备驱动器访问这些数据，输出信息直接打印在屏幕。vmstat反馈的与CPU相关的信息包括：<br>（1）多少任务在运行<br>（2）CPU使用的情况<br>（3）CPU收到多少中断<br>（4）发生多少上下文切换<br>Vmstat命令提供给你一个当前CPU、IO、进程和内存使用率的快照。和TOP命令一样，它自动动态刷新，并且可以用下面的命令执行：</p><h4 id="2-2-1-命令格式"><a href="#2-2-1-命令格式" class="headerlink" title="2.2.1 命令格式"></a>2.2.1 命令格式</h4><p>代码如下:</p><p>vmstat [-a] [-n] [-S unit] [delay [ count]]<br>vmstat [-s] [-n] [-S unit]<br>vmstat [-m] [-n] [delay [ count]]<br>vmstat [-d] [-n] [delay [ count]]<br>vmstat [-p disk partition] [-n] [delay [ count]]<br>vmstat [-f]<br>vmstat [-V]<br>命令功能：<br>用来显示虚拟内存的信息</p><h4 id="2-2-2-命令参数"><a href="#2-2-2-命令参数" class="headerlink" title="2.2.2 命令参数"></a>2.2.2 命令参数</h4><p><strong>-a</strong>：显示活跃和非活跃内存<br><strong>-f</strong>：显示从系统启动至今的fork数量 。<br><strong>-m</strong>：显示slabinfo<br><strong>-n</strong>：只在开始时显示一次各字段名称。<br><strong>-s</strong>：显示内存相关统计信息及多种系统活动数量。<br><strong>delay</strong>：刷新时间间隔。如果不指定，只显示一条结果。<br><strong>count</strong>：刷新次数。如果不指定刷新次数，但指定了刷新时间间隔，这时刷新次数为无穷。<br><strong>-d</strong>：显示磁盘相关统计信息。<br><strong>-p</strong>：显示指定磁盘分区统计信息<br><strong>-S</strong>：使用指定单位显示。参数有 k 、K 、m 、M ，分别代表1000、1024、1000000、1048576字节（byte）。默认单位为K（1024 bytes）<br><strong>-V</strong>：显示vmstat版本信息。</p><h4 id="2-2-3-使用实例"><a href="#2-2-3-使用实例" class="headerlink" title="2.2.3 使用实例"></a>2.2.3 使用实例</h4><h5 id="2-2-3-1-显示虚拟内存使用情况"><a href="#2-2-3-1-显示虚拟内存使用情况" class="headerlink" title="2.2.3.1 显示虚拟内存使用情况"></a>2.2.3.1 显示虚拟内存使用情况</h5><p>命令：vmstat</p><figure class="highlight plain"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">[root@localhost ~]# vmstat 5 6</span><br><span class="line">procs -----------memory---------- ---swap-- -----io---- --system-- -----cpu------</span><br><span class="line">r b swpd free buff cache si so bi bo in cs us sy id wa st</span><br><span class="line">0 0 0 3029876 199616 690980 0 0 0 2 3 2 0 0 100 0 0</span><br><span class="line">0 0 0 3029752 199616 690980 0 0 0 41 1009 39 0 0 100 0 0</span><br><span class="line">0 0 0 3029752 199616 690980 0 0 0 3 1004 36 0 0 100 0 0</span><br><span class="line">0 0 0 3029752 199616 690980 0 0 0 4 1004 36 0 0 100 0 0</span><br><span class="line">0 0 0 3029752 199616 690980 0 0 0 6 1003 33 0 0 100 0 0 </span><br><span class="line">0 0 0 3029752 199616 690980 0 0 0 5 1003 33 0 0 100 0 0</span><br></pre></td></tr></tbody></table></figure><p><strong>vmstat命令输出信息详细说明：</strong><br>字段说明：<br><strong>Procs</strong>（进程）：<br><strong>r</strong>: 运行队列中进程数量<br><strong>b</strong>: 等待IO的进程数量<br><strong>Memory</strong>（内存）：<br><strong>swpd</strong>: 使用虚拟内存大小<br><strong>free</strong>: 可用内存大小<br><strong>buff</strong>: 用作缓冲的内存大小<br><strong>cache</strong>: 用作缓存的内存大小<br><strong>Swap</strong>：<br><strong>si</strong>: 每秒从交换区写到内存的大小<br><strong>so</strong>: 每秒写入交换区的内存大小<br><strong>IO</strong>：（现在的Linux版本块的大小为1024bytes）<br><strong>bi</strong>: 每秒读取的块数<br><strong>bo</strong>: 每秒写入的块数<br>系统：<br><strong>in</strong>: 每秒中断数，包括时钟中断。<br><strong>cs</strong>: 每秒上下文切换数。<br><strong>CPU</strong>（以百分比表示）：<br><strong>us</strong>: 用户进程执行时间(user time)<br><strong>sy</strong>: 系统进程执行时间(system time)<br><strong>id</strong>: 空闲时间(包括IO等待时间),中央处理器的空闲时间 。以百分比表示。<br><strong>wa</strong>: 等待IO时间<br>备注： 如果 r经常大于 4 ，且id经常少于40，表示cpu的负荷很重。如果pi，po 长期不等于0，表示内存不足。如果disk 经常不等于0， 且在 b中的队列 大于3， 表示 io性能不好。Linux在具有高稳定性、可靠性的同时，具有很好的可伸缩性和扩展性，能够针对不同的应用和硬件环境调整，优化出满足当前应用需要的最佳性能。因此企业在维护Linux系统、进行系统调优时，了解系统性能分析工具是至关重要的。<br>命令：vmstat 5 5<br>表示在5秒时间内进行5次采样。将得到一个数据汇总他能够反映真正的系统情况。</p><h5 id="2-2-3-2-显示活跃和非活跃内存"><a href="#2-2-3-2-显示活跃和非活跃内存" class="headerlink" title="2.2.3.2 显示活跃和非活跃内存"></a>2.2.3.2 显示活跃和非活跃内存</h5><p>命令：vmstat -a 2 5</p><figure class="highlight plain"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">[root@localhost ~]# vmstat -a 2 5</span><br><span class="line">procs -----------memory---------- ---swap-- -----io---- --system-- -----cpu------</span><br><span class="line">r b swpd free inact active si so bi bo in cs us sy id wa st</span><br><span class="line">0 0 0 3029752 387728 513008 0 0 0 2 3 2 0 0 100 0 0</span><br><span class="line">0 0 0 3029752 387728 513076 0 0 0 0 1005 34 0 0 100 0 0</span><br><span class="line">0 0 0 3029752 387728 513076 0 0 0 22 1004 36 0 0 100 0 0</span><br><span class="line">0 0 0 3029752 387728 513076 0 0 0 0 1004 33 0 0 100 0 0</span><br><span class="line">0 0 0 3029752 387728 513076 0 0 0 0 1003 32 0 0 100 0 0</span><br></pre></td></tr></tbody></table></figure><p><strong>说明：</strong><br>使用-a选项显示活跃和非活跃内存时，所显示的内容除增加inact和active外，其他显示内容与例子1相同。<br>字段说明：<br><strong>Memory</strong>（内存）：<br><strong>inact</strong>: 非活跃内存大小（当使用-a选项时显示）<br><strong>active</strong>: 活跃的内存大小（当使用-a选项时显示）</p><h5 id="2-3-3-3-查看系统已经fork了多少次"><a href="#2-3-3-3-查看系统已经fork了多少次" class="headerlink" title="2.3.3.3 查看系统已经fork了多少次"></a>2.3.3.3 查看系统已经fork了多少次</h5><p>命令：vmstat –f</p><figure class="highlight plain"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">[root@SCF1129 ~]# vmstat -f</span><br><span class="line">12744849 forks</span><br><span class="line">[root@SCF1129 ~]#</span><br></pre></td></tr></tbody></table></figure><p><strong>说明：</strong><br>这个数据是从/proc/stat中的processes字段里取得的</p><h5 id="2-3-3-4-查看内存使用的详细信息"><a href="#2-3-3-4-查看内存使用的详细信息" class="headerlink" title="2.3.3.4 查看内存使用的详细信息"></a>2.3.3.4 查看内存使用的详细信息</h5><p>命令：vmstat -s</p><figure class="highlight plain"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line">[root@localhost ~]# vmstat -s</span><br><span class="line">4043760 total memory</span><br><span class="line">1013884 used memory</span><br><span class="line">513012 active memory</span><br><span class="line">387728 inactive memory</span><br><span class="line">3029876 free memory</span><br><span class="line">199616 buffer memory</span><br><span class="line">690980 swap cache</span><br><span class="line">6096656 total swap</span><br><span class="line">0 used swap</span><br><span class="line">6096656 free swap</span><br><span class="line">83587 non-nice user cpu ticks</span><br><span class="line">132 nice user cpu ticks</span><br><span class="line">278599 system cpu ticks</span><br><span class="line">913344692 idle cpu ticks</span><br><span class="line">814550 IO-wait cpu ticks</span><br><span class="line">10547 IRQ cpu ticks</span><br><span class="line">21261 softirq cpu ticks</span><br><span class="line">0 stolen cpu ticks</span><br><span class="line">310215 pages paged in</span><br><span class="line">14254652 pages paged out</span><br><span class="line">0 pages swapped in</span><br><span class="line">0 pages swapped out</span><br><span class="line">288374745 interrupts</span><br><span class="line">146680577 CPU context switches</span><br><span class="line">1351868832 boot time</span><br><span class="line">367291 forks</span><br></pre></td></tr></tbody></table></figure><p><strong>说明：</strong><br>这些信息的分别来自于/proc/meminfo,/proc/stat和/proc/vmstat。</p><h5 id="2-3-3-5-查看磁盘的读-写"><a href="#2-3-3-5-查看磁盘的读-写" class="headerlink" title="2.3.3.5 查看磁盘的读/写"></a>2.3.3.5 查看磁盘的读/写</h5><p>命令：vmstat –d</p><figure class="highlight plain"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">[root@localhost ~]# vmstat -d</span><br><span class="line">disk- ------------reads------------ ------------writes----------- -----IO------</span><br><span class="line">total merged sectors ms total merged sectors ms cur sec</span><br><span class="line">ram0 0 0 0 0 0 0 0 0 0 0</span><br><span class="line">ram1 0 0 0 0 0 0 0 0 0 0</span><br><span class="line">ram2 0 0 0 0 0 0 0 0 0 0</span><br><span class="line">ram3 0 0 0 0 0 0 0 0 0 0</span><br><span class="line">ram4 0 0 0 0 0 0 0 0 0 0</span><br><span class="line">ram5 0 0 0 0 0 0 0 0 0 0</span><br><span class="line">ram6 0 0 0 0 0 0 0 0 0 0</span><br><span class="line">ram7 0 0 0 0 0 0 0 0 0 0</span><br><span class="line">ram8 0 0 0 0 0 0 0 0 0 0</span><br><span class="line">ram9 0 0 0 0 0 0 0 0 0 0</span><br><span class="line">ram10 0 0 0 0 0 0 0 0 0 0</span><br><span class="line">ram11 0 0 0 0 0 0 0 0 0 0</span><br><span class="line">ram12 0 0 0 0 0 0 0 0 0 0</span><br><span class="line">ram13 0 0 0 0 0 0 0 0 0 0</span><br><span class="line">ram14 0 0 0 0 0 0 0 0 0 0</span><br><span class="line">ram15 0 0 0 0 0 0 0 0 0 0</span><br><span class="line">sda 33381 6455 615407 63224 2068111 1495416 28508288 15990289 0 10491</span><br><span class="line">hdc 0 0 0 0 0 0 0 0 0 0</span><br><span class="line">fd0 0 0 0 0 0 0 0 0 0 0</span><br><span class="line">md0 0 0 0 0 0 0 0 0 0 0</span><br><span class="line">[root@localhost ~]#</span><br></pre></td></tr></tbody></table></figure><p><strong>说明：</strong><br>这些信息主要来自于/proc/diskstats.<br>merged:表示一次来自于合并的写/读请求,一般系统会把多个连接/邻近的读/写请求合并到一起来操作.</p><h5 id="2-3-3-6-查看-dev-sda1磁盘的读-写"><a href="#2-3-3-6-查看-dev-sda1磁盘的读-写" class="headerlink" title="2.3.3.6 查看/dev/sda1磁盘的读/写"></a>2.3.3.6 查看/dev/sda1磁盘的读/写</h5><p>命令：vmstat -p /dev/sda1</p><figure class="highlight plain"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[root@SCF1129 ~]# df</span><br></pre></td></tr></tbody></table></figure><p>文件系统 1K-块 已用 可用 已用% 挂载点<br>/dev/sda3 1119336548 27642068 1034835500 3% /tmpfs 32978376 0 32978376 0% /dev/shm<br>/dev/sda1 1032088 59604 920056 7% /boot</p><figure class="highlight plain"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">[root@SCF1129 ~]# vmstat -p /dev/sda1</span><br><span class="line">sda1 reads read sectors writes requested writes</span><br><span class="line">18607 4249978 6 48[root@SCF1129 ~]# vmstat -p /dev/sda3</span><br><span class="line">sda3 reads read sectors writes requested writes</span><br><span class="line">429350 35176268 28998789 980301488[root@SCF1129 ~]#</span><br></pre></td></tr></tbody></table></figure><p><strong>说明：</strong><br>这些信息主要来自于/proc/diskstats。<br><strong>reads：</strong>来自于这个分区的读的次数。<br><strong>read sectors：</strong>来自于这个分区的读扇区的次数。<br><strong>writes</strong>：来自于这个分区的写的次数。<br>r<strong>equested writes：</strong>来自于这个分区的写请求次数。</p><h5 id="2-3-3-7-查看系统的slab信息"><a href="#2-3-3-7-查看系统的slab信息" class="headerlink" title="2.3.3.7 查看系统的slab信息"></a>2.3.3.7 查看系统的slab信息</h5><p>命令：vmstat –m</p><figure class="highlight plain"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br></pre></td><td class="code"><pre><span class="line">[root@localhost ~]# vmstat -m</span><br><span class="line">Cache Num Total Size Pages</span><br><span class="line">ip_conntrack_expect 0 0 136 28</span><br><span class="line">ip_conntrack 3 13 304 13</span><br><span class="line">ip_fib_alias 11 59 64 59</span><br><span class="line">ip_fib_hash 11 59 64 59</span><br><span class="line">AF_VMCI 0 0 960 4</span><br><span class="line">bio_map_info 100 105 1064 7</span><br><span class="line">dm_mpath 0 0 1064 7</span><br><span class="line">jbd_4k 0 0 4096 1</span><br><span class="line">dm_uevent 0 0 2608 3</span><br><span class="line">dm_tio 0 0 24 144</span><br><span class="line">dm_io 0 0 48 77</span><br><span class="line">scsi_cmd_cache 10 10 384 10</span><br><span class="line">sgpool-128 32 32 4096 1</span><br><span class="line">sgpool-64 32 32 2048 2</span><br><span class="line">sgpool-32 32 32 1024 4</span><br><span class="line">sgpool-16 32 32 512 8</span><br><span class="line">sgpool-8 45 45 256 15</span><br><span class="line">scsi_io_context 0 0 112 34</span><br><span class="line">ext3_inode_cache 51080 51105 760 5</span><br><span class="line">ext3_xattr 36 88 88 44</span><br><span class="line">journal_handle 18 144 24 144</span><br><span class="line">journal_head 56 80 96 40</span><br><span class="line">revoke_table 4 202 16 202</span><br><span class="line">revoke_record 0 0 32 112</span><br><span class="line">uhci_urb_priv 0 0 56 67</span><br><span class="line">UNIX 13 33 704 11</span><br><span class="line">flow_cache 0 0 128 30</span><br><span class="line">msi_cache 33 59 64 59</span><br><span class="line">cfq_ioc_pool 14 90 128 30</span><br><span class="line">cfq_pool 12 90 216 18</span><br><span class="line">crq_pool 16 96 80 48</span><br><span class="line">deadline_drq 0 0 80 48</span><br><span class="line">as_arq 0 0 96 40</span><br><span class="line">mqueue_inode_cache 1 4 896 4</span><br><span class="line">isofs_inode_cache 0 0 608 6</span><br><span class="line">hugetlbfs_inode_cache 1 7 576 7</span><br><span class="line">Cache Num Total Size Pages</span><br><span class="line">ext2_inode_cache 0 0 720 5</span><br><span class="line">ext2_xattr 0 0 88 44</span><br><span class="line">dnotify_cache 0 0 40 92</span><br><span class="line">dquot 0 0 256 15</span><br><span class="line">eventpoll_pwq 3 53 72 53</span><br><span class="line">eventpoll_epi 3 20 192 20</span><br><span class="line">inotify_event_cache 0 0 40 92</span><br><span class="line">inotify_watch_cache 1 53 72 53</span><br><span class="line">kioctx 0 0 320 12</span><br><span class="line">kiocb 0 0 256 15</span><br><span class="line">fasync_cache 0 0 24 144</span><br><span class="line">shmem_inode_cache 254 290 768 5</span><br><span class="line">posix_timers_cache 0 0 128 30</span><br><span class="line">uid_cache 0 0 128 30</span><br><span class="line">ip_mrt_cache 0 0 128 30</span><br><span class="line">tcp_bind_bucket 3 112 32 112</span><br><span class="line">inet_peer_cache 0 0 128 30</span><br><span class="line">secpath_cache 0 0 64 59</span><br><span class="line">xfrm_dst_cache 0 0 384 10</span><br><span class="line">ip_dst_cache 5 10 384 10</span><br><span class="line">arp_cache 1 15 256 15</span><br><span class="line">RAW 3 5 768 5</span><br><span class="line">UDP 5 10 768 5</span><br><span class="line">tw_sock_TCP 0 0 192 20</span><br><span class="line">request_sock_TCP 0 0 128 30</span><br><span class="line">TCP 4 5 1600 5</span><br><span class="line">blkdev_ioc 14 118 64 59</span><br><span class="line">blkdev_queue 20 30 1576 5</span><br><span class="line">blkdev_requests 13 42 272 14</span><br><span class="line">biovec-256 7 7 4096 1</span><br><span class="line">biovec-128 7 8 2048 2</span><br><span class="line">biovec-64 7 8 1024 4</span><br><span class="line">biovec-16 7 15 256 15</span><br><span class="line">biovec-4 7 59 64 59</span><br><span class="line">biovec-1 23 202 16 202</span><br><span class="line">bio 270 270 128 30</span><br><span class="line">utrace_engine_cache 0 0 64 59</span><br><span class="line">Cache Num Total Size Pages</span><br><span class="line">utrace_cache 0 0 64 59</span><br><span class="line">sock_inode_cache 33 48 640 6</span><br><span class="line">skbuff_fclone_cache 7 7 512 7</span><br><span class="line">skbuff_head_cache 319 390 256 15</span><br><span class="line">file_lock_cache 1 22 176 22</span><br><span class="line">Acpi-Operand 4136 4248 64 59</span><br><span class="line">Acpi-ParseExt 0 0 64 59</span><br><span class="line">Acpi-Parse 0 0 40 92</span><br><span class="line">Acpi-State 0 0 80 48</span><br><span class="line">Acpi-Namespace 2871 2912 32 112</span><br><span class="line">delayacct_cache 81 295 64 59</span><br><span class="line">taskstats_cache 4 53 72 53</span><br><span class="line">proc_inode_cache 1427 1440 592 6</span><br><span class="line">sigqueue 0 0 160 24</span><br><span class="line">radix_tree_node 13166 13188 536 7</span><br><span class="line">bdev_cache 23 24 832 4</span><br><span class="line">sysfs_dir_cache 5370 5412 88 44</span><br><span class="line">mnt_cache 26 30 256 15</span><br><span class="line">inode_cache 2009 2009 560 7</span><br><span class="line">dentry_cache 60952 61020 216 18</span><br><span class="line">filp 479 1305 256 15</span><br><span class="line">names_cache 3 3 4096 1</span><br><span class="line">avc_node 14 53 72 53</span><br><span class="line">selinux_inode_security 994 1200 80 48</span><br><span class="line">key_jar 2 20 192 20</span><br><span class="line">idr_layer_cache 74 77 528 7</span><br><span class="line">buffer_head 164045 164800 96 40</span><br><span class="line">mm_struct 51 56 896 4</span><br><span class="line">vm_area_struct 1142 1958 176 22</span><br><span class="line">fs_cache 35 177 64 59</span><br><span class="line">files_cache 36 55 768 5</span><br><span class="line">signal_cache 72 162 832 9</span><br><span class="line">sighand_cache 68 84 2112 3</span><br><span class="line">task_struct 76 80 1888 2</span><br><span class="line">anon_vma 458 864 24 144</span><br><span class="line">pid 83 295 64 59</span><br><span class="line">shared_policy_node 0 0 48 77</span><br><span class="line">Cache Num Total Size Pages</span><br><span class="line">numa_policy 37 144 24 144</span><br><span class="line">size-131072(DMA) 0 0 131072 1</span><br><span class="line">size-131072 0 0 131072 1</span><br><span class="line">size-65536(DMA) 0 0 65536 1</span><br><span class="line">size-65536 1 1 65536 1</span><br><span class="line">size-32768(DMA) 0 0 32768 1</span><br><span class="line">size-32768 2 2 32768 1</span><br><span class="line">size-16384(DMA) 0 0 16384 1</span><br><span class="line">size-16384 5 5 16384 1</span><br><span class="line">size-8192(DMA) 0 0 8192 1</span><br><span class="line">size-8192 7 7 8192 1</span><br><span class="line">size-4096(DMA) 0 0 4096 1</span><br><span class="line">size-4096 110 111 4096 1</span><br><span class="line">size-2048(DMA) 0 0 2048 2</span><br><span class="line">size-2048 602 602 2048 2</span><br><span class="line">size-1024(DMA) 0 0 1024 4</span><br><span class="line">size-1024 344 352 1024 4</span><br><span class="line">size-512(DMA) 0 0 512 8</span><br><span class="line">size-512 433 480 512 8</span><br><span class="line">size-256(DMA) 0 0 256 15</span><br><span class="line">size-256 1139 1155 256 15</span><br><span class="line">size-128(DMA) 0 0 128 30</span><br><span class="line">size-64(DMA) 0 0 64 59</span><br><span class="line">size-64 5639 5782 64 59</span><br><span class="line">size-32(DMA) 0 0 32 112</span><br><span class="line">size-128 801 930 128 30</span><br><span class="line">size-32 3005 3024 32 112</span><br><span class="line">kmem_cache 137 137 2688 1</span><br></pre></td></tr></tbody></table></figure><p>这组信息来自于/proc/slabinfo。<br>slab:由于内核会有许多小对象，这些对象构造销毁十分频繁，比如i-node，dentry，这些对象如果每次构建的时候就向内存要一个页(4kb)，而其实只有几个字节，这样就会非常浪费，为了解决这个问题，就引入了一种新的机制来处理在同一个页框中如何分配小存储区，而slab可以对小对象进行分配,这样就不用为每一个对象分配页框，从而节省了空间，内核对一些小对象创建析构很频繁，slab对这些小对象进行缓冲,可以重复利用,减少内存分配次数。</p><h3 id="2-3-iostat"><a href="#2-3-iostat" class="headerlink" title="2.3 iostat"></a>2.3 iostat</h3><p>IOSTAT命令(在UBUNTU、红帽和FEDORA系统中都是由SYSSTAT软件包提供的)可以提供三个报告：CPU使用率、设备使用率和网络文件系统使用率。如果你不加任何参数地运行该命令，它会显示所有这三个报告，你可以通过加参数-c、-d和－h来单独显示它们中的一种。</p><h4 id="2-3-1-iostat-的命令格式"><a href="#2-3-1-iostat-的命令格式" class="headerlink" title="2.3.1 iostat 的命令格式"></a>2.3.1 iostat 的命令格式</h4><p>iostat 用于输出CPU和磁盘I/O相关的统计信息。命令格式为：</p><p>iostat [ -c | -d ] [ -k | -m ] [ -t ] [ -V ] [ -x ] [ device [ … ] | ALL ]<br>[ -p [ device | ALL ] ] [ interval [ count ] ]</p><p>其中：<br><strong>interval</strong> : 为取样时间间隔<br><strong>count</strong> : 为输出次数，若指定了取样时间间隔且省略此项，将不断产生统计信息</p><p>常用选项：<br>选项 说明<br><strong>-c</strong> 仅显示CPU统计信息。与-d选项互斥。<br><strong>-d</strong> 仅显示磁盘统计信息。与-c选项互斥。<br><strong>-k</strong> 以KB为单位显示每秒的磁盘请求数。默认单位块。<br><strong>-m</strong> 以MB为单位显示每秒的磁盘请求数。默认单位块。<br><strong>-p {device|ALL}</strong> 用于显示块设备及系统分区的统计信息。与-x选项互斥。<br><strong>-t</strong> 在输出数据时，打印搜集数据的时间。<br><strong>-V</strong> 打印版本号信息。<br><strong>-x</strong> 输出扩展信息。</p><h4 id="2-3-2-iostat-使用举例"><a href="#2-3-2-iostat-使用举例" class="headerlink" title="2.3.2 iostat 使用举例"></a>2.3.2 iostat 使用举例</h4><p>下面给出几个例子：</p><h5 id="2-3-2-1-显示一条包括所有的CPU和设备吞吐率的统计信息"><a href="#2-3-2-1-显示一条包括所有的CPU和设备吞吐率的统计信息" class="headerlink" title="2.3.2.1 显示一条包括所有的CPU和设备吞吐率的统计信息"></a>2.3.2.1 显示一条包括所有的CPU和设备吞吐率的统计信息</h5><figure class="highlight plain"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">[root@localhost ~]# iostat</span><br><span class="line">Linux 2.6.18-53.el5 (cnetos5)   01/21/2008</span><br><span class="line"></span><br><span class="line">avg-cpu:  %user   %nice %system %iowait  %steal   %idle</span><br><span class="line">           0.10    0.04    0.37    0.07    0.00   99.42</span><br><span class="line"></span><br><span class="line">Device:            tps   Blk_read/s   Blk_wrtn/s   Blk_read   Blk_wrtn</span><br><span class="line">sda               1.44        16.79        10.58     800430     504340</span><br><span class="line">sdb               0.01         0.07         0.00       3314          8</span><br><span class="line">sdc               0.86         8.56         0.00     407892         24</span><br></pre></td></tr></tbody></table></figure><h5 id="2-3-2-2-每隔5秒显示一次设备吞吐率的统计信息（单位为-块-s）"><a href="#2-3-2-2-每隔5秒显示一次设备吞吐率的统计信息（单位为-块-s）" class="headerlink" title="2.3.2.2 每隔5秒显示一次设备吞吐率的统计信息（单位为 块/s）"></a>2.3.2.2 每隔5秒显示一次设备吞吐率的统计信息（单位为 块/s）</h5><figure class="highlight plain"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[root@localhost ~]# iostat -d 5</span><br></pre></td></tr></tbody></table></figure><h5 id="2-3-2-3-每隔5秒显示一次设备吞吐率的统计信息（单位为-KB-s），共输出3次"><a href="#2-3-2-3-每隔5秒显示一次设备吞吐率的统计信息（单位为-KB-s），共输出3次" class="headerlink" title="2.3.2.3 每隔5秒显示一次设备吞吐率的统计信息（单位为 KB/s），共输出3次"></a>2.3.2.3 每隔5秒显示一次设备吞吐率的统计信息（单位为 KB/s），共输出3次</h5><figure class="highlight plain"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[root@localhost ~]# iostat -dk 5 3</span><br></pre></td></tr></tbody></table></figure><h5 id="2-3-2-4-每隔2秒显示一次-sda-及上面所有分区的统计信息，共输出5次"><a href="#2-3-2-4-每隔2秒显示一次-sda-及上面所有分区的统计信息，共输出5次" class="headerlink" title="2.3.2.4 每隔2秒显示一次 sda 及上面所有分区的统计信息，共输出5次"></a>2.3.2.4 每隔2秒显示一次 sda 及上面所有分区的统计信息，共输出5次</h5><figure class="highlight plain"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[root@localhost ~]# iostat -p sda 2 5</span><br></pre></td></tr></tbody></table></figure><h5 id="2-3-2-5-每隔2秒显示一次-sda-和-sdb-两个设备的扩展统计信息，共输出6次"><a href="#2-3-2-5-每隔2秒显示一次-sda-和-sdb-两个设备的扩展统计信息，共输出6次" class="headerlink" title="2.3.2.5 每隔2秒显示一次 sda 和 sdb 两个设备的扩展统计信息，共输出6次"></a>2.3.2.5 每隔2秒显示一次 sda 和 sdb 两个设备的扩展统计信息，共输出6次</h5><figure class="highlight plain"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">[root@localhost ~]# iostat -x sda sdb 2 6</span><br><span class="line">Linux 2.6.18-53.el5 (cnetos5)   01/21/2008</span><br><span class="line"></span><br><span class="line">avg-cpu:  %user   %nice %system %iowait  %steal   %idle</span><br><span class="line">           0.10    0.04    0.37    0.07    0.00   99.42</span><br><span class="line"></span><br><span class="line">Device:     rrqm/s   wrqm/s   r/s   w/s   rsec/s   wsec/s avgrq-sz avgqu-sz   await  svctm  %util</span><br><span class="line">sda           0.17     0.84  0.96  0.47    16.67    10.56    19.01     0.01    7.11   1.25   0.18</span><br><span class="line">sdb           0.00     0.00  0.01  0.00     0.07     0.00     5.16     0.00    0.22   0.19   0.00</span><br><span class="line"></span><br><span class="line">…………</span><br></pre></td></tr></tbody></table></figure><p><strong>iostat</strong> 的输出项说明<br><strong>avg-cpu</strong> 部分输出项说明：<br><strong>%user</strong> 在用户级别运行所使用的 CPU 的百分比。<br><strong>%nice</strong> nice 操作所使用的 CPU 的百分比。<br><strong>%system</strong> 在核心级别（kernel）运行所使用 CPU 的百分比。<br><strong>%iowait</strong> CPU 等待硬件 I/O 所占用 CPU 的百分比。<br><strong>%steal</strong> 当管理程序（hypervisor）为另一个虚拟进程提供服务而等待虚拟 CPU 的百分比。<br><strong>%idle</strong> CPU 空闲时间的百分比。<br><strong>Device</strong> 部分基本输出项说明：<br><strong>tps</strong> 每秒钟物理设备的 I/O 传输总量。<br><strong>Blk_read</strong> 读入的数据总量，单位为块。<br><strong>Blk_wrtn</strong> 写入的数据总量，单位为块。<br><strong>kB_read</strong> 读入的数据总量，单位为KB。<br><strong>kB_wrtn</strong> 写入的数据总量，单位为KB。<br><strong>MB_read</strong> 读入的数据总量，单位为MB。<br><strong>MB_wrtn</strong> 写入的数据总量，单位为MB。<br><strong>Blk_read/s</strong> 每秒从驱动器读入的数据量，单位为 块/s。<br><strong>Blk_wrtn/s</strong> 每秒向驱动器写入的数据量，单位为 块/s。<br><strong>kB_read/s</strong> 每秒从驱动器读入的数据量，单位为KB/s。<br><strong>kB_wrtn/s</strong> 每秒向驱动器写入的数据量，单位为KB/s。<br><strong>MB_read/s</strong> 每秒从驱动器读入的数据量，单位为MB/s。<br><strong>MB_wrtn/s</strong> 每秒向驱动器写入的数据量，单位为MB/s。<br><strong>Device</strong> 部分扩展输出项说明：<br><strong>rrqm/s</strong> 将读入请求合并后，每秒发送到设备的读入请求数。<br><strong>wrqm/s</strong> 将写入请求合并后，每秒发送到设备的写入请求数。<br><strong>r/s</strong> 每秒发送到设备的读入请求数。<br><strong>w/s</strong> 每秒发送到设备的写入请求数。<br><strong>rsec/s</strong> 每秒从设备读入的扇区数。<br><strong>wsec/s</strong> 每秒向设备写入的扇区数。<br><strong>rkB/s</strong> 每秒从设备读入的数据量，单位为 KB/s。<br><strong>wkB/s</strong> 每秒向设备写入的数据量，单位为 KB/s。<br><strong>rMB/s</strong> 每秒从设备读入的数据量，单位为 MB/s。<br><strong>wMB/s</strong> 每秒向设备写入的数据量，单位为 MB/s。<br><strong>avgrq-sz</strong> 发送到设备的请求的平均大小，单位为扇区。<br><strong>avgqu-sz</strong> 发送到设备的请求的平均队列长度。<br><strong>await</strong> I/O请求平均执行时间。包括发送请求和执行的时间。单位为毫秒。<br><strong>svctm</strong> 发送到设备的I/O请求的平均执行时间。单位为毫秒。<br><strong>%util</strong> 在I/O请求发送到设备期间，占用CPU时间的百分比。用于显示设备的带宽利用率。当这个值接近100%时，表示设备带宽已经占满。</p><h3 id="2-4-free"><a href="#2-4-free" class="headerlink" title="2.4 free"></a>2.4 free</h3><p>可以显示主内存和交换内存的统计量。</p><p><img src="/2018/06/15/linux-chang-yong-de-xing-neng-cha-kan-ming-ling-ji-gong-ju/%E5%9B%BE%E7%89%872.png" alt="img"></p><p>你可以通过添加－t参数来显示总的内存，或者通过添加－b参数和－m参数来用字节数显示（默认情况是用千字节为单位）。</p><p>FREE命令还可以通过使用－s参数来使其以某个间隔时间持续刷新地运行：</p><figure class="highlight plain"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[root@localhost ~]# free -s 5</span><br></pre></td></tr></tbody></table></figure><p>这个命令是以每隔5秒钟刷新一次的方式运行FREE命令并输出结果。<img src="/2018/06/15/linux-chang-yong-de-xing-neng-cha-kan-ming-ling-ji-gong-ju/%E5%9B%BE%E7%89%873.png" alt="img"></p><h3 id="2-5-sar"><a href="#2-5-sar" class="headerlink" title="2.5 sar"></a>2.5 sar</h3><p>要判断一个系统瓶颈问题，有时需要几个 sar 命令选项结合起来使用，例如：怀疑CPU存在瓶颈，可用 sar -u 和 sar -q deng 等来查看 怀疑内存存在瓶颈，可用 sar -B、sar -r 和 sar -W 等来查看 怀疑I/O存在瓶颈，可用 sar -b、sar -u 和 sar -d 等来查看。它比我们见过的任何类似工具都更强大，并且可以收集和显示长时间段的数据。在红帽和UBUNTU上，它通过SYSSTAT包来安装。</p><p>sysstat 是 Linux 系统中的常用工具包。它的主要用途是观察服务负载，比如CPU和内存的占用率、网络的使用率以及磁盘写入和读取速度等。</p><h4 id="2-5-1-sysstat-工具包中包含两类工具："><a href="#2-5-1-sysstat-工具包中包含两类工具：" class="headerlink" title="2.5.1 sysstat 工具包中包含两类工具："></a>2.5.1 sysstat 工具包中包含两类工具：</h4><ul><li>即时查看工具：iostat、mpstat、sar</li><li>累计统计工具：sar</li></ul><p>也就是说，sar 具有这两种功能。因此，sar 是 sysstat 中的核心工具。<br>为了实现 sar 的累计统计，系统必须周期地记录当时的信息，这是通过调用 /usr/lib/sa/ 中的三个工具实现的：</p><ul><li><strong>sa1</strong> ：收集并存储每天系统动态信息到一个二进制的文件中，用作 sadc 的前端程序</li><li><strong>sa2</strong> ：收集每天的系统活跃信息写入总结性的报告，用作 sar 的前端程序</li><li><strong>sadc</strong> ：系统动态数据收集工具，收集的数据被写入一个二进制的文件中，它被用作 sar 工具的后端</li></ul><h4 id="2-5-2-CentOS-系统的默认设置中，以如下的方式使用这三个工具："><a href="#2-5-2-CentOS-系统的默认设置中，以如下的方式使用这三个工具：" class="headerlink" title="2.5.2 CentOS 系统的默认设置中，以如下的方式使用这三个工具："></a>2.5.2 CentOS 系统的默认设置中，以如下的方式使用这三个工具：</h4><p>5.2-1) 在守护进程 /etc/rc.d/init.d/sysstat 中使用 /usr/lib/sa/sadc<br>-F<br>-L</p><p>命令创建当日记录文件，文件为 /var/log/sa/saDD，其中 DD 为当天的日期。当系统重新启动后，会向文件 /var/log/sa/saDD 输出类似 11:37:16<br>AM LINUX<br>RESTART 这样的行信息。<br>5.2-2) 在 cron 任务 /etc/cron.d/sysstat 中每隔10分钟执行一次 /usr/lib/sa/sa1<br>1 1 命令，将信息写入文件 /var/log/sa/saDD<br>5.2-3) 在 cron 任务 /etc/cron.d/sysstat 中每天 23:53 执行一次 /usr/lib/sa/sa2<br>-A 命令，将当天的汇总信息写入文件 /var/log/sa/saDD</p><p>您可以修改 /etc/cron.d/sysstat 以适合您的需要。<br>另外，文件 /var/log/sa/saDD 为二进制文件，不能使用 more、less 等文本工具查看，必须用 sar 或 sadf 命令查看。</p><h4 id="2-5-3-sar命令格式"><a href="#2-5-3-sar命令格式" class="headerlink" title="2.5.3 sar命令格式"></a>2.5.3 sar命令格式</h4><p>在使用 Linux 系统时，常常会遇到各种各样的问题，比如系统容易死机或者运行速度突然变慢，这时我们常常猜测：是否硬盘空间不足，是否内存不足，是否 I/O 出现瓶颈，还是系统的核心参数出了问题？这时，我们应该考虑使用 sar 工具对系统做一个全面了解，分析系统的负载状况。<br>sar（System Activity Reporter）是系统活动情况报告的缩写。sar 工具将对系统当前的状态进行取样，然后通过计算数据和比例来表达系统的当前运行状态。它的特点是可以连续对系统取样，获得大量的取样数据；取样数据和分析的结果都可以存入文件，所需的负载很小。 sar 是目前 Linux 上最为全面的系统性能分析工具之一，可以从多方面对系统的活动进行报告，包括：文件的读写情况、系统调用的使用情况、磁盘I/O、CPU效率、内存使用状况、进程活动及IPC有关的活动等。为了提供不同的信息，sar 提供了丰富的选项、因此使用较为复杂。<br>sar 的命令格式<br>sar 的命令格式为：</p><p>sar [ -A ] [ -b ] [ -B ] [ -c ] [ -d ] [ -i interval ] [ -p ] [ -q ]<br>[ -r ] [ -R ] [ -t ] [ -u ] [ -v ] [ -V ] [ -w ] [ -W ] [ -y ]<br>[ -n { DEV | EDEV | NFS | NFSD | SOCK | ALL } ]<br>[ -x { pid | SELF | ALL } ] [ -X { pid | SELF | ALL } ]<br>[ -I { irq | SUM | ALL | XALL } ] [ -P { cpu | ALL } ]<br>[ -o [ filename ] | -f [ filename ] ]<br>[ -s [ hh:mm:ss ] ] [ -e [ hh:mm:ss ] ]<br>[ interval [ count ] ]<br>其中：</p><ul><li><strong>interval</strong> : 为取样时间间隔</li><li><strong>count</strong> : 为输出次数，若省略此项，默认值为 1</li></ul><p>常用选项：<br>选项 说明</p><p><strong>-A</strong> 等价于 -bBcdqrRuvwWy -I SUM -I XALL -n ALL -P ALL<br><strong>-b</strong> 显示I/O和传送速率的统计信息<br><strong>-B</strong> 输出内存页面的统计信息<br><strong>-c</strong> 输出进程统计信息，每秒创建的进程数<br><strong>-d</strong> 输出每一个块设备的活动信息<br><strong>-i interval</strong> 指定间隔时长，单位为秒<br><strong>-p</strong> 显示友好设备名字，以方便查看，也可以和-d 和-n 参数结合使用，比如 -dp 或-np<br><strong>-q</strong> 输出进程队列长度和平均负载状态统计信息<br><strong>-r</strong> 输出内存和交换空间的统计信息<br><strong>-R</strong> 输出内存页面的统计信息<br><strong>-t</strong> 读取 /var/log/sa/saDD 的数据时显示其中记录的原始时间，如果没有这个参数使用用户的本地时间<br><strong>-u</strong> 输出CPU使用情况的统计信息<br><strong>-v</strong> 输出inode、文件和其他内核表的统计信息<br><strong>-V</strong> 输出版本号信息<br><strong>-w</strong> 输出系统交换活动信息<br><strong>-W</strong> 输出系统交换的统计信息<br><strong>-y</strong> 输出TTY设备的活动信息<br><strong>-n {DEV|EDEV|NFS|NFSD|SOCK|ALL}</strong> 分析输出网络设备状态统计信息。<br><strong>DEV</strong> 报告网络设备的统计信息<br><strong>EDEV</strong> 报告网络设备的错误统计信息<br><strong>NFS</strong> 报告 NFS 客户端的活动统计信息<br><strong>NFSD</strong> 报告 NFS 服务器的活动统计信息<br><strong>SOCK</strong> 报告网络套接字（sockets）的使用统计信息<br><strong>ALL</strong> 报告所有类型的网络活动统计信息<br><strong>-x {pid|SELF|ALL}</strong> 输出指定进程的统计信息。<br><strong>pid</strong> 用 pid 指定特定的进程<br><strong>SELF</strong> 表示 sar 自身<br><strong>ALL</strong> 表示所有进程<br><strong>-X {pid|SELF|ALL}</strong> 输出指定进程的子进程的统计信息<br><strong>-I {irq|SUM|ALL|XALL}</strong> 输出指定中断的统计信息。<br><strong>irq</strong> 指定中断号<br><strong>SUM</strong> 指定输出每秒接收到的中断总数<br><strong>ALL</strong> 指定输出前16个中断<br><strong>XALL</strong> 指定输出全部的中断信息<br><strong>-P {cpu|ALL}</strong> 输出指定 CPU 的统计信息<br><strong>-o filename</strong> 将输出信息保存到文件 filename<br><strong>-f filename</strong> 从文件 filename 读取数据信息。filename 是使用-o 选项时生成的文件。<br><strong>-s hh:mm:ss</strong> 指定输出统计数据的起始时间<br><strong>-e hh:mm:ss</strong> 指定输出统计数据的截至时间，默认为18:00:00</p><h4 id="2-5-4-sar-使用举例"><a href="#2-5-4-sar-使用举例" class="headerlink" title="2.5.4 sar 使用举例"></a>2.5.4 sar 使用举例</h4><p>从 /var/log/sa/saDD 中读取累计统计信息</p><h5 id="2-5-4-1-输出CPU使用情况的统计信息"><a href="#2-5-4-1-输出CPU使用情况的统计信息" class="headerlink" title="2.5.4.1 输出CPU使用情况的统计信息"></a>2.5.4.1 输出CPU使用情况的统计信息</h5><figure class="highlight plain"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">[root@cnetos ~]# sar</span><br><span class="line">[root@cnetos ~]# sar -u</span><br><span class="line">Linux 2.6.18-53.el5 (cnetos5)   01/22/2008</span><br><span class="line"></span><br><span class="line">12:00:01 AM       CPU     %user     %nice   %system   %iowait    %steal     %idle</span><br><span class="line">12:10:01 AM       all      0.02      0.00      0.14      0.01      0.00     99.84</span><br><span class="line">12:20:01 AM       all      0.02      0.00      0.12      0.01      0.00     99.86</span><br><span class="line">12:30:01 AM       all      0.01      0.00      0.12      0.01      0.00     99.86</span><br><span class="line">Average:          all      0.03      0.00      0.13      0.01      0.00     99.84</span><br></pre></td></tr></tbody></table></figure><p><strong>输出项说明：</strong><br><strong>CPU</strong> all 表示统计信息为所有 CPU 的平均值。<br><strong>%user</strong> 显示在用户级别(application)运行使用 CPU 总时间的百分比。<br><strong>%nice</strong> 显示在用户级别，用于nice操作，所占用 CPU 总时间的百分比。<br><strong>%system</strong> 在核心级别(kernel)运行所使用 CPU 总时间的百分比。<br><strong>%iowait</strong> 显示用于等待I/O操作占用 CPU 总时间的百分比。<br><strong>%steal</strong> 管理程序(hypervisor)为另一个虚拟进程提供服务而等待虚拟 CPU 的百分比。<br><strong>%idle</strong> 显示 CPU 空闲时间占用 CPU 总时间的百分比。<br><strong>注：</strong><br>1.若 %iowait 的值过高，表示硬盘存在I/O瓶颈<br>2.若 %idle 的值高但系统响应慢时，有可能是 CPU 等待分配内存，此时应加大内存容量<br>3.若 %idle 的值持续低于 10，则系统的 CPU 处理能力相对较低，表明系统中最需要解决的资源是 CPU。</p><h5 id="2-5-4-2-显示I-O和传送速率的统计信息"><a href="#2-5-4-2-显示I-O和传送速率的统计信息" class="headerlink" title="2.5.4.2 显示I/O和传送速率的统计信息"></a>2.5.4.2 显示I/O和传送速率的统计信息</h5><figure class="highlight plain"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">[root@cnetos ~]# sar -b</span><br><span class="line">Linux 2.6.18-53.el5 (cnetos5)   01/22/2008</span><br><span class="line"></span><br><span class="line">12:00:01 AM       tps      rtps      wtps   bread/s   bwrtn/s</span><br><span class="line">12:10:01 AM      1.58      0.00      1.58      0.00     16.71</span><br><span class="line">12:20:01 AM      1.09      0.00      1.09      0.00     10.85</span><br><span class="line">12:30:01 AM      1.08      0.00      1.08      0.00     10.74</span><br><span class="line">Average:         1.24      0.00      1.24      0.00     12.70</span><br></pre></td></tr></tbody></table></figure><p><strong>输出项说明：</strong><br><strong>tps</strong> 每秒钟物理设备的 I/O 传输总量<br><strong>rtps</strong> 每秒钟从物理设备读入的数据总量<br><strong>wtps</strong> 每秒钟向物理设备写入的数据总量<br><strong>bread/s</strong> 每秒钟从物理设备读入的数据量，单位为 块/s<br><strong>bwrtn/s</strong> 每秒钟向物理设备写入的数据量，单位为 块/s</p><h5 id="2-5-4-3-输出内存页面的统计信息"><a href="#2-5-4-3-输出内存页面的统计信息" class="headerlink" title="2.5.4.3 输出内存页面的统计信息"></a>2.5.4.3 输出内存页面的统计信息</h5><figure class="highlight plain"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">[root@cnetos ~]# sar -B</span><br><span class="line">Linux 2.6.18-53.el5 (cnetos5)   01/22/2008</span><br><span class="line"></span><br><span class="line">12:00:01 AM  pgpgin/s pgpgout/s   fault/s  majflt/s</span><br><span class="line">12:10:01 AM      0.00      4.17      9.74      0.00</span><br><span class="line">12:20:01 AM      0.00      2.71      2.24      0.00</span><br><span class="line">12:30:01 AM      0.00      2.69      2.25      0.00</span><br><span class="line">Average:         0.00      3.17      4.07      0.00</span><br></pre></td></tr></tbody></table></figure><p><strong>输出项说明：</strong><br><strong>pgpgin/s</strong> 每秒钟从磁盘读入的系统页面的 KB 总数<br><strong>pgpgout/s</strong> 每秒钟向磁盘写出的系统页面的 KB 总数<br><strong>fault/s</strong> 系统每秒产生的页面失效(major + minor)数量<br><strong>majflt/s</strong> 系统每秒产生的页面失效(major)数量</p><h5 id="2-5-4-4-输出每秒创建的进程数的进程统计信息"><a href="#2-5-4-4-输出每秒创建的进程数的进程统计信息" class="headerlink" title="2.5.4.4 输出每秒创建的进程数的进程统计信息"></a>2.5.4.4 输出每秒创建的进程数的进程统计信息</h5><figure class="highlight plain"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">[root@cnetos ~]# sar -c</span><br><span class="line">Linux 2.6.18-53.el5 (cnetos5)   01/22/2008</span><br><span class="line"></span><br><span class="line">12:00:01 AM    proc/s</span><br><span class="line">12:10:01 AM      0.05</span><br><span class="line">12:20:01 AM      0.03</span><br><span class="line">12:30:01 AM      0.03</span><br><span class="line">Average:         0.03</span><br></pre></td></tr></tbody></table></figure><p><strong>输出项说明：</strong><br><strong>proc/s</strong> 每秒钟创建的进程数</p><h5 id="2-5-4-5-输出网络设备状态的统计信息"><a href="#2-5-4-5-输出网络设备状态的统计信息" class="headerlink" title="2.5.4.5 输出网络设备状态的统计信息"></a>2.5.4.5 输出网络设备状态的统计信息</h5><figure class="highlight plain"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">[root@cnetos ~]# sar -n DEV |grep eth0</span><br><span class="line">12:00:01 AM     IFACE   rxpck/s   txpck/s   rxbyt/s   txbyt/s   rxcmp/s   txcmp/s  rxmcst/s</span><br><span class="line">12:10:01 AM      eth0      0.59      0.92     41.57    893.98      0.00      0.00      0.00</span><br><span class="line">12:20:01 AM      eth0      0.55      0.88     37.50    859.56      0.00      0.00      0.00</span><br><span class="line">12:30:01 AM      eth0      0.55      0.86     38.17    871.98      0.00      0.00      0.00</span><br><span class="line">Average:         eth0      0.29      0.42     21.05    379.29      0.00      0.00      0.00</span><br></pre></td></tr></tbody></table></figure><p><strong>输出项说明：</strong><br><strong>IFACE</strong> 网络设备名<br><strong>rxpck/s</strong> 每秒接收的包总数<br><strong>txpck/s</strong> 每秒传输的包总数<br><strong>rxbyt/s</strong> 每秒接收的字节（byte）总数<br><strong>txbyt/s</strong> 每秒传输的字节（byte）总数<br><strong>rxcmp/s</strong> 每秒接收压缩包的总数<br><strong>txcmp/s</strong> 每秒传输压缩包的总数<br><strong>rxmcst/s</strong> 每秒接收的多播（multicast）包的总数</p><h5 id="2-5-4-6-输出网络设备状态的统计信息（查看网络设备故障）"><a href="#2-5-4-6-输出网络设备状态的统计信息（查看网络设备故障）" class="headerlink" title="2.5.4.6 输出网络设备状态的统计信息（查看网络设备故障）"></a>2.5.4.6 输出网络设备状态的统计信息（查看网络设备故障）</h5><figure class="highlight plain"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">[root@cnetos ~]# sar -n EDEV |egrep 'eth0|IFACE'</span><br><span class="line">12:00:01 AM     IFACE   rxerr/s   txerr/s    coll/s  rxdrop/s  txdrop/s  txcarr/s  rxfram/s  rxfifo/s  txfifo/s</span><br><span class="line">12:10:01 AM      eth0      0.00      0.00      0.00      0.00      0.00      0.00      0.00      0.00      0.00</span><br><span class="line">12:20:01 AM      eth0      0.00      0.00      0.00      0.00      0.00      0.00      0.00      0.00      0.00</span><br><span class="line">12:30:01 AM      eth0      0.00      0.00      0.00      0.00      0.00      0.00      0.00      0.00      0.00</span><br><span class="line">Average:         eth0      0.00      0.00      0.00      0.00      0.00      0.00      0.00      0.00      0.00</span><br></pre></td></tr></tbody></table></figure><p><strong>输出项说明：</strong><br><strong>IFACE</strong> 网络设备名<br><strong>rxerr/s</strong> 每秒接收的坏包总数<br><strong>txerr/s</strong> 传输包时每秒发生错误的总数<br><strong>coll/s</strong> 传输包时每秒发生冲突（collision）的总数<br><strong>rxdrop/s</strong> 接收包时，由于缺乏缓存，每秒丢弃（drop）包的数量<br><strong>txdrop/s</strong> 传输包时，由于缺乏缓存，每秒丢弃（drop）包的数量<br><strong>txcarr/s</strong> 传输包时，每秒发生的传输错误（carrier-error）的数量<br><strong>rxfram/s</strong> 接收包时，每秒发生帧校验错误（frame alignment error）的数量<br><strong>rxfifo/s</strong> 接收包时，每秒发生队列（FIFO）一出错误的数量<br><strong>txfifo/s</strong> 传输包时，每秒发生队列（FIFO）一出错误的数量</p><h5 id="2-5-4-7-输出进程队列长度和平均负载状态统计信息"><a href="#2-5-4-7-输出进程队列长度和平均负载状态统计信息" class="headerlink" title="2.5.4.7 输出进程队列长度和平均负载状态统计信息"></a>2.5.4.7 输出进程队列长度和平均负载状态统计信息</h5><figure class="highlight plain"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">[root@cnetos ~]# sar -q</span><br><span class="line">Linux 2.6.18-53.el5 (cnetos5)   01/22/2008</span><br><span class="line"></span><br><span class="line">12:00:01 AM   runq-sz  plist-sz   ldavg-1   ldavg-5  ldavg-15</span><br><span class="line">12:10:01 AM         0        85      0.02      0.01      0.00</span><br><span class="line">12:20:01 AM         0        85      0.01      0.00      0.00</span><br><span class="line">12:30:01 AM         0        85      0.03      0.01      0.00</span><br><span class="line">Average:            0        85      0.01      0.00      0.00</span><br></pre></td></tr></tbody></table></figure><p><strong>输出项说明：</strong><br><strong>runq-sz</strong> 运行队列的长度（等待运行的进程数）<br><strong>plist-sz</strong> 进程列表中进程（processes）和线程（threads）的数量<br><strong>ldavg-1</strong> 最后1分钟的系统平均负载（System load average）<br><strong>ldavg-5</strong> 过去5分钟的系统平均负载<br><strong>ldavg-15</strong> 过去15分钟的系统平均负载</p><h5 id="2-5-4-8-输出内存和交换空间的统计信息"><a href="#2-5-4-8-输出内存和交换空间的统计信息" class="headerlink" title="2.5.4.8 输出内存和交换空间的统计信息"></a>2.5.4.8 输出内存和交换空间的统计信息</h5><figure class="highlight plain"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">[root@cnetos ~]# sar -r</span><br><span class="line">Linux 2.6.18-53.el5 (cnetos5)   01/22/2008</span><br><span class="line"></span><br><span class="line">12:00:01 AM kbmemfree kbmemused  %memused kbbuffers  kbcached kbswpfree kbswpused  %swpused  kbswpcad</span><br><span class="line">12:10:01 AM    262068    253408     49.16     43884    156456   1048568         0      0.00         0</span><br><span class="line">12:20:01 AM    261572    253904     49.26     44580    156448   1048568         0      0.00         0</span><br><span class="line">12:30:01 AM    260704    254772     49.42     45124    156472   1048568         0      0.00         0</span><br><span class="line">Average:       259551    255925     49.65     46453    156470   1048568         0      0.00         0</span><br></pre></td></tr></tbody></table></figure><p><strong>输出项说明：</strong><br><strong>kbmemfree</strong> 可用的空闲内存数量，单位为 KB<br><strong>kbmemused</strong> 已使用的内存数量（不包含内核使用的内存），单位为 KB<br><strong>%memused</strong> 已使用内存的百分数<br><strong>kbbuffers</strong> 内核缓冲区（buffer）使用的内存数量，单位为 KB<br><strong>kbcached</strong> 内核高速缓存（cache）数据使用的内存数量，单位为 KB<br><strong>kbswpfree</strong> 可用的空闲交换空间数量，单位为 KB<br><strong>kbswpused</strong> 已使用的交换空间数量，单位为 KB<br><strong>%swpused</strong> 已使用交换空间的百分数<br><strong>kbswpcad</strong> 交换空间的高速缓存使用的内存数量</p><h5 id="2-5-4-9-输出内存页面的统计信息"><a href="#2-5-4-9-输出内存页面的统计信息" class="headerlink" title="2.5.4.9 输出内存页面的统计信息"></a>2.5.4.9 输出内存页面的统计信息</h5><figure class="highlight plain"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">[root@cnetos ~]# sar -R</span><br><span class="line">Linux 2.6.18-53.el5 (cnetos5)   01/22/2008</span><br><span class="line"></span><br><span class="line">12:00:01 AM   frmpg/s   bufpg/s   campg/s</span><br><span class="line">12:10:01 AM     -0.10      0.23      0.01</span><br><span class="line">12:20:01 AM     -0.21      0.29     -0.00</span><br><span class="line">12:30:01 AM     -0.36      0.23      0.01</span><br><span class="line">Average:        -0.21      0.22      0.00</span><br></pre></td></tr></tbody></table></figure><p><strong>输出项说明：</strong><br><strong>frmpg/s</strong> 每秒系统中空闲的内存页面（memory page freed）数量<br><strong>bufpg/s</strong> 每秒系统中用作缓冲区（buffer）的附加内存页面（additional memory page）数量<br><strong>campg/s</strong> 每秒系统中高速缓存的附加内存页面（additional memory pages cached）数量</p><h5 id="2-5-4-10-输出inode、文件和其他内核表的信息"><a href="#2-5-4-10-输出inode、文件和其他内核表的信息" class="headerlink" title="2.5.4.10 输出inode、文件和其他内核表的信息"></a>2.5.4.10 输出inode、文件和其他内核表的信息</h5><figure class="highlight plain"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">[root@cnetos ~]# sar -v</span><br><span class="line">Linux 2.6.18-53.el5 (cnetos5)   01/22/2008</span><br><span class="line"></span><br><span class="line">12:00:01 AM dentunusd   file-sz  inode-sz  super-sz %super-sz  dquot-sz %dquot-sz  rtsig-sz %rtsig-sz</span><br><span class="line">12:10:01 AM      7253       576      5126         0      0.00         0      0.00         0      0.00</span><br><span class="line">12:20:01 AM      7253       576      5126         0      0.00         0      0.00         0      0.00</span><br><span class="line">12:30:01 AM      7253       576      5126         0      0.00         0      0.00         0      0.00</span><br><span class="line">Average:         7253       589      5125         0      0.00         0      0.00         0      0.00</span><br></pre></td></tr></tbody></table></figure><p><strong>输出项说明：</strong><br><strong>dentunusd</strong> 目录高速缓存中未被使用的条目数量<br><strong>file-sz</strong> 文件句柄（file handle）的使用数量<br><strong>inode-sz</strong> i节点句柄（inode handle）的使用数量<br><strong>super-sz</strong> 由内核分配的超级块句柄（super block handle）数量<br><strong>%super-sz</strong> 已分配的超级块句柄占总超级块句柄的百分比<br><strong>dquot-sz</strong> 已经分配的磁盘限额条目数量<br><strong>%dquot-sz</strong> 分配的磁盘限额条目数量占总磁盘限额条目的百分比<br><strong>rtsig-sz</strong> 已排队的 RT 信号的数量<br><strong>%rtsig-sz</strong> 已排队的 RT 信号占总 RT 信号的百分比</p><h5 id="2-5-4-11-输出系统交换活动信息"><a href="#2-5-4-11-输出系统交换活动信息" class="headerlink" title="2.5.4.11 输出系统交换活动信息"></a>2.5.4.11 输出系统交换活动信息</h5><figure class="highlight plain"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">[root@cnetos ~]# sar -w</span><br><span class="line">Linux 2.6.18-53.el5 (cnetos5)   01/22/2008</span><br><span class="line"></span><br><span class="line">12:00:01 AM   cswch/s</span><br><span class="line">12:10:01 AM     44.74</span><br><span class="line">12:20:01 AM     44.41</span><br><span class="line">12:30:01 AM     44.41</span><br><span class="line">Average:        44.50</span><br></pre></td></tr></tbody></table></figure><p><strong>输出项说明：</strong><br>cswch/s 每秒的系统上下文切换数量</p><h5 id="2-5-4-12-输出系统交换的统计信息"><a href="#2-5-4-12-输出系统交换的统计信息" class="headerlink" title="2.5.4.12 输出系统交换的统计信息"></a>2.5.4.12 输出系统交换的统计信息</h5><figure class="highlight plain"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">[root@cnetos ~]# sar -W</span><br><span class="line">Linux 2.6.18-53.el5 (cnetos5)   01/22/2008</span><br><span class="line"></span><br><span class="line">12:00:01 AM  pswpin/s pswpout/s</span><br><span class="line">12:10:01 AM      0.00      0.00</span><br><span class="line">12:20:01 AM      0.00      0.00</span><br><span class="line">12:30:01 AM      0.00      0.00</span><br><span class="line">Average:         0.00      0.00</span><br></pre></td></tr></tbody></table></figure><p><strong>输出项说明：</strong><br>pswpin/s 每秒系统换入的交换页面（swap page）数量<br>pswpout/s 每秒系统换出的交换页面（swap page）数量</p><h5 id="2-5-4-13-输出TTY设备的活动信息"><a href="#2-5-4-13-输出TTY设备的活动信息" class="headerlink" title="2.5.4.13 输出TTY设备的活动信息"></a>2.5.4.13 输出TTY设备的活动信息</h5><figure class="highlight plain"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">[root@cnetos ~]# sar -y</span><br><span class="line">Linux 2.6.18-53.el5 (cnetos5)   01/22/2008</span><br><span class="line"></span><br><span class="line">12:00:01 AM       TTY   rcvin/s   xmtin/s framerr/s prtyerr/s     brk/s   ovrun/s</span><br><span class="line">12:10:01 AM         0      0.00      0.00      0.00      0.00      0.00      0.00</span><br><span class="line">12:10:01 AM         1      0.00      0.00      0.00      0.00      0.00      0.00</span><br><span class="line">12:20:01 AM         0      0.00      0.00      0.00      0.00      0.00      0.00</span><br><span class="line">12:20:01 AM         1      0.00      0.00      0.00      0.00      0.00      0.00</span><br><span class="line">12:30:01 AM         0      0.00      0.00      0.00      0.00      0.00      0.00</span><br><span class="line">12:30:01 AM         1      0.00      0.00      0.00      0.00      0.00      0.00</span><br><span class="line">………………</span><br><span class="line">Average:            0      0.00      0.00      0.00      0.00      0.00      0.00</span><br><span class="line">Average:            1      0.00      0.00      0.00      0.00      0.00      0.00</span><br></pre></td></tr></tbody></table></figure><p><strong>输出项说明：</strong><br><strong>TTY</strong> TTY 串行设备号<br><strong>rcvin/s</strong> 每秒接收的中断数量<br><strong>xmtin/s</strong> 每秒传送的中断数量<br><strong>framerr/s</strong> 每秒发生的帧错误数（frame error）量<br><strong>prtyerr/s</strong> 每秒发生的奇偶校验错误（parity error）数量<br><strong>brk/s</strong> 每秒发生的暂停（break）数量<br><strong>ovrun/s</strong> 每秒发生的溢出错误（overrun error）数量</p><h5 id="2-5-4-14-显示全面的累计统计信息"><a href="#2-5-4-14-显示全面的累计统计信息" class="headerlink" title="2.5.4.14 显示全面的累计统计信息"></a>2.5.4.14 显示全面的累计统计信息</h5><figure class="highlight plain"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sar -A</span><br></pre></td></tr></tbody></table></figure><h5 id="2-5-4-15-默认配置不提供的累计统计信息"><a href="#2-5-4-15-默认配置不提供的累计统计信息" class="headerlink" title="2.5.4.15 默认配置不提供的累计统计信息"></a>2.5.4.15 默认配置不提供的累计统计信息</h5><figure class="highlight plain"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">[root@cnetos ~]# sar -d</span><br><span class="line">Requested activities not available in file</span><br><span class="line">[root@cnetos ~]# sar -x ALL</span><br><span class="line">Requested activities not available in file</span><br><span class="line">[root@cnetos ~]# sar -X ALL</span><br><span class="line">Requested activities not available in file</span><br></pre></td></tr></tbody></table></figure><p>默认情况下，为了防止统计数据文件 /var/log/sa/saDD 迅速增大，/usr/lib/sa/sadc 没有记录每个块设备的统计信息。<br>可以在 -d -x -X 参数后添加取样参数获得即时统计信息。<br>带有 -x -X 选项的 sar 命令从来不能记录到二进制统计数据文件 。</p><h4 id="2-5-5-查看即时统计信息"><a href="#2-5-5-查看即时统计信息" class="headerlink" title="2.5.5 查看即时统计信息"></a>2.5.5 查看即时统计信息</h4><h5 id="2-5-5-1-使用取样选项查看即时统计信息"><a href="#2-5-5-1-使用取样选项查看即时统计信息" class="headerlink" title="2.5.5.1 使用取样选项查看即时统计信息"></a>2.5.5.1 使用取样选项查看即时统计信息</h5><p>例如：每30秒取样一次，连续取样5次</p><figure class="highlight plain"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"># sar -n DEV 30 5</span><br><span class="line"></span><br><span class="line"># sar -u  30 5</span><br></pre></td></tr></tbody></table></figure><h5 id="2-5-5-2-输出和读取统计信息文件"><a href="#2-5-5-2-输出和读取统计信息文件" class="headerlink" title="2.5.5.2 输出和读取统计信息文件"></a>2.5.5.2 输出和读取统计信息文件</h5><p>例如：</p><figure class="highlight plain"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"># sar -u  30 5 -o sar-dump-001</span><br><span class="line"></span><br><span class="line"># sar -u -f  sar-dump-001</span><br></pre></td></tr></tbody></table></figure><h5 id="2-5-5-3-输出每一个块设备的活动信息"><a href="#2-5-5-3-输出每一个块设备的活动信息" class="headerlink" title="2.5.5.3 输出每一个块设备的活动信息"></a>2.5.5.3 输出每一个块设备的活动信息</h5><figure class="highlight plain"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"># sar -dp 5 2</span><br><span class="line"></span><br><span class="line">Linux 2.6.18-53.el5 (cnetos5)   01/22/2008</span><br><span class="line"></span><br><span class="line">07:12:11 AM       DEV       tps  rd_sec/s  wr_sec/s  avgrq-sz  avgqu-sz     await     svctm     %util</span><br><span class="line">07:12:16 AM       sda      0.40      0.00     17.56     44.00      0.00      1.00      1.00      0.04</span><br><span class="line">07:12:16 AM       sdb      0.00      0.00      0.00      0.00      0.00      0.00      0.00      0.00</span><br><span class="line"></span><br><span class="line">07:12:16 AM       DEV       tps  rd_sec/s  wr_sec/s  avgrq-sz  avgqu-sz     await     svctm     %util</span><br><span class="line">07:12:21 AM       sda      0.00      0.00      0.00      0.00      0.00      0.00      0.00      0.00</span><br><span class="line">07:12:21 AM       sdb      0.00      0.00      0.00      0.00      0.00      0.00      0.00      0.00</span><br><span class="line"></span><br><span class="line">Average:          DEV       tps  rd_sec/s  wr_sec/s  avgrq-sz  avgqu-sz     await     svctm     %util</span><br><span class="line">Average:          sda      0.20      0.00      8.78     44.00      0.00      1.00      1.00      0.02</span><br><span class="line">Average:          sdb      0.00      0.00      0.00      0.00      0.00      0.00      0.00      0.00</span><br></pre></td></tr></tbody></table></figure><p><strong>输出项说明：</strong><br><strong>DEV</strong> 正在监视的块设备<br><strong>tps</strong> 每秒钟物理设备的 I/O 传输总量<br><strong>rd_sec/s</strong> 每秒从设备读取的扇区（sector）数量<br><strong>wr_sec/s</strong> 每秒向设备写入的扇区（sector）数量<br><strong>avgrq-sz</strong> 发给设备请求的平均扇区数<br><strong>avgqu-sz</strong> 发给设备请求的平均队列长度<br><strong>await</strong> 设备 I/O 请求的平均等待时间（单位为毫秒）<br><strong>svctm</strong> 设备 I/O 请求的平均服务时间（单位为毫秒）<br><strong>%util</strong> 在 I/O 请求发送到设备期间，占用 CPU 时间的百分比。用于体现设备的带宽利用率。<br>注：<br>avgqu-sz 的值较低时，设备的利用率较高。<br>当 %util 的值接近 100% 时，表示设备带宽已经占满。</p><p>你还可以长时间运行sar命令然后将输出数据导入一个文件中来收集数据。要达到这个效果，需要使用参数－o和一个文件名称，要运行该命令的时间间隔（记得收集数据会导致性能变差，所以最好确保这个间隔不要太短）和循环的次数－你要记录的间隔次数。如果你不输入循环次数，则sar命令会一直运行下去，例如：<br>[root@localhost ~]# sar -A -o /var/log/sar/sar.log 600 &gt;/dev/null 2&gt;&amp;1 &amp;<br>这里我们将收集所有数据(-A),记录到文件/var/log/sar/sar.log中，每隔600秒（或者5分钟）收集一次，持续在后台运行。如果接下来我们想要显示这个数据我们可以用sar命令加上-f参数，例如：</p><figure class="highlight plain"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[root@localhost ~]# sar -A -f /var/log/sar/sar.log</span><br></pre></td></tr></tbody></table></figure><h3 id="2-6-iptraf-–g"><a href="#2-6-iptraf-–g" class="headerlink" title="2.6 iptraf –g"></a>2.6 iptraf –g</h3><p>iptraf是一个基于ncurses开发的IP局域网监控工具，它可以实时地监视网卡流量，可以生成各种网络统计数据，包括TCP信息、UDP统计、ICMP和OSPF信息、以太网负载信息、节点统计、IP校验和错误和其它一些信息。<br>iptraf的参数列表</p><p>iptraf后面加上不同的参数，可以起到不同的作用，下面是iptraf的参数命令列表：</p><p>参数命令 作用<br><strong>-i iface</strong> 网络接口：立即在指定网络接口上开启IP流量监视,iface为all指监视所有的网络接口，iface指相应的interface<br><strong>-g</strong> 立即开始生成网络接口的概要状态信息<br><strong>-d iface</strong> 网络接口：在指定网络接口上立即开始监视明细的网络流量信息,iface指相应的interface<br><strong>-s iface</strong> 网络接口：在指定网络接口上立即开始监视TCP和UDP网络流量信息,iface指相应的interface<br><strong>-z iface</strong> 网络接口：在指定网络接口上显示包计数,iface指相应的interface<br><strong>-l iface</strong> 网络接口：在指定网络接口上立即开始监视局域网工作站信息,iface指相应的interface<br><strong>-t timeout</strong> 时间：指定iptraf指令监视的时间，timeout指监视时间的minute数<br><strong>-B</strong> 将标注输出重新定向到“/dev/null”，关闭标注输入，将程序作为后台进程运行<br><strong>-L logfile</strong> 指定一个文件用于记录所有命令行的log，默认文件是地址：/var/log/iptraf<br><strong>-I interval</strong> 指定记录log的时间间隔（单位是minute），不包括IP traffic monitor<br><strong>-u</strong> 允许使用不支持的接口作为以太网设备<br><strong>-f</strong> 清空所有计数器<br><strong>-h</strong> 显示帮助信息<br>使用iptraf之后的菜单选项<br>首先，输入iptraf出现如下图所示界面：</p><p><img src="/2018/06/15/linux-chang-yong-de-xing-neng-cha-kan-ming-ling-ji-gong-ju/%E5%9B%BE%E7%89%874.png" alt="image-20191114163134524"></p><p>点击“Enter”键继续，进入下图内容：</p><p><img src="/2018/06/15/linux-chang-yong-de-xing-neng-cha-kan-ming-ling-ji-gong-ju/%E5%9B%BE%E7%89%875.png" alt="image-20191114163147006"></p><h4 id="2-6-1-Configure"><a href="#2-6-1-Configure" class="headerlink" title="2.6.1 Configure"></a>2.6.1 Configure</h4><p>在总菜单命令中点击“Configure” menu，即进入如下命令菜单：</p><p><img src="/2018/06/15/linux-chang-yong-de-xing-neng-cha-kan-ming-ling-ji-gong-ju/%E5%9B%BE%E7%89%876.png" alt="image-20191114163216688"></p><p>这个非常重要，进行适当的配置可以让统计的结果更直观，信息更丰富。<br>1）Reverse DNS lookups：查看连接的ip所对应的域名，在IP traffic monitor的pkt captured对话框中就可以看到域名结果，这个不是很直观，开启后会有点点影响抓包性能。<br>2）TCP/UDP service names：在有端口的地方都会把端口号换成相应的服务名，非常有用，很直观。<br>3）Activity mode：显示流量是按Kbits/s还是Kbytes/s，建议改成后面的更符合习惯。<br>4）Additional ports：按端口号监控所额外需要监控的端口，默认只监控小于1024的。</p><h4 id="2-6-2-Filters"><a href="#2-6-2-Filters" class="headerlink" title="2.6.2 Filters"></a>2.6.2 Filters</h4><p>这个默认就行了，除非你有特殊需要。<br>点击“Filter”进入如下图所示界面：</p><p><img src="/2018/06/15/linux-chang-yong-de-xing-neng-cha-kan-ming-ling-ji-gong-ju/%E5%9B%BE%E7%89%877.png" alt="image-20191114163300986"></p><h4 id="2-6-3-IP-traffic-monitor"><a href="#2-6-3-IP-traffic-monitor" class="headerlink" title="2.6.3 IP traffic monitor"></a>2.6.3 IP traffic monitor</h4><p>根据连接查看网络流量，这个最好让他跑一段时间看统计总量的结构，如果单个连接占用大量带宽，就很容易看出来。同时根据IP还可以很容易分辨是和内网还是外网服务器进行交互。pkt captured可以看到mac地址。<br>点击“IP traffic monitor”进入下图select界面，</p><p><img src="/2018/06/15/linux-chang-yong-de-xing-neng-cha-kan-ming-ling-ji-gong-ju/%E5%9B%BE%E7%89%878.png" alt="image-20191114163321932"></p><p>点击可选项，进入视图界面：</p><p><img src="/2018/06/15/linux-chang-yong-de-xing-neng-cha-kan-ming-ling-ji-gong-ju/%E5%9B%BE%E7%89%879.png" alt="image-20191114163337555"></p><h4 id="2-6-4-General-interface-statistics"><a href="#2-6-4-General-interface-statistics" class="headerlink" title="2.6.4 General interface statistics"></a>2.6.4 General interface statistics</h4><p>查看每个网卡上的流量，注意一下，这个是网卡流量，包括内网和外网，单机是无法分辨内外网。<br>点击“General interface statistics”进入如下图界面：</p><p><img src="/2018/06/15/linux-chang-yong-de-xing-neng-cha-kan-ming-ling-ji-gong-ju/%E5%9B%BE%E7%89%8710.png" alt="image-20191114163352527"></p><h4 id="2-6-5-Detailed-interface-statistics"><a href="#2-6-5-Detailed-interface-statistics" class="headerlink" title="2.6.5 Detailed interface statistics"></a>2.6.5 Detailed interface statistics</h4><p>根据协议进行统计，就只有IP, TCP, UDP等几个，感觉用处不大。<br>点击“Detailed interface statistics”进入下图select界面，</p><p><img src="/2018/06/15/linux-chang-yong-de-xing-neng-cha-kan-ming-ling-ji-gong-ju/%E5%9B%BE%E7%89%8711.png" alt="image-20191114163420089"></p><p>点击可选项，进入视图界面：</p><p><img src="/2018/06/15/linux-chang-yong-de-xing-neng-cha-kan-ming-ling-ji-gong-ju/%E5%9B%BE%E7%89%8712.png" alt="image-20191114163439206"></p><h4 id="2-6-6-Statistical-breakdowns"><a href="#2-6-6-Statistical-breakdowns" class="headerlink" title="2.6.6 Statistical breakdowns"></a>2.6.6 Statistical breakdowns</h4><p>1) By packet size:根据传输包的大小进行统计。<br>2) By TCP/UDP port：根据应用协议进行统计，比Detailed interface statistics更实用。<br>点击“Statistical breakdowns”出现可选菜单：</p><p><img src="/2018/06/15/linux-chang-yong-de-xing-neng-cha-kan-ming-ling-ji-gong-ju/%E5%9B%BE%E7%89%8713.png" alt="image-20191114163502988"></p><h4 id="2-6-7-LAN-station-monitor"><a href="#2-6-7-LAN-station-monitor" class="headerlink" title="2.6.7 LAN station monitor"></a>2.6.7 LAN station monitor</h4><p>根据mac地址统计。<br>点击“LAN station monitor”出现可选菜单：</p><p><img src="/2018/06/15/linux-chang-yong-de-xing-neng-cha-kan-ming-ling-ji-gong-ju/%E5%9B%BE%E7%89%8714.png" alt="image-20191114163527892"></p><h3 id="2-7-mpstat"><a href="#2-7-mpstat" class="headerlink" title="2.7 mpstat"></a>2.7 mpstat</h3><h4 id="2-7-1-mpstat-的命令格式"><a href="#2-7-1-mpstat-的命令格式" class="headerlink" title="2.7.1 mpstat 的命令格式"></a>2.7.1 mpstat 的命令格式</h4><p>mpstat 输出每一个 CPU 的运行状况，为多处理器系统中的 CPU 利用率提供统计信息。命<br>令格式为：<br>mpstat [ -P { cpu | ALL } ] [ -V ] [ interval [ count ] ]</p><p><strong>其中：</strong></p><ul><li>interval : 为取样时间间隔。指定0则输出自系统启动后的一个统计信息。</li><li>count : 为输出次数。若指定了取样时间间隔且省略此项，将不断产生统计信息。</li></ul><p><strong>常用选项：</strong><br>选项 说明<br><strong>-P</strong> {cpu|ALL} 指定 CPU。用 CPU-ID 指定，CPU-ID 是从0开始的，即第一个CPU为0。ALL 表示所有CPU。<br><strong>-V</strong> 输出版本号信息。</p><h4 id="2-7-2-mpstat-使用举例"><a href="#2-7-2-mpstat-使用举例" class="headerlink" title="2.7.2 mpstat 使用举例"></a>2.7.2 mpstat 使用举例</h4><p>下面给出几个例子：</p><h5 id="2-7-2-1-输出所有-CPU-使用情况的统计信息。"><a href="#2-7-2-1-输出所有-CPU-使用情况的统计信息。" class="headerlink" title="2.7.2.1 输出所有 CPU 使用情况的统计信息。"></a>2.7.2.1 输出所有 CPU 使用情况的统计信息。</h5><figure class="highlight plain"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">[root@localhost ~]# mpstat</span><br><span class="line">Linux 2.6.18-53.el5 (cnetos5)   01/21/2008</span><br><span class="line"></span><br><span class="line">10:39:06 AM  CPU   %user   %nice    %sys %iowait    %irq   %soft  %steal   %idle    intr/s</span><br><span class="line">10:39:06 AM  all    0.10    0.04    0.31    0.06    0.04    0.01    0.00   99.45   1012.99</span><br></pre></td></tr></tbody></table></figure><h5 id="2-7-2-2-输出第一个-CPU-使用情况的统计信息。"><a href="#2-7-2-2-输出第一个-CPU-使用情况的统计信息。" class="headerlink" title="2.7.2.2 输出第一个 CPU 使用情况的统计信息。"></a>2.7.2.2 输出第一个 CPU 使用情况的统计信息。</h5><figure class="highlight plain"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">[root@localhost ~]# mpstat -P 0</span><br><span class="line">Linux 2.6.18-53.el5 (cnetos5)   01/21/2008</span><br><span class="line"></span><br><span class="line">10:41:03 AM  CPU   %user   %nice    %sys %iowait    %irq   %soft  %steal   %idle    intr/s</span><br><span class="line">10:41:03 AM    0    0.09    0.02    0.40    0.09    0.08    0.01    0.00   99.32   1012.79</span><br></pre></td></tr></tbody></table></figure><h5 id="2-7-2-3-每隔2秒输出所有CPU的统计信息，共输出5次。"><a href="#2-7-2-3-每隔2秒输出所有CPU的统计信息，共输出5次。" class="headerlink" title="2.7.2.3 每隔2秒输出所有CPU的统计信息，共输出5次。"></a>2.7.2.3 每隔2秒输出所有CPU的统计信息，共输出5次。</h5><figure class="highlight plain"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[root@localhost ~]# mpstat 2 5</span><br></pre></td></tr></tbody></table></figure><h5 id="2-7-2-4-每隔2秒输出一次所有CPU的统计信息，共输出5次。"><a href="#2-7-2-4-每隔2秒输出一次所有CPU的统计信息，共输出5次。" class="headerlink" title="2.7.2.4 每隔2秒输出一次所有CPU的统计信息，共输出5次。"></a>2.7.2.4 每隔2秒输出一次所有CPU的统计信息，共输出5次。</h5><figure class="highlight plain"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[root@localhost ~]# mpstat -P ALL 2 5</span><br></pre></td></tr></tbody></table></figure><h5 id="2-7-2-5-每隔2秒输出一次第二个CPU的统计信息，共输出5次。"><a href="#2-7-2-5-每隔2秒输出一次第二个CPU的统计信息，共输出5次。" class="headerlink" title="2.7.2.5 每隔2秒输出一次第二个CPU的统计信息，共输出5次。"></a>2.7.2.5 每隔2秒输出一次第二个CPU的统计信息，共输出5次。</h5><figure class="highlight plain"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[root@localhost ~]# mpstat -P 1 2 5</span><br></pre></td></tr></tbody></table></figure><p><strong>mpstat 输出项说明</strong><br><strong>CPU</strong> 在多CPU系统里，每个CPU有一个ID号，第一个CPU为0。all表示统计信息为所有CPU的平均值。<br><strong>%user</strong> 显示在用户级别运行所占用CPU总时间的百分比。<br><strong>%nice</strong> 显示在用户级别，用于nice操作，所占用CPU总时间的百分比。<br><strong>%sys</strong> 显示在kernel级别运行所占用CPU总时间的百分比。注意：这个值并不包括服务中断和softirq。<br><strong>%iowait</strong> 显示用于等待I/O操作时，占用CPU总时间的百分比。<br><strong>%irq</strong> 显示用于中断操作，占用CPU总时间的百分比。<br><strong>%soft</strong> 显示用于softirq操作，占用CPU总时间的百分比。<br><strong>%steal</strong> 管理程序（hypervisor）为另一个虚拟进程提供服务而等待虚拟 CPU 的百分比。<br><strong>%idle</strong> 显示CPU在空闲状态，占用CPU总时间的百分比。<br><strong>intr/s</strong> 显示CPU每秒接收到的中断总数。</p><h3 id="2-8-其它查看性能相关命令"><a href="#2-8-其它查看性能相关命令" class="headerlink" title="2.8 其它查看性能相关命令"></a>2.8 其它查看性能相关命令</h3><p>Linux系统出现问题时，我们不仅需要查看系统日志信息，而且还要使用大量的性能监测工<br>具来判断究竟是哪一部分（内存、CPU、硬盘……）出了问题。在Linux系统中，所有的运行<br>参数保存在虚拟目录/proc中，换句话说，我们使用的性能监控工具取到的数据值实际上就<br>是源自于这个目录，当涉及到系统高估时，我们就可以修改/proc目录中的相关参数了，当<br>然有些是不能乱改的。下面就让我们了解一下这些常用的性能监控工具。工具功能描述<strong>uptime</strong>—-系统平均负载率<br><strong>dmesg</strong>—-硬件/系统信息<br><strong>top</strong>—–进程进行状态<br><strong>iostat</strong>——–CPU和磁盘平均使用率<br><strong>vmstat</strong>———系统运行状态<br><strong>sar</strong>———实时收集系统使用状态<br><strong>KDESystemGuard</strong>—图形监控工具<br><strong>free</strong>—————内存使用率<br><strong>traffic-vis</strong>————网络监控（只有SUSE有）<br><strong>pmap</strong>————-进程内存占用率<br><strong>strace</strong>———追踪程序运行状态<br><strong>limit</strong>———系统资源使用限制<br><strong>mpstat</strong>————-多处理器使用率</p><script>document.querySelectorAll('.github-emoji')
          .forEach(el => {
            if (!el.dataset.src) { return; }
            const img = document.createElement('img');
            img.style = 'display:none !important;';
            img.src = el.dataset.src;
            img.addEventListener('error', () => {
              img.remove();
              el.style.color = 'inherit';
              el.style.backgroundImage = 'none';
              el.style.background = 'none';
            });
            img.addEventListener('load', () => {
              img.remove();
            });
            document.body.appendChild(img);
          });</script></div><div><div><div style="text-align:center;color:#ccc;font-size:14px">-------------本文结束<i class="fa fa-paw"></i>感谢您的阅读-------------</div></div></div><div></div><footer class="post-footer"><div class="post-tags"><a href="/tags/Linux/" rel="tag"><i class="fa fa-tag"></i> Linux</a></div><div class="post-nav"><div class="post-nav-next post-nav-item"><a href="/2018/06/12/curl-ming-ling-mo-ni-http-get-post-qing-qiu/" rel="next" title="curl命令模拟HTTP GET/POST请求"><i class="fa fa-chevron-left"></i> curl命令模拟HTTP GET/POST请求</a></div><span class="post-nav-divider"></span><div class="post-nav-prev post-nav-item"><a href="/2018/06/26/mysql-gao-ke-yong-xing-zhi-mha/" rel="prev" title="MySQL 高可用性之MHA">MySQL 高可用性之MHA <i class="fa fa-chevron-right"></i></a></div></div></footer></div></article><div class="post-spread"><div class="jiathis_style"><span class="jiathis_txt">分享到：</span> <a class="jiathis_button_fav">收藏夹</a> <a class="jiathis_button_copy">复制网址</a> <a class="jiathis_button_email">邮件</a> <a class="jiathis_button_weixin">微信</a> <a class="jiathis_button_qzone">QQ空间</a> <a class="jiathis_button_tqq">腾讯微博</a> <a class="jiathis_button_douban">豆瓣</a> <a class="jiathis_button_share">一键分享</a> <a href="http://www.jiathis.com/share?uid=2140465" class="jiathis jiathis_txt jiathis_separator jtico jtico_jiathis" target="_blank">更多</a> <a class="jiathis_counter_style"></a></div><script type="text/javascript">var jiathis_config={data_track_clickback:!0,summary:"",shortUrl:!1,hideMore:!1}</script><script type="text/javascript" src="http://v3.jiathis.com/code/jia.js?uid=" charset="utf-8"></script></div></div></div></div><div class="sidebar-toggle"><div class="sidebar-toggle-line-wrap"><span class="sidebar-toggle-line sidebar-toggle-line-first"></span> <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span> <span class="sidebar-toggle-line sidebar-toggle-line-last"></span></div></div><aside id="sidebar" class="sidebar"><div id="sidebar-dimmer"></div><div class="sidebar-inner"><ul class="sidebar-nav motion-element"><li class="sidebar-nav-toc sidebar-nav-active" data-target="post-toc-wrap">文章目录</li><li class="sidebar-nav-overview" data-target="site-overview-wrap">站点概览</li></ul><section class="site-overview-wrap sidebar-panel"><div class="site-overview"><div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person"><img class="site-author-image" itemprop="image" src="/images/chen.png" alt="Zhongzhou Chen"><p class="site-author-name" itemprop="name">Zhongzhou Chen</p><p class="site-description motion-element" itemprop="description"></p></div><nav class="site-state motion-element"><div class="site-state-item site-state-posts"><a href="/archives/%7C%7C%20archive"><span class="site-state-item-count">371</span> <span class="site-state-item-name">日志</span></a></div><div class="site-state-item site-state-categories"><a href="/categories/index.html"><span class="site-state-item-count">89</span> <span class="site-state-item-name">分类</span></a></div><div class="site-state-item site-state-tags"><a href="/tags/index.html"><span class="site-state-item-count">188</span> <span class="site-state-item-name">标签</span></a></div></nav><div class="feed-link motion-element"><a href="/atom.xml" rel="alternate"><i class="fa fa-rss"></i> RSS</a></div></div></section><section class="post-toc-wrap motion-element sidebar-panel sidebar-panel-active"><div class="post-toc"><div class="post-toc-content"><ol class="nav"><li class="nav-item nav-level-2"><a class="nav-link" href="#1-、常用的命令及工具"><span class="nav-text">1 、常用的命令及工具</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#1-1-常用的查看系统性能的命令及工具"><span class="nav-text">1.1 常用的查看系统性能的命令及工具</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#1-1-1-查看CPU使用情况"><span class="nav-text">1.1.1 查看CPU使用情况</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#1-1-2-查看内存使用情况"><span class="nav-text">1.1.2 查看内存使用情况</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#1-1-3-查看网络流量"><span class="nav-text">1.1.3 查看网络流量</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#1-1-4-查看磁盘i-o"><span class="nav-text">1.1.4 查看磁盘i/o</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#1-2-Linux-查看CPU，内存，硬盘"><span class="nav-text">1.2 Linux 查看CPU，内存，硬盘</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#1-2-1-查看CPU"><span class="nav-text">1.2.1 查看CPU</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#1-2-2-查看内存"><span class="nav-text">1.2.2 查看内存</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#1-2-3-查看硬盘"><span class="nav-text">1.2.3 查看硬盘</span></a></li></ol></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#2、常用命令及工具的用法"><span class="nav-text">2、常用命令及工具的用法</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#2-1-top"><span class="nav-text">2.1 top</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#2-2-vmstat"><span class="nav-text">2.2 vmstat</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#2-2-1-命令格式"><span class="nav-text">2.2.1 命令格式</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#2-2-2-命令参数"><span class="nav-text">2.2.2 命令参数</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#2-2-3-使用实例"><span class="nav-text">2.2.3 使用实例</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#2-2-3-1-显示虚拟内存使用情况"><span class="nav-text">2.2.3.1 显示虚拟内存使用情况</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#2-2-3-2-显示活跃和非活跃内存"><span class="nav-text">2.2.3.2 显示活跃和非活跃内存</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#2-3-3-3-查看系统已经fork了多少次"><span class="nav-text">2.3.3.3 查看系统已经fork了多少次</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#2-3-3-4-查看内存使用的详细信息"><span class="nav-text">2.3.3.4 查看内存使用的详细信息</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#2-3-3-5-查看磁盘的读-写"><span class="nav-text">2.3.3.5 查看磁盘的读/写</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#2-3-3-6-查看-dev-sda1磁盘的读-写"><span class="nav-text">2.3.3.6 查看/dev/sda1磁盘的读/写</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#2-3-3-7-查看系统的slab信息"><span class="nav-text">2.3.3.7 查看系统的slab信息</span></a></li></ol></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#2-3-iostat"><span class="nav-text">2.3 iostat</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#2-3-1-iostat-的命令格式"><span class="nav-text">2.3.1 iostat 的命令格式</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#2-3-2-iostat-使用举例"><span class="nav-text">2.3.2 iostat 使用举例</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#2-3-2-1-显示一条包括所有的CPU和设备吞吐率的统计信息"><span class="nav-text">2.3.2.1 显示一条包括所有的CPU和设备吞吐率的统计信息</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#2-3-2-2-每隔5秒显示一次设备吞吐率的统计信息（单位为-块-s）"><span class="nav-text">2.3.2.2 每隔5秒显示一次设备吞吐率的统计信息（单位为 块/s）</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#2-3-2-3-每隔5秒显示一次设备吞吐率的统计信息（单位为-KB-s），共输出3次"><span class="nav-text">2.3.2.3 每隔5秒显示一次设备吞吐率的统计信息（单位为 KB/s），共输出3次</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#2-3-2-4-每隔2秒显示一次-sda-及上面所有分区的统计信息，共输出5次"><span class="nav-text">2.3.2.4 每隔2秒显示一次 sda 及上面所有分区的统计信息，共输出5次</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#2-3-2-5-每隔2秒显示一次-sda-和-sdb-两个设备的扩展统计信息，共输出6次"><span class="nav-text">2.3.2.5 每隔2秒显示一次 sda 和 sdb 两个设备的扩展统计信息，共输出6次</span></a></li></ol></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#2-4-free"><span class="nav-text">2.4 free</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#2-5-sar"><span class="nav-text">2.5 sar</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#2-5-1-sysstat-工具包中包含两类工具："><span class="nav-text">2.5.1 sysstat 工具包中包含两类工具：</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#2-5-2-CentOS-系统的默认设置中，以如下的方式使用这三个工具："><span class="nav-text">2.5.2 CentOS 系统的默认设置中，以如下的方式使用这三个工具：</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#2-5-3-sar命令格式"><span class="nav-text">2.5.3 sar命令格式</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#2-5-4-sar-使用举例"><span class="nav-text">2.5.4 sar 使用举例</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#2-5-4-1-输出CPU使用情况的统计信息"><span class="nav-text">2.5.4.1 输出CPU使用情况的统计信息</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#2-5-4-2-显示I-O和传送速率的统计信息"><span class="nav-text">2.5.4.2 显示I/O和传送速率的统计信息</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#2-5-4-3-输出内存页面的统计信息"><span class="nav-text">2.5.4.3 输出内存页面的统计信息</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#2-5-4-4-输出每秒创建的进程数的进程统计信息"><span class="nav-text">2.5.4.4 输出每秒创建的进程数的进程统计信息</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#2-5-4-5-输出网络设备状态的统计信息"><span class="nav-text">2.5.4.5 输出网络设备状态的统计信息</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#2-5-4-6-输出网络设备状态的统计信息（查看网络设备故障）"><span class="nav-text">2.5.4.6 输出网络设备状态的统计信息（查看网络设备故障）</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#2-5-4-7-输出进程队列长度和平均负载状态统计信息"><span class="nav-text">2.5.4.7 输出进程队列长度和平均负载状态统计信息</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#2-5-4-8-输出内存和交换空间的统计信息"><span class="nav-text">2.5.4.8 输出内存和交换空间的统计信息</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#2-5-4-9-输出内存页面的统计信息"><span class="nav-text">2.5.4.9 输出内存页面的统计信息</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#2-5-4-10-输出inode、文件和其他内核表的信息"><span class="nav-text">2.5.4.10 输出inode、文件和其他内核表的信息</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#2-5-4-11-输出系统交换活动信息"><span class="nav-text">2.5.4.11 输出系统交换活动信息</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#2-5-4-12-输出系统交换的统计信息"><span class="nav-text">2.5.4.12 输出系统交换的统计信息</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#2-5-4-13-输出TTY设备的活动信息"><span class="nav-text">2.5.4.13 输出TTY设备的活动信息</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#2-5-4-14-显示全面的累计统计信息"><span class="nav-text">2.5.4.14 显示全面的累计统计信息</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#2-5-4-15-默认配置不提供的累计统计信息"><span class="nav-text">2.5.4.15 默认配置不提供的累计统计信息</span></a></li></ol></li><li class="nav-item nav-level-4"><a class="nav-link" href="#2-5-5-查看即时统计信息"><span class="nav-text">2.5.5 查看即时统计信息</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#2-5-5-1-使用取样选项查看即时统计信息"><span class="nav-text">2.5.5.1 使用取样选项查看即时统计信息</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#2-5-5-2-输出和读取统计信息文件"><span class="nav-text">2.5.5.2 输出和读取统计信息文件</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#2-5-5-3-输出每一个块设备的活动信息"><span class="nav-text">2.5.5.3 输出每一个块设备的活动信息</span></a></li></ol></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#2-6-iptraf-–g"><span class="nav-text">2.6 iptraf –g</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#2-6-1-Configure"><span class="nav-text">2.6.1 Configure</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#2-6-2-Filters"><span class="nav-text">2.6.2 Filters</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#2-6-3-IP-traffic-monitor"><span class="nav-text">2.6.3 IP traffic monitor</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#2-6-4-General-interface-statistics"><span class="nav-text">2.6.4 General interface statistics</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#2-6-5-Detailed-interface-statistics"><span class="nav-text">2.6.5 Detailed interface statistics</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#2-6-6-Statistical-breakdowns"><span class="nav-text">2.6.6 Statistical breakdowns</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#2-6-7-LAN-station-monitor"><span class="nav-text">2.6.7 LAN station monitor</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#2-7-mpstat"><span class="nav-text">2.7 mpstat</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#2-7-1-mpstat-的命令格式"><span class="nav-text">2.7.1 mpstat 的命令格式</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#2-7-2-mpstat-使用举例"><span class="nav-text">2.7.2 mpstat 使用举例</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#2-7-2-1-输出所有-CPU-使用情况的统计信息。"><span class="nav-text">2.7.2.1 输出所有 CPU 使用情况的统计信息。</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#2-7-2-2-输出第一个-CPU-使用情况的统计信息。"><span class="nav-text">2.7.2.2 输出第一个 CPU 使用情况的统计信息。</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#2-7-2-3-每隔2秒输出所有CPU的统计信息，共输出5次。"><span class="nav-text">2.7.2.3 每隔2秒输出所有CPU的统计信息，共输出5次。</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#2-7-2-4-每隔2秒输出一次所有CPU的统计信息，共输出5次。"><span class="nav-text">2.7.2.4 每隔2秒输出一次所有CPU的统计信息，共输出5次。</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#2-7-2-5-每隔2秒输出一次第二个CPU的统计信息，共输出5次。"><span class="nav-text">2.7.2.5 每隔2秒输出一次第二个CPU的统计信息，共输出5次。</span></a></li></ol></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#2-8-其它查看性能相关命令"><span class="nav-text">2.8 其它查看性能相关命令</span></a></li></ol></li></ol></div></div></section><div class="back-to-top"><i class="fa fa-arrow-up"></i> <span id="scrollpercent"><span>0</span>%</span></div></div></aside></div></main><footer id="footer" class="footer"><div class="footer-inner"><script async src="https://dn-lbstatics.qbox.me/busuanzi/2.3/busuanzi.pure.mini.js"></script><div class="copyright">&copy; <span itemprop="copyrightYear">2023</span> <span class="with-love"><i class="fa fa-user"></i> </span><span class="author" itemprop="copyrightHolder">Zhongzhou Chen</span> <span class="post-meta-divider">|</span> <span class="post-meta-item-icon"><i class="fa fa-area-chart"></i> </span><span class="post-meta-item-text">Site words total count&#58;</span> <span title="Site words total count">863.9k</span></div><span class="post-meta-divider"></span></div></footer></div><script type="text/javascript">"[object Function]"!==Object.prototype.toString.call(window.Promise)&&(window.Promise=null)</script><script type="text/javascript" src="/lib/jquery/index.js?v=2.1.3"></script><script type="text/javascript" src="/lib/fastclick/lib/fastclick.min.js?v=1.0.6"></script><script type="text/javascript" src="/lib/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script><script type="text/javascript" src="/lib/velocity/velocity.min.js?v=1.2.1"></script><script type="text/javascript" src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script><script type="text/javascript" src="/lib/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script><script type="text/javascript" src="/js/src/utils.js?v=5.1.4"></script><script type="text/javascript" src="/js/src/motion.js?v=5.1.4"></script><style>.copy-btn{display:inline-block;padding:6px 12px;font-size:13px;font-weight:700;line-height:20px;color:#333;white-space:nowrap;vertical-align:middle;cursor:pointer;background-color:#eee;background-image:linear-gradient(#fcfcfc,#eee);border:1px solid #d5d5d5;border-radius:3px;user-select:none;outline:0}.highlight-wrap .copy-btn{transition:opacity .3s ease-in-out;opacity:0;padding:2px 6px;position:absolute;right:4px;top:8px}.highlight-wrap .copy-btn:focus,.highlight-wrap:hover .copy-btn{opacity:1}.highlight-wrap{position:relative}</style><script>$(".highlight").each(function(t,e){var n=$("<div>").addClass("highlight-wrap");$(e).after(n),n.append($("<button>").addClass("copy-btn").append("复制").on("click",function(t){var e=$(this).parent().find(".code").find(".line").map(function(t,e){return $(e).text()}).toArray().join("\n"),n=document.createElement("textarea");document.body.appendChild(n),n.style.position="absolute",n.style.top="0px",n.style.left="0px",n.value=e,n.select(),n.focus();var o=document.execCommand("copy");document.body.removeChild(n),o?$(this).text("复制成功"):$(this).text("复制失败"),$(this).blur()})).on("mouseleave",function(t){var e=$(this).find(".copy-btn");setTimeout(function(){e.text("复制")},300)}).append(e)})</script><script type="text/javascript" src="/js/src/affix.js?v=5.1.4"></script><script type="text/javascript" src="/js/src/schemes/pisces.js?v=5.1.4"></script><script type="text/javascript" src="/js/src/scrollspy.js?v=5.1.4"></script><script type="text/javascript" src="/js/src/post-details.js?v=5.1.4"></script><script type="text/javascript" src="/js/src/bootstrap.js?v=5.1.4"></script><script type="text/javascript">function proceedsearch(){$("body").append('<div class="search-popup-overlay local-search-pop-overlay"></div>').css("overflow","hidden"),$(".search-popup-overlay").click(onPopupClose),$(".popup").toggle();var t=$("#local-search-input");t.attr("autocapitalize","none"),t.attr("autocorrect","off"),t.focus()}var isfetched=!1,isXml=!0,search_path="search.xml";0===search_path.length?search_path="search.xml":/json$/i.test(search_path)&&(isXml=!1);var path="/"+search_path,onPopupClose=function(t){$(".popup").hide(),$("#local-search-input").val(""),$(".search-result-list").remove(),$("#no-result").remove(),$(".local-search-pop-overlay").remove(),$("body").css("overflow","")},searchFunc=function(t,e,o){"use strict";$("body").append('<div class="search-popup-overlay local-search-pop-overlay"><div id="search-loading-icon"><i class="fa fa-spinner fa-pulse fa-5x fa-fw"></i></div></div>').css("overflow","hidden"),$("#search-loading-icon").css("margin","20% auto 0 auto").css("text-align","center"),$.ajax({url:t,dataType:isXml?"xml":"json",async:!0,success:function(t){isfetched=!0,$(".popup").detach().appendTo(".header-inner");var n=isXml?$("entry",t).map(function(){return{title:$("title",this).text(),content:$("content",this).text(),url:$("url",this).text()}}).get():t,r=document.getElementById(e),s=document.getElementById(o),a=function(){var t=r.value.trim().toLowerCase(),e=t.split(/[\s\-]+/);e.length>1&&e.push(t);var o=[];if(t.length>0&&n.forEach(function(n){function r(e,o,n,r){for(var s=r[r.length-1],a=s.position,i=s.word,l=[],h=0;a+i.length<=n&&0!=r.length;){i===t&&h++,l.push({position:a,length:i.length});var p=a+i.length;for(r.pop();0!=r.length&&(s=r[r.length-1],a=s.position,i=s.word,p>a);)r.pop()}return c+=h,{hits:l,start:o,end:n,searchTextCount:h}}function s(t,e){var o="",n=e.start;return e.hits.forEach(function(e){o+=t.substring(n,e.position);var r=e.position+e.length;o+='<b class="search-keyword">'+t.substring(e.position,r)+"</b>",n=r}),o+=t.substring(n,e.end)}var a=!1,i=0,c=0,l=n.title.trim(),h=l.toLowerCase(),p=n.content.trim().replace(/<[^>]+>/g,""),u=p.toLowerCase(),f=decodeURIComponent(n.url),d=[],g=[];if(""!=l&&(e.forEach(function(t){function e(t,e,o){var n=t.length;if(0===n)return[];var r=0,s=[],a=[];for(o||(e=e.toLowerCase(),t=t.toLowerCase());(s=e.indexOf(t,r))>-1;)a.push({position:s,word:t}),r=s+n;return a}d=d.concat(e(t,h,!1)),g=g.concat(e(t,u,!1))}),(d.length>0||g.length>0)&&(a=!0,i=d.length+g.length)),a){[d,g].forEach(function(t){t.sort(function(t,e){return e.position!==t.position?e.position-t.position:t.word.length-e.word.length})});var v=[];0!=d.length&&v.push(r(l,0,l.length,d));for(var $=[];0!=g.length;){var C=g[g.length-1],m=C.position,x=C.word,w=m-20,y=m+80;0>w&&(w=0),y<m+x.length&&(y=m+x.length),y>p.length&&(y=p.length),$.push(r(p,w,y,g))}$.sort(function(t,e){return t.searchTextCount!==e.searchTextCount?e.searchTextCount-t.searchTextCount:t.hits.length!==e.hits.length?e.hits.length-t.hits.length:t.start-e.start});var T=parseInt("1");T>=0&&($=$.slice(0,T));var b="";b+=0!=v.length?"<li><a href='"+f+"' class='search-result-title'>"+s(l,v[0])+"</a>":"<li><a href='"+f+"' class='search-result-title'>"+l+"</a>",$.forEach(function(t){b+="<a href='"+f+'\'><p class="search-result">'+s(p,t)+"...</p></a>"}),b+="</li>",o.push({item:b,searchTextCount:c,hitCount:i,id:o.length})}}),1===e.length&&""===e[0])s.innerHTML='<div id="no-result"><i class="fa fa-search fa-5x" /></div>';else if(0===o.length)s.innerHTML='<div id="no-result"><i class="fa fa-frown-o fa-5x" /></div>';else{o.sort(function(t,e){return t.searchTextCount!==e.searchTextCount?e.searchTextCount-t.searchTextCount:t.hitCount!==e.hitCount?e.hitCount-t.hitCount:e.id-t.id});var a='<ul class="search-result-list">';o.forEach(function(t){a+=t.item}),a+="</ul>",s.innerHTML=a}};r.addEventListener("input",a),$(".local-search-pop-overlay").remove(),$("body").css("overflow",""),proceedsearch()}})};$(".popup-trigger").click(function(t){t.stopPropagation(),isfetched===!1?searchFunc(path,"local-search-input","local-search-result"):proceedsearch()}),$(".popup-btn-close").click(onPopupClose),$(".popup").click(function(t){t.stopPropagation()}),$(document).on("keyup",function(t){var e=27===t.which&&$(".search-popup").is(":visible");e&&onPopupClose()})</script><script type="text/javascript" src="/js/src/love.js"></script><script src="/live2dw/lib/L2Dwidget.min.js?094cbace49a39548bed64abff5988b05"></script><script>L2Dwidget.init({pluginRootPath:"live2dw/",pluginJsPath:"lib/",pluginModelPath:"assets/",tagMode:!1,debug:!1,log:!1,model:{jsonPath:"/live2dw/assets/shizuku.model.json"},display:{position:"right"},mobile:{show:!0,scale:.2},react:{opacityDefault:.7,opacityOnHover:.2,opacity:.4}})</script></body></html><!-- rebuild by neat -->