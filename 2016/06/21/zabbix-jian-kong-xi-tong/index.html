<!-- build time:Tue Dec 21 2021 14:40:00 GMT+0800 (GMT+08:00) --><!DOCTYPE html><html class="theme-next gemini use-motion" lang="zh-Hans"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1"><script src="//cdn.bootcss.com/pace/1.0.2/pace.min.js"></script><link href="//cdn.bootcss.com/pace/1.0.2/themes/pink/pace-theme-flash.css" rel="stylesheet"><script></script><meta name="theme-color" content="#222"><style>.pace .pace-progress{background:#1E92FB;height:3px}.pace .pace-progress-inner{box-shadow:0 0 10px #1E92FB,0 0 5px #1E92FB}.pace .pace-activity{border-top-color:#1E92FB;border-left-color:#1E92FB}</style><meta http-equiv="Cache-Control" content="no-transform"><meta http-equiv="Cache-Control" content="no-siteapp"><meta name="google-site-verification" content="HGM141IpbHrSmnAmR6W_zE4bo9Z3f-yXLeHYT3bg1fk"><meta name="baidu-site-verification" content="code-5Ai1DA8e6T"><link href="/lib/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css"><link href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css"><link href="/css/main.css?v=5.1.4" rel="stylesheet" type="text/css"><link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png?v=5.1.4"><link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png?v=5.1.4"><link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png?v=5.1.4"><link rel="mask-icon" href="/images/logo.svg?v=5.1.4" color="#222"><meta name="keywords" content="监控系统,Zabbix,"><link rel="alternate" href="/atom.xml" title="凡间的精灵" type="application/atom+xml"><meta name="description" content="1、Zabbix 简介Zabbix是完全开源的工具，整合了cacti和nagios等特性cacti:snmpnagios:linux主机:nrpe 设备：snmp附：SNMP(udp 161 udp 162)众多网络工具都支持此协议，比如常见路由交换，常见OS其既可以做管理端也可以做被管理端snmp协议大致有3个版本分别是v1 v2 v3无论是v1 和 v2 的安全性是比较差的，因为传输是明文的，"><meta name="keywords" content="监控系统,Zabbix"><meta property="og:type" content="article"><meta property="og:title" content="Zabbix 监控系统"><meta property="og:url" content="http:&#x2F;&#x2F;chenzhonzhou.github.io&#x2F;2016&#x2F;06&#x2F;21&#x2F;zabbix-jian-kong-xi-tong&#x2F;index.html"><meta property="og:site_name" content="凡间的精灵"><meta property="og:description" content="1、Zabbix 简介Zabbix是完全开源的工具，整合了cacti和nagios等特性cacti:snmpnagios:linux主机:nrpe 设备：snmp附：SNMP(udp 161 udp 162)众多网络工具都支持此协议，比如常见路由交换，常见OS其既可以做管理端也可以做被管理端snmp协议大致有3个版本分别是v1 v2 v3无论是v1 和 v2 的安全性是比较差的，因为传输是明文的，"><meta property="og:locale" content="zh-Hans"><meta property="og:image" content="http:&#x2F;&#x2F;chenzhonzhou.github.io&#x2F;2016&#x2F;06&#x2F;21&#x2F;zabbix-jian-kong-xi-tong&#x2F;%E5%9B%BE%E7%89%871.png"><meta property="og:image" content="http:&#x2F;&#x2F;chenzhonzhou.github.io&#x2F;2016&#x2F;06&#x2F;21&#x2F;zabbix-jian-kong-xi-tong&#x2F;%E5%9B%BE%E7%89%872.png"><meta property="og:image" content="http:&#x2F;&#x2F;chenzhonzhou.github.io&#x2F;2016&#x2F;06&#x2F;21&#x2F;zabbix-jian-kong-xi-tong&#x2F;%E5%9B%BE%E7%89%873.png"><meta property="og:image" content="http:&#x2F;&#x2F;chenzhonzhou.github.io&#x2F;2016&#x2F;06&#x2F;21&#x2F;zabbix-jian-kong-xi-tong&#x2F;%E5%9B%BE%E7%89%874.png"><meta property="og:image" content="http:&#x2F;&#x2F;chenzhonzhou.github.io&#x2F;2016&#x2F;06&#x2F;21&#x2F;zabbix-jian-kong-xi-tong&#x2F;%E5%9B%BE%E7%89%875.png"><meta property="og:image" content="http:&#x2F;&#x2F;chenzhonzhou.github.io&#x2F;2016&#x2F;06&#x2F;21&#x2F;zabbix-jian-kong-xi-tong&#x2F;%E5%9B%BE%E7%89%876.png"><meta property="og:image" content="http:&#x2F;&#x2F;chenzhonzhou.github.io&#x2F;2016&#x2F;06&#x2F;21&#x2F;zabbix-jian-kong-xi-tong&#x2F;%E5%9B%BE%E7%89%877.png"><meta property="og:image" content="http:&#x2F;&#x2F;chenzhonzhou.github.io&#x2F;2016&#x2F;06&#x2F;21&#x2F;zabbix-jian-kong-xi-tong&#x2F;%E5%9B%BE%E7%89%878.png"><meta property="og:image" content="http:&#x2F;&#x2F;chenzhonzhou.github.io&#x2F;2016&#x2F;06&#x2F;21&#x2F;zabbix-jian-kong-xi-tong&#x2F;%E5%9B%BE%E7%89%879.png"><meta property="og:image" content="http:&#x2F;&#x2F;chenzhonzhou.github.io&#x2F;2016&#x2F;06&#x2F;21&#x2F;zabbix-jian-kong-xi-tong&#x2F;%E5%9B%BE%E7%89%8710.png"><meta property="og:image" content="http:&#x2F;&#x2F;chenzhonzhou.github.io&#x2F;2016&#x2F;06&#x2F;21&#x2F;zabbix-jian-kong-xi-tong&#x2F;%E5%9B%BE%E7%89%8711.png"><meta property="og:image" content="http:&#x2F;&#x2F;chenzhonzhou.github.io&#x2F;2016&#x2F;06&#x2F;21&#x2F;zabbix-jian-kong-xi-tong&#x2F;%E5%9B%BE%E7%89%8712.png"><meta property="og:image" content="http:&#x2F;&#x2F;chenzhonzhou.github.io&#x2F;2016&#x2F;06&#x2F;21&#x2F;zabbix-jian-kong-xi-tong&#x2F;%E5%9B%BE%E7%89%8713.png"><meta property="og:image" content="http:&#x2F;&#x2F;chenzhonzhou.github.io&#x2F;2016&#x2F;06&#x2F;21&#x2F;zabbix-jian-kong-xi-tong&#x2F;%E5%9B%BE%E7%89%8714.png"><meta property="og:image" content="http:&#x2F;&#x2F;chenzhonzhou.github.io&#x2F;2016&#x2F;06&#x2F;21&#x2F;zabbix-jian-kong-xi-tong&#x2F;%E5%9B%BE%E7%89%8715.png"><meta property="og:image" content="http:&#x2F;&#x2F;chenzhonzhou.github.io&#x2F;2016&#x2F;06&#x2F;21&#x2F;zabbix-jian-kong-xi-tong&#x2F;%E5%9B%BE%E7%89%8716.png"><meta property="og:image" content="http:&#x2F;&#x2F;chenzhonzhou.github.io&#x2F;2016&#x2F;06&#x2F;21&#x2F;zabbix-jian-kong-xi-tong&#x2F;%E5%9B%BE%E7%89%8717.png"><meta property="og:image" content="http:&#x2F;&#x2F;chenzhonzhou.github.io&#x2F;2016&#x2F;06&#x2F;21&#x2F;zabbix-jian-kong-xi-tong&#x2F;%E5%9B%BE%E7%89%8718.png"><meta property="og:image" content="http:&#x2F;&#x2F;chenzhonzhou.github.io&#x2F;2016&#x2F;06&#x2F;21&#x2F;zabbix-jian-kong-xi-tong&#x2F;%E5%9B%BE%E7%89%8719.png"><meta property="og:image" content="http:&#x2F;&#x2F;chenzhonzhou.github.io&#x2F;2016&#x2F;06&#x2F;21&#x2F;zabbix-jian-kong-xi-tong&#x2F;%E5%9B%BE%E7%89%8720.png"><meta property="og:image" content="http:&#x2F;&#x2F;chenzhonzhou.github.io&#x2F;2016&#x2F;06&#x2F;21&#x2F;zabbix-jian-kong-xi-tong&#x2F;%E5%9B%BE%E7%89%8721.png"><meta property="og:image" content="http:&#x2F;&#x2F;chenzhonzhou.github.io&#x2F;2016&#x2F;06&#x2F;21&#x2F;zabbix-jian-kong-xi-tong&#x2F;%E5%9B%BE%E7%89%8722.png"><meta property="og:image" content="http:&#x2F;&#x2F;chenzhonzhou.github.io&#x2F;2016&#x2F;06&#x2F;21&#x2F;zabbix-jian-kong-xi-tong&#x2F;%E5%9B%BE%E7%89%8723.png"><meta property="og:image" content="http:&#x2F;&#x2F;chenzhonzhou.github.io&#x2F;2016&#x2F;06&#x2F;21&#x2F;zabbix-jian-kong-xi-tong&#x2F;%E5%9B%BE%E7%89%8724.png"><meta property="og:image" content="http:&#x2F;&#x2F;chenzhonzhou.github.io&#x2F;2016&#x2F;06&#x2F;21&#x2F;zabbix-jian-kong-xi-tong&#x2F;%E5%9B%BE%E7%89%8725.png"><meta property="og:image" content="http:&#x2F;&#x2F;chenzhonzhou.github.io&#x2F;2016&#x2F;06&#x2F;21&#x2F;zabbix-jian-kong-xi-tong&#x2F;%E5%9B%BE%E7%89%8726.png"><meta property="og:image" content="http:&#x2F;&#x2F;chenzhonzhou.github.io&#x2F;2016&#x2F;06&#x2F;21&#x2F;zabbix-jian-kong-xi-tong&#x2F;%E5%9B%BE%E7%89%8727.png"><meta property="og:image" content="http:&#x2F;&#x2F;chenzhonzhou.github.io&#x2F;2016&#x2F;06&#x2F;21&#x2F;zabbix-jian-kong-xi-tong&#x2F;%E5%9B%BE%E7%89%8728.png"><meta property="og:image" content="http:&#x2F;&#x2F;chenzhonzhou.github.io&#x2F;2016&#x2F;06&#x2F;21&#x2F;zabbix-jian-kong-xi-tong&#x2F;%E5%9B%BE%E7%89%8729.png"><meta property="og:image" content="http:&#x2F;&#x2F;chenzhonzhou.github.io&#x2F;2016&#x2F;06&#x2F;21&#x2F;zabbix-jian-kong-xi-tong&#x2F;%E5%9B%BE%E7%89%8730.png"><meta property="og:image" content="http:&#x2F;&#x2F;chenzhonzhou.github.io&#x2F;2016&#x2F;06&#x2F;21&#x2F;zabbix-jian-kong-xi-tong&#x2F;%E5%9B%BE%E7%89%8731.png"><meta property="og:image" content="http:&#x2F;&#x2F;chenzhonzhou.github.io&#x2F;2016&#x2F;06&#x2F;21&#x2F;zabbix-jian-kong-xi-tong&#x2F;%E5%9B%BE%E7%89%8732.png"><meta property="og:image" content="http:&#x2F;&#x2F;chenzhonzhou.github.io&#x2F;2016&#x2F;06&#x2F;21&#x2F;zabbix-jian-kong-xi-tong&#x2F;%E5%9B%BE%E7%89%8733.png"><meta property="og:image" content="http:&#x2F;&#x2F;chenzhonzhou.github.io&#x2F;2016&#x2F;06&#x2F;21&#x2F;zabbix-jian-kong-xi-tong&#x2F;%E5%9B%BE%E7%89%8734.png"><meta property="og:image" content="http:&#x2F;&#x2F;chenzhonzhou.github.io&#x2F;2016&#x2F;06&#x2F;21&#x2F;zabbix-jian-kong-xi-tong&#x2F;%E5%9B%BE%E7%89%8735.png"><meta property="og:image" content="http:&#x2F;&#x2F;chenzhonzhou.github.io&#x2F;2016&#x2F;06&#x2F;21&#x2F;zabbix-jian-kong-xi-tong&#x2F;%E5%9B%BE%E7%89%8736.png"><meta property="og:image" content="http:&#x2F;&#x2F;chenzhonzhou.github.io&#x2F;2016&#x2F;06&#x2F;21&#x2F;zabbix-jian-kong-xi-tong&#x2F;%E5%9B%BE%E7%89%8737.png"><meta property="og:image" content="http:&#x2F;&#x2F;chenzhonzhou.github.io&#x2F;2016&#x2F;06&#x2F;21&#x2F;zabbix-jian-kong-xi-tong&#x2F;%E5%9B%BE%E7%89%8738.png"><meta property="og:image" content="http:&#x2F;&#x2F;chenzhonzhou.github.io&#x2F;2016&#x2F;06&#x2F;21&#x2F;zabbix-jian-kong-xi-tong&#x2F;%E5%9B%BE%E7%89%8739.png"><meta property="og:image" content="http:&#x2F;&#x2F;chenzhonzhou.github.io&#x2F;2016&#x2F;06&#x2F;21&#x2F;zabbix-jian-kong-xi-tong&#x2F;%E5%9B%BE%E7%89%8740.png"><meta property="og:image" content="http:&#x2F;&#x2F;chenzhonzhou.github.io&#x2F;2016&#x2F;06&#x2F;21&#x2F;zabbix-jian-kong-xi-tong&#x2F;%E5%9B%BE%E7%89%8741.png"><meta property="og:image" content="http:&#x2F;&#x2F;chenzhonzhou.github.io&#x2F;2016&#x2F;06&#x2F;21&#x2F;zabbix-jian-kong-xi-tong&#x2F;%E5%9B%BE%E7%89%8742.png"><meta property="og:image" content="http:&#x2F;&#x2F;chenzhonzhou.github.io&#x2F;2016&#x2F;06&#x2F;21&#x2F;zabbix-jian-kong-xi-tong&#x2F;%E5%9B%BE%E7%89%8743.png"><meta property="og:image" content="http:&#x2F;&#x2F;chenzhonzhou.github.io&#x2F;2016&#x2F;06&#x2F;21&#x2F;zabbix-jian-kong-xi-tong&#x2F;%E5%9B%BE%E7%89%8744.png"><meta property="og:image" content="http:&#x2F;&#x2F;chenzhonzhou.github.io&#x2F;2016&#x2F;06&#x2F;21&#x2F;zabbix-jian-kong-xi-tong&#x2F;%E5%9B%BE%E7%89%8745.png"><meta property="og:image" content="http:&#x2F;&#x2F;chenzhonzhou.github.io&#x2F;2016&#x2F;06&#x2F;21&#x2F;zabbix-jian-kong-xi-tong&#x2F;%E5%9B%BE%E7%89%8746.png"><meta property="og:image" content="http:&#x2F;&#x2F;chenzhonzhou.github.io&#x2F;2016&#x2F;06&#x2F;21&#x2F;zabbix-jian-kong-xi-tong&#x2F;%E5%9B%BE%E7%89%8747.png"><meta property="og:image" content="http:&#x2F;&#x2F;chenzhonzhou.github.io&#x2F;2016&#x2F;06&#x2F;21&#x2F;zabbix-jian-kong-xi-tong&#x2F;%E5%9B%BE%E7%89%8748.png"><meta property="og:image" content="http:&#x2F;&#x2F;chenzhonzhou.github.io&#x2F;2016&#x2F;06&#x2F;21&#x2F;zabbix-jian-kong-xi-tong&#x2F;%E5%9B%BE%E7%89%8749.png"><meta property="og:image" content="http:&#x2F;&#x2F;chenzhonzhou.github.io&#x2F;2016&#x2F;06&#x2F;21&#x2F;zabbix-jian-kong-xi-tong&#x2F;%E5%9B%BE%E7%89%8750.png"><meta property="og:image" content="http:&#x2F;&#x2F;chenzhonzhou.github.io&#x2F;2016&#x2F;06&#x2F;21&#x2F;zabbix-jian-kong-xi-tong&#x2F;%E5%9B%BE%E7%89%8751.png"><meta property="og:image" content="http:&#x2F;&#x2F;chenzhonzhou.github.io&#x2F;2016&#x2F;06&#x2F;21&#x2F;zabbix-jian-kong-xi-tong&#x2F;%E5%9B%BE%E7%89%8752.png"><meta property="og:image" content="http:&#x2F;&#x2F;chenzhonzhou.github.io&#x2F;2016&#x2F;06&#x2F;21&#x2F;zabbix-jian-kong-xi-tong&#x2F;%E5%9B%BE%E7%89%8753.png"><meta property="og:image" content="http:&#x2F;&#x2F;chenzhonzhou.github.io&#x2F;2016&#x2F;06&#x2F;21&#x2F;zabbix-jian-kong-xi-tong&#x2F;%E5%9B%BE%E7%89%8754.png"><meta property="og:image" content="http:&#x2F;&#x2F;chenzhonzhou.github.io&#x2F;2016&#x2F;06&#x2F;21&#x2F;zabbix-jian-kong-xi-tong&#x2F;%E5%9B%BE%E7%89%8755.png"><meta property="og:image" content="http:&#x2F;&#x2F;chenzhonzhou.github.io&#x2F;2016&#x2F;06&#x2F;21&#x2F;zabbix-jian-kong-xi-tong&#x2F;%E5%9B%BE%E7%89%8756.png"><meta property="og:image" content="http:&#x2F;&#x2F;chenzhonzhou.github.io&#x2F;2016&#x2F;06&#x2F;21&#x2F;zabbix-jian-kong-xi-tong&#x2F;%E5%9B%BE%E7%89%8757.png"><meta property="og:image" content="http:&#x2F;&#x2F;chenzhonzhou.github.io&#x2F;2016&#x2F;06&#x2F;21&#x2F;zabbix-jian-kong-xi-tong&#x2F;%E5%9B%BE%E7%89%8758.png"><meta property="og:image" content="http:&#x2F;&#x2F;chenzhonzhou.github.io&#x2F;2016&#x2F;06&#x2F;21&#x2F;zabbix-jian-kong-xi-tong&#x2F;%E5%9B%BE%E7%89%8759.png"><meta property="og:image" content="http:&#x2F;&#x2F;chenzhonzhou.github.io&#x2F;2016&#x2F;06&#x2F;21&#x2F;zabbix-jian-kong-xi-tong&#x2F;%E5%9B%BE%E7%89%8760.png"><meta property="og:updated_time" content="2019-11-19T02:54:08.983Z"><meta name="twitter:card" content="summary"><meta name="twitter:image" content="http:&#x2F;&#x2F;chenzhonzhou.github.io&#x2F;2016&#x2F;06&#x2F;21&#x2F;zabbix-jian-kong-xi-tong&#x2F;%E5%9B%BE%E7%89%871.png"><script type="text/javascript" id="hexo.configurations">var NexT=window.NexT||{},CONFIG={root:"/",scheme:"Gemini",version:"5.1.4",sidebar:{position:"left",display:"always",offset:12,b2t:!0,scrollpercent:!0,onmobile:!0},fancybox:!0,tabs:!0,motion:{enable:!0,async:!1,transition:{post_block:"fadeIn",post_header:"slideDownIn",post_body:"slideDownIn",coll_header:"slideLeftIn",sidebar:"slideUpIn"}},duoshuo:{userId:"0",author:"博主"},algolia:{applicationID:"",apiKey:"",indexName:"",hits:{per_page:10},labels:{input_placeholder:"Search for Posts",hits_empty:"We didn't find any results for the search: ${query}",hits_stats:"${hits} results found in ${time} ms"}}}</script><link rel="canonical" href="http://chenzhonzhou.github.io/2016/06/21/zabbix-jian-kong-xi-tong/"><title>Zabbix 监控系统 | 凡间的精灵</title><link rel="stylesheet" href="/css/prism-tomorrow.css" type="text/css"></head><body itemscope itemtype="http://schema.org/WebPage" lang="zh-Hans"><div class="container sidebar-position-left page-post-detail"><div class="headband"></div><header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader"><div class="header-inner"><div class="site-brand-wrapper"><div class="site-meta"><div class="custom-logo-site-title"><a href="/" class="brand" rel="start"><span class="logo-line-before"><i></i></span> <span class="site-title">凡间的精灵</span> <span class="logo-line-after"><i></i></span></a></div><p class="site-subtitle">凡尘落素一精灵</p></div><div class="site-nav-toggle"><button><span class="btn-bar"></span> <span class="btn-bar"></span> <span class="btn-bar"></span></button></div></div><nav class="site-nav"><ul id="menu" class="menu"><li class="menu-item menu-item-home"><a href="/" rel="section"><i class="menu-item-icon fa fa-fw fa-home"></i><br>首页</a></li><li class="menu-item menu-item-archives"><a href="/archives/" rel="section"><i class="menu-item-icon fa fa-fw fa-archive"></i><br>归档</a></li><li class="menu-item menu-item-categories"><a href="/categories" rel="section"><i class="menu-item-icon fa fa-fw fa-th"></i><br>分类</a></li><li class="menu-item menu-item-tags"><a href="/tags" rel="section"><i class="menu-item-icon fa fa-fw fa-tags"></i><br>标签</a></li><li class="menu-item menu-item-sitemap"><a href="/sitemap.xml" rel="section"><i class="menu-item-icon fa fa-fw fa-sitemap"></i><br>站点地图</a></li><li class="menu-item menu-item-search"><a href="javascript:;" class="popup-trigger"><i class="menu-item-icon fa fa-search fa-fw"></i><br>搜索</a></li></ul><div class="site-search"><div class="popup search-popup local-search-popup"><div class="local-search-header clearfix"><span class="search-icon"><i class="fa fa-search"></i> </span><span class="popup-btn-close"><i class="fa fa-times-circle"></i></span><div class="local-search-input-wrapper"><input autocomplete="off" placeholder="搜索..." spellcheck="false" type="text" id="local-search-input"></div></div><div id="local-search-result"></div></div></div></nav></div></header><main id="main" class="main"><div class="main-inner"><div class="content-wrap"><div id="content" class="content"><div id="posts" class="posts-expand"><article class="post post-type-normal" itemscope itemtype="http://schema.org/Article"><div class="post-block"><link itemprop="mainEntityOfPage" href="http://chenzhonzhou.github.io/2016/06/21/zabbix-jian-kong-xi-tong/"><span hidden itemprop="author" itemscope itemtype="http://schema.org/Person"><meta itemprop="name" content="Zhongzhou Chen"><meta itemprop="description" content=""><meta itemprop="image" content="/images/chen.png"></span><span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization"><meta itemprop="name" content="凡间的精灵"></span><header class="post-header"><h1 class="post-title" itemprop="name headline">Zabbix 监控系统</h1><div class="post-meta"><span class="post-time"><span class="post-meta-item-icon"><i class="fa fa-calendar-o"></i> </span><span class="post-meta-item-text">发表于</span> <time title="创建于" itemprop="dateCreated datePublished" datetime="2016-06-21T14:05:15+08:00">2016-06-21 </time></span><span class="post-category"><span class="post-meta-divider">|</span> <span class="post-meta-item-icon"><i class="fa fa-folder-o"></i> </span><span class="post-meta-item-text">分类于</span> <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/%E7%9B%91%E6%8E%A7%E7%B3%BB%E7%BB%9F/" itemprop="url" rel="index"><span itemprop="name">监控系统</span> </a></span>， <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/%E7%9B%91%E6%8E%A7%E7%B3%BB%E7%BB%9F/Zabbix/" itemprop="url" rel="index"><span itemprop="name">Zabbix</span></a></span></span><div class="post-wordcount"><span class="post-meta-item-icon"><i class="fa fa-file-word-o"></i> </span><span class="post-meta-item-text">字数统计&#58;</span> <span title="字数统计">8.5k </span><span class="post-meta-divider">|</span> <span class="post-meta-item-icon"><i class="fa fa-clock-o"></i> </span><span class="post-meta-item-text">阅读时长 &asymp;</span> <span title="阅读时长">39</span></div></div></header><div class="post-body" itemprop="articleBody"><h2 id="1、Zabbix-简介"><a href="#1、Zabbix-简介" class="headerlink" title="1、Zabbix 简介"></a>1、Zabbix 简介</h2><p><strong>Zabbix</strong>是完全开源的工具，整合了<strong>cacti</strong>和<strong>nagios</strong>等特性<br>cacti:snmp<br>nagios:linux主机:nrpe 设备：snmp<br>附：SNMP(udp 161 udp 162)<br>众多网络工具都支持此协议，比如常见路由交换，常见OS<br>其既可以做管理端也可以做被管理端<br>snmp协议大致有3个版本分别是v1 v2 v3<br>无论是v1 和 v2 的安全性是比较差的，因为传输是明文的， V3的认证密码用MD5/SHA摘要算法加密</p><p>很多工具支持网络管理的功能，而对于非网络设备（操作系统），可以完全抛开snmp这种不安全的架构来实现监控的。所以很多工具都是控制端和agent架构，他们有专属的agent。</p><h3 id="Zabbix的主要功能"><a href="#Zabbix的主要功能" class="headerlink" title="Zabbix的主要功能"></a>Zabbix的主要功能</h3><p>具备常见的商业监控软件所具备的功能（主机的性能监控、网络设备性能监控、数据库、FTP 等通用协议监控、多种告警方式、详细的报表图表绘制）<br>支持自动发现网络设备和服务器（可以通过配置自动发现服务器规则来实现）<br>支持分布式，能集中展示、管理分布式的监控点，扩展性强;<br>server 提供通用接口（api 功能），可以自己开发完善各类监控（根据相关接口编写程序实现），编写插件容易，可以自定义监控项，报警级别的设置。<br>数据收集，支持 snmp(包括 trapping and polling )，IPMI，JMX，SSH，TELNET；<br>自定义的检测；自定义收集数据的频率；<br>服务器/代理和客户端模式；<br>灵活的触发器；可以定义非常灵活的问题阈值，称为触发器；<br>高可定制的报警；发送通知，可定制的报警升级，收件人，媒体类型。<br>CPU负荷、内存使用、磁盘使用、网络状况、端口监视、日志监视等等。<br>硬件监控：Zabbix IPMI Interface<br>系统监控：ZabbixAgent Interface<br>Java监控：Zabbix JMX Interface<br>网络设备监控：Zabbix SNMP Interface<br>应用服务监控：Zabbix Agent UserParameter<br>MySQL数据库监控：percona-monitoring-plulgins<br>URL监控：Zabbix Web 监控</p><h3 id="zabbix重要组件说明"><a href="#zabbix重要组件说明" class="headerlink" title="zabbix重要组件说明"></a>zabbix重要组件说明</h3><p>1）zabbix server:负责接收agent发送的报告信息的核心组件，所有配置、统计数据及操作数据都由它组织进行；<br>2）database storage：专用于存储所有配置信息，以及由zabbix收集的数据；<br>3）web interface：zabbix的GUI接口；<br>4）proxy：可选组件，常用于监控节点很多的分布式环境中，代理server收集部分数据转发到server，可以减轻server的压力；<br>5）agent：部署在被监控的主机上，负责收集主机本地数据如cpu、内存、数据库等数据发往server端或proxy端；<br>另外，zabbix server、proxy、agent都有自己的配置文件以及log文件，重要的参数需要在这里配置，后面会详细说明。<br>一个监控系统运行的大概的流程是这样的：<br>agentd需要安装到被监控的主机上，它负责定期收集各项数据，并发送到zabbix server端，zabbix server将数据存储到数据库中，zabbix web根据数据在前端进行展现和绘图。这里agentd收集数据分为主动和被动两种模式：<br>主动：agent请求server获取主动的监控项列表，并主动将监控项内需要检测的数据提交给server/proxy<br>被动：server向agent请求获取监控项的数据，agent返回数据。</p><h3 id="zabbix常用的监控架构平台"><a href="#zabbix常用的监控架构平台" class="headerlink" title="zabbix常用的监控架构平台"></a>zabbix常用的监控架构平台</h3><ol><li><p>server-agentd模式：</p><p>这个是最简单的架构了，常用于监控主机比较少的情况下。</p></li><li><p>server-proxy-agentd模式：</p><p>这个常用于比较多的机器，使用proxy进行分布式监控，有效的减轻server端的压力。</p></li></ol><h3 id="zabbix的系统架构"><a href="#zabbix的系统架构" class="headerlink" title="zabbix的系统架构"></a>zabbix的系统架构</h3><p><img src="/2016/06/21/zabbix-jian-kong-xi-tong/%E5%9B%BE%E7%89%871.png" alt></p><p>Zabbix是一个基于Web界面的提供分布式系统监视以及网络监视功能的企业级开源解决方案。借助Zabbix,可以很轻松地减轻运维人员们繁重的服务器管理任务，实现业务系统的持续运行。下面会逐步介绍Zabbix分布式监控系统的部署及使用</p><p>配置好IP、DNS 、网关，确保使用远程连接工具能够连接服务器</p><p>zabbix监控服务器：192.168.130.76 #zabbix的服务端（若要监控本机，则需要配置本机的zabbix agent)</p><p>Zabbix agent被监控主机：192.168.130.78#zabbix的客户端（被监控端，需要配置Zabbix agent</p><h2 id="2、Zabbix部署前的LNMP环境部署"><a href="#2、Zabbix部署前的LNMP环境部署" class="headerlink" title="2、Zabbix部署前的LNMP环境部署"></a>2、Zabbix部署前的LNMP环境部署</h2><p><strong>环境描述：</strong></p><table><thead><tr><th>服务</th><th>版本</th></tr></thead><tbody><tr><td>Linux</td><td>Centos 7.2</td></tr><tr><td>mysql</td><td>mysql-5.7.13</td></tr><tr><td>nginx</td><td>nginx-1.10.2</td></tr><tr><td>php</td><td>php-5.6</td></tr><tr><td>zabbix</td><td>zabbix-3.2.1</td></tr></tbody></table><h3 id="2-1-安装编译工具及库文件"><a href="#2-1-安装编译工具及库文件" class="headerlink" title="2.1 安装编译工具及库文件"></a>2.1 安装编译工具及库文件</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[root@mysqla ~]# yum -y install make apr* autoconf automake curl-devel gcc gcc-c++  openssl openssl-devel gd kernel keyutils patch perl kernel-headers compat* mpfr cpp glibc libgomp libstdc++-devel keyutils-libs-devel libcom_err-devel libsepol-devel libselinux-devel krb5-devel zlib-devel libXpm* freetype libjpeg* libpng*  libtool* libxml2 libxml2-devel patch libcurl-devel bzip2-devel freetype-devel</span><br></pre></td></tr></table></figure><h3 id="2-2-安装mysql5-7-13"><a href="#2-2-安装mysql5-7-13" class="headerlink" title="2.2 安装mysql5.7.13"></a>2.2 安装mysql5.7.13</h3><p><strong>系统环境：centos7.2 x86_64</strong></p><p>因为centos7.2默认安装了mariadb-libs，所以先要卸载掉<br>查看是否安装mariadb</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"># rpm -qa | grep mariadb</span><br></pre></td></tr></table></figure><p>卸载mariadb</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"># rpm -e --nodeps mariadb-libs</span><br></pre></td></tr></table></figure><p><strong>安装依赖包</strong><br>注： 相关依赖包的作用<br><strong>cmake</strong>：由于从MySQL5.5版本开始弃用了常规的configure编译方法，所以需要CMake编译器，用于设置mysql的编译参数。如：安装目录、数据存放目录、字符编码、排序规则等。<br><strong>Boost</strong> #从MySQL 5.7.5开始Boost库是必需的，mysql源码中用到了C++的Boost库，要求必须安装boost1.59.0或以上版本<br><strong>GCC</strong>是Linux下的C语言编译工具，mysql源码编译完全由C和C++编写，要求必须安装GCC<br><strong>bison</strong>：Linux下C/C++语法分析器<br><strong>ncurses</strong>：字符终端处理库</p><p>安装文件准备<br>下载cmake-3.5.tar.gz <a href="http://mysqla.cmake.org/download/" target="_blank" rel="noopener">http://mysqla.cmake.org/download/</a><br>下载ncurses-5.9.tar.gz <a href="http://ftp.gnu.org/gnu/ncurses/" target="_blank" rel="noopener">http://ftp.gnu.org/gnu/ncurses/</a><br>下载bison-3.0.4.tar.gz <a href="http://ftp.gnu.org/gnu/bison/" target="_blank" rel="noopener">http://ftp.gnu.org/gnu/bison/</a><br>下载mysql-5.7.13.tar.gz<br>wget <a href="http://cdn.mysql.com/Downloads/MySQL-5.7/mysql-5.7.13.tar.gz" target="_blank" rel="noopener">http://cdn.mysql.com/Downloads/MySQL-5.7/mysql-5.7.13.tar.gz</a><br>下载Boost_1_59_0.tar.gz<br>wget <a href="http://nchc.dl.sourceforge.net/project/boost/boost/1.59.0/boost_1_59_0.tar.gz" target="_blank" rel="noopener">http://nchc.dl.sourceforge.net/project/boost/boost/1.59.0/boost_1_59_0.tar.gz</a></p><p><strong>安装CMAKE及必要的软件</strong><br>安装cmake</p><p><img src="/2016/06/21/zabbix-jian-kong-xi-tong/%E5%9B%BE%E7%89%872.png" alt="img"></p><p><img src="/2016/06/21/zabbix-jian-kong-xi-tong/%E5%9B%BE%E7%89%873.png" alt="img"></p><p>cmake –version —查看cmake版本</p><p><img src="/2016/06/21/zabbix-jian-kong-xi-tong/%E5%9B%BE%E7%89%874.png" alt="img"></p><p>安装ncurses</p><p><img src="/2016/06/21/zabbix-jian-kong-xi-tong/%E5%9B%BE%E7%89%875.png" alt="image-20191119092829001"></p><p>安装bison</p><p><img src="/2016/06/21/zabbix-jian-kong-xi-tong/%E5%9B%BE%E7%89%876.png" alt="image-20191119092837866"></p><p>安装bootst</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">tar zxf  boost_1_59_0.tar.gz </span><br><span class="line">mv boost_1_59_0 /usr/local/boost</span><br></pre></td></tr></table></figure><p><strong>创建mysql用户和用户组及目录</strong></p><p>新建msyql组和msyql用户禁止登录shell</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">groupadd -r mysql &amp;&amp; useradd -r -g mysql -s /bin/false -M mysql</span><br></pre></td></tr></table></figure><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"># mkdir /usr/local/mysql        ---创建目录</span><br><span class="line"># mkdir /usr/local/mysql/data    ---数据库目录</span><br></pre></td></tr></table></figure><p><strong>编译安装mysql</strong></p><p>解压mysql源码包</p><p><img src="/2016/06/21/zabbix-jian-kong-xi-tong/%E5%9B%BE%E7%89%877.png" alt="img"></p><p>执行cmake命令进行编译前的配置：</p><p><img src="/2016/06/21/zabbix-jian-kong-xi-tong/%E5%9B%BE%E7%89%878.png" alt="img"></p><p>开始编译、编译安装：</p><p><img src="/2016/06/21/zabbix-jian-kong-xi-tong/%E5%9B%BE%E7%89%879.png" alt="img"></p><p>注1：配置解释：<br>-DCMAKE_INSTALL_PREFIX=/usr/local/mysql[MySQL安装的根目录]-DMYSQL_DATADIR=/usr/local/mysql /data[MySQL数据库文件存放目录]<br>-DSYSCONFDIR=/etc [MySQL配置文件所在目录]<br>-DWITH_MYISAM_STORAGE_ENGINE=1 [添加MYISAM引擎支持]<br>-DWITH_INNOBASE_STORAGE_ENGINE=1[添加InnoDB引擎支持]<br>-DWITH_ARCHIVE_STORAGE_ENGINE=1 [添加ARCHIVE引擎支持]<br>-DMYSQL_UNIX_ADDR=/usr/local/mysql /mysql.sock[指定mysql.sock位置]<br>-DWITH_PARTITION_STORAGE_ENGINE=1[安装支持数据库分区]<br>-DEXTRA_CHARSETS=all [使MySQL支持所有的扩展字符]<br>-DDEFAULT_CHARSET=utf8[设置MySQL的默认字符集为utf8]-DDEFAULT_COLLATION=utf8_general_ci [设置默认字符集校对规则]<br>-DWITH-SYSTEMD=1 [可以使用systemd控制mysql服务]<br>-DWITH_BOOST=/usr/local/boost [指向boost库所在目录]</p><p>更多参数执行</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[root@localhost mysql-5.7.13]# cmake . –LH</span><br></pre></td></tr></table></figure><p>注2：为了加快编译速度可以按下面的方式编译安装</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">make -j $(grep processor /proc/cpuinfo | wc –l)</span><br></pre></td></tr></table></figure><p>-j参数表示根据CPU核数指定编译时的线程数，可以加快编译速度。默认为1个线程编译。</p><p>注3：若要重新运行cmake配置，需要删除CMakeCache.txt文件</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"># make clean</span><br><span class="line"># rm -f CMakeCache.txt</span><br></pre></td></tr></table></figure><p>优化Mysql的执行路径</p><p><img src="/2016/06/21/zabbix-jian-kong-xi-tong/%E5%9B%BE%E7%89%8710.png" alt="img"></p><p><strong>设置权限并初始化MySQL系统授权表</strong></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">cd/usr/local/mysql</span><br><span class="line"></span><br><span class="line">chown -R mysql:mysql  .       ---更改所有者,属组，注意是mysql .</span><br><span class="line"># bin/mysqld --initialize--user=mysql --basedir=/usr/local/mysql --datadir=/usr/local/mysql/data</span><br></pre></td></tr></table></figure><p>注1：以root初始化操作时要加–user=mysql参数，生成一个随机密码（注意保存登录时用）<br>注2：MySQL 5.7.6之前的版本执行这个脚本初始化系统数据库</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">/usr/local/mysql/bin/mysql_install_db --user=mysql --basedir=/usr/local/mysql --datadir=/usr/local/mysql/data</span><br></pre></td></tr></table></figure><p>5.7.6之后版本初始系统数据库脚本（本文使用此方式初始化）</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">#/usr/local/mysql/bin/mysqld --initialize-insecure--user=mysql --basedir=/usr/local/mysql --datadir=/usr/local/mysql/data</span><br></pre></td></tr></table></figure><p><img src="/2016/06/21/zabbix-jian-kong-xi-tong/%E5%9B%BE%E7%89%8711.png" alt="image-20191119093227573"></p><p>注意：如果使用–initialize参数初始化系统数据库之后，会生成root用户的一个临时密码，如上图高亮中所示。</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"># chown -Rmysql:mysql .       ---改所有者，注意是root .</span><br></pre></td></tr></table></figure><p><strong>创建配置文件</strong></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"># cd/usr/local/mysql/support-files     ---进入MySQL安装目录支持文件目录</span><br><span class="line"># cp my-default.cnf /etc/my.cnf    ---复制模板为新的配置文件，</span><br></pre></td></tr></table></figure><p><img src="/2016/06/21/zabbix-jian-kong-xi-tong/%E5%9B%BE%E7%89%8712.png" alt="img"></p><p>修改文件中配置选项，如下图所示，添加如下配置项</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"># vi  /etc/my.cnf</span><br></pre></td></tr></table></figure><p><img src="/2016/06/21/zabbix-jian-kong-xi-tong/%E5%9B%BE%E7%89%8713.png" alt="img"></p><p>配置mysql自动启动</p><p><img src="/2016/06/21/zabbix-jian-kong-xi-tong/%E5%9B%BE%E7%89%8714.png" alt="img"></p><p><img src="/2016/06/21/zabbix-jian-kong-xi-tong/%E5%9B%BE%E7%89%8715.png" alt="img"></p><p>服务启动失败，查看错误日志文件</p><p><img src="/2016/06/21/zabbix-jian-kong-xi-tong/%E5%9B%BE%E7%89%8716.png" alt="img"></p><p>在mysqld.service，把默认的pid文件指定到了/var/run/mysqld/目录，而并没有事先建立该目录，因此要手动建立该目录并把权限赋给mysql用户。</p><p><img src="/2016/06/21/zabbix-jian-kong-xi-tong/%E5%9B%BE%E7%89%8717.png" alt="img"></p><p>或者修改/usr/lib/system/system/mysqld.service，修改内容如下：</p><p><img src="/2016/06/21/zabbix-jian-kong-xi-tong/%E5%9B%BE%E7%89%8718.png" alt="img"></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"># systemctl  daemon-reload</span><br></pre></td></tr></table></figure><p>再次启动mysql服务</p><p><img src="/2016/06/21/zabbix-jian-kong-xi-tong/%E5%9B%BE%E7%89%8719.png" alt="img"></p><p>查看端口号</p><p><img src="/2016/06/21/zabbix-jian-kong-xi-tong/%E5%9B%BE%E7%89%8720.png" alt="img"></p><p>服务启动成功</p><p>访问MySQL数据库</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"># mysql -u root -h 127.0.0.1 -p     ---连接mysql，输入初始化时生成的随机密码</span><br></pre></td></tr></table></figure><p><img src="/2016/06/21/zabbix-jian-kong-xi-tong/%E5%9B%BE%E7%89%8721.png" alt="img"></p><p>设置数据库管理员用户root的密码</p><p><img src="/2016/06/21/zabbix-jian-kong-xi-tong/%E5%9B%BE%E7%89%8722.png" alt="img"></p><h3 id="2-3-安装nginx"><a href="#2-3-安装nginx" class="headerlink" title="2.3 安装nginx"></a>2.3 安装nginx</h3><p>解压zlib</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[root@mysqla ~]# tar zxf zlib-1.2.8.tar.gz</span><br></pre></td></tr></table></figure><p>说明：不需要编译，只需要解压就行。<br>解压pcre</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[root@mysqla ~]# tar zxf pcre-8.39.tar.gz</span><br></pre></td></tr></table></figure><p>说明：不需要编译，只需要解压就行。</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">[root@mysqla ~]# groupadd www</span><br><span class="line">[root@mysqla ~]# useradd -g www www -s /sbin/nologin</span><br></pre></td></tr></table></figure><p>下载nginx的源码包：<a href="http://nginx.org/download" target="_blank" rel="noopener">http://nginx.org/download</a><br>解压源码包：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">[root@mysqla ~]# tar zxf nginx-1.10.2.tar.gz </span><br><span class="line">[root@mysqla ~]# cd nginx-1.10.2/</span><br><span class="line">[root@mysqla nginx-1.10.2]# ./configure --prefix=/usr/local/nginx1.10 --with-http_dav_module --with-http_stub_status_module --with-http_addition_module --with-http_sub_module  --with-http_flv_module --with-http_mp4_module --with-pcre=/root/pcre-8.39 --with-zlib=/root/zlib-1.2.8 --with-http_ssl_module --with-http_gzip_static_module --user=www --group=www</span><br><span class="line">[root@mysqla nginx-1.10.2]# make&amp;&amp; make install</span><br><span class="line">[root@mysqla ~]# ln -s /usr/local/nginx1.10/sbin/nginx /usr/local/sbin/</span><br><span class="line">[root@mysqla ~]# nginx</span><br><span class="line">[root@mysqla ~]# netstat -anpt | grep nginx</span><br><span class="line">tcp   0      0 0.0.0.0:80      0.0.0.0:*      LISTEN      11598/nginx: master</span><br><span class="line">[root@mysqla ~]# firewall-cmd --permanent --add-port=80/tcp</span><br><span class="line">success</span><br><span class="line">[root@mysqla ~]# firewall-cmd --reload </span><br><span class="line">success</span><br></pre></td></tr></table></figure><p>启动后可以再浏览器中打开页面，会显示nginx默认页面。</p><p><img src="/2016/06/21/zabbix-jian-kong-xi-tong/%E5%9B%BE%E7%89%8723.png" alt="image-20191119093628080"></p><h3 id="2-4-安装php"><a href="#2-4-安装php" class="headerlink" title="2.4 安装php"></a>2.4 安装php</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">[root@mysqla ~]# tar zxf libmcrypt-2.5.7.tar.gz </span><br><span class="line">[root@mysqla ~]# cd libmcrypt-2.5.7/</span><br><span class="line">[root@mysqla libmcrypt-2.5.7]# ./configure &amp;&amp; make &amp;&amp; make install</span><br><span class="line"># ln -s /usr/local/mysql/lib/libmysqlclient.so.20.3.0 /usr/local/mysql/lib/libmysqlclient_r.so</span><br><span class="line">[root@mysqla ~]# tar zxf php-5.6.27.tar.gz</span><br><span class="line">[root@mysqla ~]# cd php-5.6.27/</span><br><span class="line">[root@mysqla php-5.6.27]# ./configure --prefix=/usr/local/php5.6 --with-config-file-path=/etc  --with-mysql=/usr/local/mysql --with-mysqli=/usr/local/mysql/bin/mysql_config --with-mysql-sock=/usr/local/mysql/mysql.sock --with-gd --with-iconv --with-libxml-dir=/usr --with-mhash --with-mcrypt --with-config-file-scan-dir=/etc/php.d --with-bz2 --with-zlib --with-freetype-dir --with-png-dir --with-jpeg-dir --enable-xml --enable-bcmath --enable-shmop --enable-sysvsem --enable-inline-optimization --enable-mbregex --enable-fpm --enable-mbstring --enable-ftp --enable-gd-native-ttf --with-openssl --enable-pcntl --enable-sockets --with-xmlrpc --enable-zip --enable-soap --without-pear --with-gettext --enable-session --with-mcrypt --with-curl</span><br><span class="line">[root@mysqla php-5.6.27]# make&amp;&amp; make install</span><br><span class="line">[root@mysqla php-5.6.27]# cp php.ini-production /etc/php.ini</span><br></pre></td></tr></table></figure><p><strong>编辑配置文件/etc/php.ini ，修改后的内容如下：</strong></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">找到：</span><br><span class="line">;date.timezone = </span><br><span class="line">修改为：</span><br><span class="line">date.timezone = PRC #设置时区</span><br></pre></td></tr></table></figure><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">找到：</span><br><span class="line">expose_php = On </span><br><span class="line">修改为：</span><br><span class="line">expose_php = Off #禁止显示php版本的信息</span><br></pre></td></tr></table></figure><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">找到：</span><br><span class="line">short_open_tag = Off </span><br><span class="line">修改为：</span><br><span class="line">short_open_tag = On //支持php短标签</span><br></pre></td></tr></table></figure><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">找到：</span><br><span class="line">post_max_size = 8M</span><br><span class="line">修改为：</span><br><span class="line">post_max_size = 16M  //上传文件大小</span><br></pre></td></tr></table></figure><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">找到：</span><br><span class="line">max_execution_time = 30</span><br><span class="line">修改为：</span><br><span class="line">max_execution_time = 300  //php脚本最大执行时间</span><br></pre></td></tr></table></figure><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">找到：</span><br><span class="line">max_input_time = 60</span><br><span class="line">修改为：</span><br><span class="line">max_input_time = 300  //以秒为单位对通过POST、GET以及PUT方式接收数据时间进行限制</span><br><span class="line">always_populate_raw_post_data = -1</span><br><span class="line">mbstring.func_overload = 0</span><br></pre></td></tr></table></figure><p><strong>创建php-fpm服务启动脚本：</strong></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">[root@mysqla php-5.6.27]# cp sapi/fpm/init.d.php-fpm /etc/init.d/php-fpm</span><br><span class="line">[root@mysqla php-5.6.27]# chmod +x /etc/init.d/php-fpm </span><br><span class="line">[root@mysqla php-5.6.27]# chkconfig --add php-fpm</span><br><span class="line">[root@mysqla php-5.6.27]# chkconfig php-fpm on</span><br></pre></td></tr></table></figure><p><strong>提供php-fpm配置文件并编辑：</strong></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">[root@mysqla php-5.6.27]# cp /usr/local/php5.6/etc/php-fpm.conf.default /usr/local/php5.6/etc/php-fpm.conf</span><br><span class="line">[root@mysqla php-5.6.27]# vi /usr/local/php5.6/etc/php-fpm.conf</span><br></pre></td></tr></table></figure><p><strong>修改内容如下：</strong></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">pid = run/php-fpm.pid</span><br><span class="line">user = www</span><br><span class="line">group = www</span><br><span class="line">listen =127.0.0.1:9000</span><br><span class="line">pm.max_children = 300</span><br><span class="line">pm.start_servers = 10</span><br><span class="line">pm.min_spare_servers = 10</span><br><span class="line">pm.max_spare_servers =50</span><br></pre></td></tr></table></figure><p><strong>启动php-fpm服务：</strong></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">[root@phpserver ~]# service  php-fpm start</span><br><span class="line">Starting php-fpm  done</span><br><span class="line">[root@mysqla php-5.6.27]# netstat -anpt | grep php-fpm</span><br><span class="line">tcp   0   0 127.0.0.1:9000    0.0.0.0:*     LISTEN      10937/php-fpm: mast</span><br></pre></td></tr></table></figure><p><strong>配置nginx支持php</strong></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br></pre></td><td class="code"><pre><span class="line">[root@mysqla ~]# cat /usr/local/nginx1.10/conf/nginx.conf</span><br><span class="line">user  www www;</span><br><span class="line">worker_processes  4;</span><br><span class="line">#error_log  logs/error.log;</span><br><span class="line">#error_log  logs/error.log  notice;</span><br><span class="line">#error_log  logs/error.log  info;</span><br><span class="line">#pid        logs/nginx.pid;</span><br><span class="line">events &#123;</span><br><span class="line">use epoll;</span><br><span class="line">    worker_connections  1024;</span><br><span class="line">&#125;</span><br><span class="line">http &#123;</span><br><span class="line">include       mime.types;</span><br><span class="line">    default_type  application/octet-stream;</span><br><span class="line">    #log_format  main  &apos;$remote_addr - $remote_user [$time_local] &quot;$request&quot; &apos;</span><br><span class="line">    #                  &apos;$status $body_bytes_sent &quot;$http_referer&quot; &apos;</span><br><span class="line">    #                  &apos;&quot;$http_user_agent&quot; &quot;$http_x_forwarded_for&quot;&apos;;</span><br><span class="line"></span><br><span class="line">    #access_log  logs/access.log  main;</span><br><span class="line">sendfile        on;</span><br><span class="line">    #tcp_nopush     on;</span><br><span class="line">    #keepalive_timeout  0;</span><br><span class="line">    keepalive_timeout  65;</span><br><span class="line">    #gzip  on;</span><br><span class="line">server &#123;</span><br><span class="line">listen       80;</span><br><span class="line">        server_name  localhost;</span><br><span class="line">charset utf-8;</span><br><span class="line">        #access_log  logs/host.access.log  main;</span><br><span class="line">location / &#123;</span><br><span class="line">root   html;</span><br><span class="line">index  index.php index.html index.htm;</span><br><span class="line">        &#125;</span><br><span class="line">location ~ \.php$ &#123; </span><br><span class="line">root html; </span><br><span class="line">            fastcgi_pass 127.0.0.1:9000; </span><br><span class="line">            fastcgi_index index.php; </span><br><span class="line">include fastcgi.conf; </span><br><span class="line">        &#125;</span><br><span class="line">        #error_page  404              /404.html;</span><br><span class="line">        # redirect server error pages to the static page /50x.html</span><br><span class="line">        #</span><br><span class="line">        error_page   500 502 503 504  /50x.html;</span><br><span class="line">location = /50x.html &#123;</span><br><span class="line">root   html;</span><br><span class="line">        &#125;</span><br><span class="line">location /status &#123;</span><br><span class="line">stub_status on;</span><br><span class="line">        &#125;</span><br><span class="line">   &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><strong>重启nginx服务</strong></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">[root@mysqla conf]# nginx -t</span><br><span class="line">nginx: the configuration file /usr/local/nginx1.10/conf/nginx.conf syntax is ok</span><br><span class="line">nginx: configuration file /usr/local/nginx1.10/conf/nginx.conf test is successful</span><br><span class="line">[root@mysqla conf]# killall -s HUP nginx</span><br></pre></td></tr></table></figure><h3 id="2-5-测试LNMP"><a href="#2-5-测试LNMP" class="headerlink" title="2.5 测试LNMP"></a>2.5 测试LNMP</h3><p><strong>进入nginx默认的网页根目录，创建.php的测试页</strong></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">[root@mysqla ~]# cat /usr/local/nginx1.10/html/test1.php </span><br><span class="line">&lt;?php</span><br><span class="line">phpinfo()</span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">[root@mysqla ~]# cat /usr/local/nginx1.10/html/test2.php </span><br><span class="line">&lt;?php</span><br><span class="line">$link=mysql_connect(&apos;localhost&apos;,&apos;root&apos;,&apos;123.abc&apos;);</span><br><span class="line">if($link) echo &quot;ok&quot;;</span><br><span class="line">mysql_close();</span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure><p><strong>访问结果：</strong></p><p><img src="/2016/06/21/zabbix-jian-kong-xi-tong/%E5%9B%BE%E7%89%8724.png" alt="img"></p><p><img src="/2016/06/21/zabbix-jian-kong-xi-tong/%E5%9B%BE%E7%89%8725.png" alt="img"></p><p>至此，LNMP部署完毕。</p><h2 id="3、监控系统Zabbix-3-2-1的安装"><a href="#3、监控系统Zabbix-3-2-1的安装" class="headerlink" title="3、监控系统Zabbix-3.2.1的安装"></a>3、监控系统Zabbix-3.2.1的安装</h2><p>zabbix-server端的操作<br>zabbix服务器端要提前安装好LNMP环境（mysql，nginx，php5的安装目录均是/usr/local）<br><strong>创建Zabbix运行的用户:</strong></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">[root@mysqla ~]#groupadd zabbix</span><br><span class="line">[root@mysqla ~]#useradd -g zabbix zabbix</span><br></pre></td></tr></table></figure><p><strong>安装libcurl和net-snmp:</strong></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[root@mysqla ~]#yum -y install net-snmp net-snmp-devel curl-devel java-1.8.0-openjdk java-1.8.0-openjdk-devel OpenIPMI-devel libssh2-devel</span><br></pre></td></tr></table></figure><p>注：OpenIPMI-devel 和libssh2-devel软件包使用centos在线yum软件源安装<br><strong>安装Fping:</strong></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">[root@mysqla ~]# tar zxf fping-3.12.tar.gz </span><br><span class="line">[root@mysqla ~]# cd fping-3.12/</span><br><span class="line">[root@mysqla fping-3.12]# ./configure &amp;&amp; make &amp;&amp; make install</span><br><span class="line">[root@mysqla fping-3.12]# chown root:zabbix /usr/local/sbin/fping </span><br><span class="line">[root@mysqla fping-3.12]# chmod 4710 /usr/local/sbin/fping</span><br></pre></td></tr></table></figure><p><strong>安装Zabbix Server:</strong></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">[root@mysqla ~]# tar zxf zabbix-3.2.1.tar.gz </span><br><span class="line">[root@mysqla ~]# cd zabbix-3.2.1/</span><br><span class="line">[root@mysqla zabbix-3.2.1]# ./configure --prefix=/usr/local/zabbix --enable-server --enable-agent --enable-java --with-mysql=/usr/local/mysql/bin/mysql_config --with-net-snmp --with-libcurl --with-openipmi</span><br><span class="line"></span><br><span class="line">[root@mysqla zabbix-3.2.1]# make &amp;&amp; make install</span><br></pre></td></tr></table></figure><p>注意：编译时最好带上–enable-java这个参数，方便后续监控tomcat程序所用。<br>–with-ssh2 是不需要在客户端服务器上面安装Zabbix agent，如果需要使用ssh检查，需要在编译的时候加上这项，最低需要libssh2 1.0.0版本，需要安装ssh开发包<br>–with-openipmi用户可以利用 IPMI 监视服务器的物理特征，如温度、电压、电扇工作状态、电源供应等。<br>如果添加了–enable-proxy, 那么会生成get和sender两条命令. 如下, 用于接收agent发生过来的信息, 同时发送给server.</p><p>添加系统软连接</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">[root@mysqla ~]# ln -s /usr/local/zabbix/bin/* /usr/local/bin/</span><br><span class="line">[root@mysqla ~]# ln -s /usr/local/zabbix/sbin/* /usr/local/sbin/</span><br></pre></td></tr></table></figure><p>Zabbix Server配置与启动</p><p><strong>创建Zabbix数据库和MySQL用户:</strong></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; create database zabbix character set utf8;</span><br><span class="line">Query OK, 1 row affected (0.01 sec)</span><br><span class="line"></span><br><span class="line">mysql&gt; grant all privileges on zabbix.* to zabbix@localhost identified by &apos;zabbix&apos;;</span><br><span class="line">Query OK, 0 rows affected, 1 warning (0.00 sec)</span><br></pre></td></tr></table></figure><p><strong>导入Zabbix初始数据:</strong><br>切换到zabbix的解压目录下</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">[root@mysqla zabbix-3.2.1]# cd database/mysql/</span><br><span class="line">[root@mysqla mysql]# pwd</span><br><span class="line">/root/zabbix-3.2.1/database/mysql</span><br><span class="line">[root@mysqla mysql]# ls</span><br><span class="line">data.sql  images.sql  schema.sql</span><br></pre></td></tr></table></figure><p>进行zabbix初始数据导入</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">[root@mysqla mysql]# mysql -uzabbix -pzabbix -hlocalhost zabbix &lt; schema.sql </span><br><span class="line">[root@mysqla mysql]# mysql -uzabbix -pzabbix -hlocalhost zabbix &lt; images.sql </span><br><span class="line">[root@mysqla mysql]# mysql -uzabbix -pzabbix -hlocalhost zabbix &lt; data.sql</span><br></pre></td></tr></table></figure><p>编辑/usr/local/zabbix/etc/zabbix_server.conf:</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">[root@mysqla ~]# grep -v &quot;^#&quot; /usr/local/zabbix/etc/zabbix_server.conf | grep -v &quot;^$&quot;</span><br><span class="line">LogFile=/usr/local/zabbix/logs/zabbix_server.log</span><br><span class="line">PidFile=/usr/local/zabbix/logs/zabbix_server.pid</span><br><span class="line">DBHost=localhost</span><br><span class="line">DBName=zabbix</span><br><span class="line">DBUser=zabbix</span><br><span class="line">DBPassword=zabbix</span><br><span class="line">DBPort=3306</span><br><span class="line">FpingLocation=/usr/local/sbin/fping</span><br><span class="line"></span><br><span class="line">[root@mysqla ~]# mkdir -p /usr/local/zabbix/logs</span><br><span class="line">[root@mysqla ~]# chown -R zabbix:zabbix /usr/local/zabbix</span><br></pre></td></tr></table></figure><p><strong>启动Zabbix Server:</strong></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"># /usr/local/zabbix/sbin/zabbix_server -c /usr/local/zabbix/etc/zabbix_server.conf</span><br><span class="line">/usr/local/zabbix/sbin/zabbix_server: error while loading shared libraries: libmysqlclient.so.20: cannot open shared object file: No such file or directory</span><br></pre></td></tr></table></figure><p>解决方法：<br>在ld.so.conf中加入/usr/local/mysql/lib</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">[root@mysqla zabbix-3.2.1]# cat /etc/ld.so.conf</span><br><span class="line">include ld.so.conf.d/*.conf</span><br><span class="line">/usr/local/mysql/lib</span><br><span class="line">/usr/local/lib</span><br><span class="line">[root@mysqla zabbix-3.2.1]# ldconfig</span><br></pre></td></tr></table></figure><p><strong>再次执行zabbix_server启动</strong></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">root@mysqla zabbix-3.2.1]# /usr/local/zabbix/sbin/zabbix_server -c /usr/local/zabbix/etc/zabbix_server.conf</span><br><span class="line">[root@mysqla init.d]# netstat -anpt |grep zabbix_server</span><br><span class="line">tcp    0  0 0.0.0.0:10051    0.0.0.0:*      LISTEN      27199/zabbix_server</span><br></pre></td></tr></table></figure><p><strong>添加开机启动脚本</strong></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">[root@mysqla ~]# cd zabbix-3.2.1/</span><br><span class="line"># cp misc/init.d/fedora/core/zabbix_server /etc/rc.d/init.d/zabbix_server</span><br><span class="line"># cp misc/init.d/fedora/core/zabbix_agentd /etc/rc.d/init.d/zabbix_agentd</span><br><span class="line">[root@mysqla zabbix-3.2.1]# chmod +x /etc/rc.d/init.d/zabbix_server </span><br><span class="line">[root@mysqla zabbix-3.2.1]# chmod +x /etc/rc.d/init.d/zabbix_agentd </span><br><span class="line">[root@mysqla zabbix-3.2.1]# chkconfig --add zabbix_server</span><br><span class="line">[root@mysqla zabbix-3.2.1]# chkconfig --add zabbix_agentd</span><br><span class="line">[root@mysqla zabbix-3.2.1]# chkconfig zabbix_server on</span><br><span class="line">[root@mysqla zabbix-3.2.1]# chkconfig zabbix_agentd on</span><br></pre></td></tr></table></figure><p><strong>修改zabbix开机启动脚本中的zabbix安装目录</strong></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">vi /etc/rc.d/init.d/zabbix_server #编辑服务端配置文件</span><br><span class="line">BASEDIR=/usr/local/zabbix/ #zabbix安装目录</span><br><span class="line">PIDFILE=/usr/local/zabbix/logs/$BINARY_NAME.pid    #pid文件路径</span><br><span class="line">:wq! #保存退出</span><br><span class="line">vi /etc/rc.d/init.d/zabbix_agentd #编辑客户端配置文件</span><br><span class="line">BASEDIR=/usr/local/zabbix/ #zabbix安装目录</span><br><span class="line">PIDFILE=/usr/local/zabbix/logs/$BINARY_NAME.pid  #pid文件路径</span><br><span class="line">:wq! #保存退出</span><br><span class="line">[root@mysqla zabbix-3.2.1]# systemctl daemon-reload</span><br><span class="line">[root@mysqla zabbix-3.2.1]# /etc/init.d/zabbix_server stop</span><br><span class="line">Stopping zabbix_server (via systemctl):                    [  OK  ]</span><br><span class="line">[root@mysqla zabbix-3.2.1]# netstat -anpt | grep zabbix</span><br><span class="line">[root@mysqla zabbix-3.2.1]# /etc/init.d/zabbix_server start</span><br><span class="line">Starting zabbix_server (via systemctl):                    [  OK  ]</span><br><span class="line">[root@mysqla zabbix-3.2.1]# netstat -anpt | grep zabbix</span><br><span class="line">tcp  0    0 0.0.0.0:10051   0.0.0.0:*  LISTEN      28106/zabbix_server</span><br></pre></td></tr></table></figure><p><strong>设置防火墙规则</strong></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">[root@mysqla zabbix-3.2.1]# firewall-cmd --permanent --add-port=10051/tcp </span><br><span class="line">success</span><br><span class="line">[root@mysqla zabbix-3.2.1]# firewall-cmd --reload </span><br><span class="line">success</span><br></pre></td></tr></table></figure><p><strong>配置zabbix web页面</strong><br>在安装目录将frontends拷贝到指定的web root:</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">[root@mysqla ~]# cd /root/zabbix-3.2.1/</span><br><span class="line">[root@mysqla zabbix-3.2.1]# cp -r frontends/php/ /usr/local/nginx1.10/html/zabbix</span><br><span class="line">[root@mysqla zabbix-3.2.1]# chown  -R  www:www  /usr/local/nginx1.10/html/zabbix/</span><br></pre></td></tr></table></figure><p>注：/usr/local/nginx/html为Nginx默认站点目录 www为Nginx运行账户<br>注:PHP需要至少开启扩展:<br>gd,bcmath,ctype,libXML,xmlreader,xmlwriter,session,sockets,mbstring,gettext,mysql</p><p><strong>如下，查看是否包括了上面所提到的扩展模块</strong></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br></pre></td><td class="code"><pre><span class="line">[root@mysqla ~]# /usr/local/php5.6/bin/php -m</span><br><span class="line">[PHP Modules]</span><br><span class="line">bcmath</span><br><span class="line">bz2</span><br><span class="line">Core</span><br><span class="line">ctype</span><br><span class="line">curl</span><br><span class="line">date</span><br><span class="line">dom</span><br><span class="line">ereg</span><br><span class="line">fileinfo</span><br><span class="line">filter</span><br><span class="line">ftp</span><br><span class="line">gd</span><br><span class="line">gettext</span><br><span class="line">hash</span><br><span class="line">iconv</span><br><span class="line">json</span><br><span class="line">libxml</span><br><span class="line">mbstring</span><br><span class="line">mcrypt</span><br><span class="line">mhash</span><br><span class="line">mysql</span><br><span class="line">mysqli</span><br><span class="line">openssl</span><br><span class="line">pcntl</span><br><span class="line">pcre</span><br><span class="line">PDO</span><br><span class="line">pdo_sqlite</span><br><span class="line">Phar</span><br><span class="line">posix</span><br><span class="line">Reflection</span><br><span class="line">session</span><br><span class="line">shmop</span><br><span class="line">SimpleXML</span><br><span class="line">soap</span><br><span class="line">sockets</span><br><span class="line">SPL</span><br><span class="line">sqlite3</span><br><span class="line">standard</span><br><span class="line">sysvsem</span><br><span class="line">tokenizer</span><br><span class="line">xml</span><br><span class="line">xmlreader</span><br><span class="line">xmlrpc</span><br><span class="line">xmlwriter</span><br><span class="line">zip</span><br><span class="line">zlib</span><br></pre></td></tr></table></figure><p><strong>安装web</strong></p><p>访问Web界面 <a href="http://192.168.31.225/zabbix" target="_blank" rel="noopener">http://192.168.31.225/zabbix</a> ,进行相关web配置,配置完成后使用默认用户admin(密码:zabbix)登陆即可</p><p>进入ZABBIX WEB安装画面</p><p><img src="/2016/06/21/zabbix-jian-kong-xi-tong/%E5%9B%BE%E7%89%8726.png" alt="img"></p><p>进入ZABBIX检测画面</p><p><img src="/2016/06/21/zabbix-jian-kong-xi-tong/%E5%9B%BE%E7%89%8727.png" alt="img"></p><p>对数据库进行设置，这里如果数据库在本地的话端口可以使用0</p><p><img src="/2016/06/21/zabbix-jian-kong-xi-tong/%E5%9B%BE%E7%89%8728.png" alt="img"></p><p>点击Next step 一下步进行zabbix server 细节的设置 这一步可以默认</p><p><img src="/2016/06/21/zabbix-jian-kong-xi-tong/%E5%9B%BE%E7%89%8729.png" alt="img"></p><p>点击安装，安装完成后 如果没有错误就会进入完成画面</p><p>完成画面有设置文件放在服务器的位置，请记下来</p><p><img src="/2016/06/21/zabbix-jian-kong-xi-tong/%E5%9B%BE%E7%89%8730.png" alt="img"></p><p><img src="/2016/06/21/zabbix-jian-kong-xi-tong/%E5%9B%BE%E7%89%8731.png" alt="img"></p><p>点击Finish 完成</p><p>使用Admin 用默认密码 zabbix 登录</p><p><img src="/2016/06/21/zabbix-jian-kong-xi-tong/%E5%9B%BE%E7%89%8732.png" alt="img"></p><p>登录后画面如下</p><p><img src="/2016/06/21/zabbix-jian-kong-xi-tong/%E5%9B%BE%E7%89%8733.png" alt="img"></p><p>至此 ZABBIX的基础安装完成</p><p>注：</p><ol><li>显示简体中文界面<br>在安装数据库时已经将zabbix库设置了utf-8字符<br>首先确定zabbix开启了中文支持功能：<br>登录到zabbix服务器的数据目录下（前面部署的zabbix数据目录是/usr/local/nginx1.10/html/zabbix/），打开 locales.inc.php文件</li></ol><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">[root@mysqla include]# pwd</span><br><span class="line">/usr/local/nginx1.10/html/zabbix/include</span><br><span class="line">[root@mysqla include]# vi locales.inc.php</span><br></pre></td></tr></table></figure><blockquote><p>function getLocales() {<br>return [<br>‘en_GB’ =&gt; [‘name’ =&gt;<em>(‘English (en_GB)’), ‘display’ =&gt; true],<br>‘en_US’ =&gt; [‘name’ =&gt;</em>(‘English (en_US)’), ‘display’ =&gt; true],<br>‘bg_BG’ =&gt; [‘name’ =&gt;<em>(‘Bulgarian (bg_BG)’), ‘display’ =&gt; false],<br><font color="red">‘zh_CN’ =&gt; [‘name’ =&gt;</font></em>(‘Chinese (zh_CN)’), ‘display’ =&gt; true],<br>‘zh_TW’ =&gt; [‘name’ =&gt;<em>(‘Chinese (zh_TW)’), ‘display’ =&gt; false],<br>‘cs_CZ’ =&gt; [‘name’ =&gt;</em>(‘Czech (cs_CZ)’), ‘display’ =&gt; true],<br>‘nl_NL’ =&gt; [‘name’ =&gt;_(‘Dutch (nl_NL)’), ‘display’ =&gt; false],</p></blockquote><p>登陆zabbix后，点击右上角的“用户”图标，将语言设置为“中文”：<img src="/2016/06/21/zabbix-jian-kong-xi-tong/%E5%9B%BE%E7%89%8734.png" alt="img"></p><p>按照如图选择Chinese(zh_CN)，点击update：</p><p><img src="/2016/06/21/zabbix-jian-kong-xi-tong/%E5%9B%BE%E7%89%8735.png" alt="img"></p><p>解决zabbix绘图中出现中文乱码问题：</p><p>a.从windows下控制面板-&gt;字体-&gt;选择一种中文字库例如“楷体”</p><p><img src="/2016/06/21/zabbix-jian-kong-xi-tong/%E5%9B%BE%E7%89%8736.png" alt="img"></p><p>b.把它拷贝到zabbix的web端的fonts目录下例如：/usr/local/nginx1.10/html/zabbix/fonts/，并且把TTF后缀改为ttf</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">[root@mysqla fonts]# pwd</span><br><span class="line">/usr/local/nginx1.10/html/zabbix/fonts</span><br><span class="line">[root@mysqla fonts]# ls</span><br><span class="line">DejaVuSans.ttf  simkai.ttf</span><br></pre></td></tr></table></figure><p>并且将之前的字体文件DejaVuSans.ttf移动到别处</p><p>c.然后，接着修改代码include/defines.inc.php文件中的字体配置，将里面关于字体设置从DejaVuSans替换成simkai</p><p>vi替换技巧：%s/DejaVuSans/simkai<br>其中：simkai为字库名字,不包含ttf后缀</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"># cd/usr/local/nginx1.10/html/zabbix</span><br><span class="line"># vi include/defines.inc.php</span><br></pre></td></tr></table></figure><p>在vi编辑器的末行模式下输入%s/DejaVuSans/simkai</p><p>这样，修改后，zabbix监控图形中的中文字就不会出现乱码了</p><h2 id="4-、zabbix客户端的安装"><a href="#4-、zabbix客户端的安装" class="headerlink" title="4 、zabbix客户端的安装"></a>4 、zabbix客户端的安装</h2><p>既然要监控我们就要添加要监控的主机，在添加主机之前我们首先要在被检测主机上面安装agent，安装agent比较简单，我们也是按照安装server的流程，下载软件包，在编译的时候，我们只选择agent<br>192.168.31.250作为zabbix的被监控端，提供web和mysql应用</p><h3 id="4-1-安装Zabbix，配置Zabbix-agent"><a href="#4-1-安装Zabbix，配置Zabbix-agent" class="headerlink" title="4.1 安装Zabbix，配置Zabbix agent:"></a>4.1 安装Zabbix，配置Zabbix agent:</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">[root@server1 ~]# tar zxf zabbix-3.2.1.tar.gz </span><br><span class="line">[root@server1 ~]# cd zabbix-3.2.1/</span><br><span class="line">[root@server1 zabbix-3.2.1]# ./configure --prefix=/usr/local/zabbix --enable-agent</span><br><span class="line">[root@server1 zabbix-3.2.1]# make&amp;&amp; make install</span><br><span class="line">[root@server1 zabbix-3.2.1]# cp misc/init.d/fedora/core/zabbix_agentd /etc/init.d/</span><br><span class="line">[root@server1 zabbix-3.2.1]# mkdir -p /usr/local/zabbix/logs</span><br><span class="line">[root@server1 zabbix-3.2.1]# groupadd zabbix</span><br><span class="line">[root@server1 zabbix-3.2.1]# useradd -g zabbix zabbix</span><br><span class="line">[root@server1 zabbix-3.2.1]# chown -R zabbix:zabbix /usr/local/zabbix/</span><br></pre></td></tr></table></figure><p><strong>配置开机自动启动:</strong></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">[root@server1 ~]# chkconfig --add zabbix_agentd</span><br><span class="line">[root@server1 ~]# chkconfig zabbix_agentd  on</span><br></pre></td></tr></table></figure><p><strong>修改zabbix开机启动脚本中的zabbix安装目录</strong></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">vi /etc/rc.d/init.d/zabbix_agentd #编辑客户端配置文件</span><br><span class="line">BASEDIR=/usr/local/zabbix/ #zabbix安装目录</span><br><span class="line">PIDFILE=/usr/local/zabbix/logs/$BINARY_NAME.pid  #pid文件路径</span><br><span class="line"></span><br><span class="line">:wq! #保存退出</span><br><span class="line">[root@server1 zabbix-3.2.1]# systemctl daemon-reload</span><br><span class="line"></span><br><span class="line">编辑zabbix_agentd.conf</span><br><span class="line">[root@server1 zabbix-3.2.1]# vi /usr/local/zabbix/etc/zabbix_agentd.conf</span><br></pre></td></tr></table></figure><p>内容如下：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">[root@server1 zabbix-3.2.1]# grep -v &quot;^#&quot; /usr/local/zabbix/etc/zabbix_agentd.conf | grep -v &quot;^$&quot;</span><br><span class="line">PidFile=/usr/local/zabbix/logs/zabbix_agentd.pid</span><br><span class="line">LogFile=/usr/local/zabbix/logs/zabbix_agentd.log</span><br><span class="line">Server=192.168.31.225</span><br><span class="line">ListenPort=10050</span><br><span class="line">ServerActive=192.168.31.225</span><br><span class="line">Hostname=192.168.31.250</span><br><span class="line">Timeout=15</span><br><span class="line">Include=/usr/local/zabbix/etc/zabbix_agentd.conf.d/</span><br></pre></td></tr></table></figure><p>注：<br>其中Server和ServerActive都指定zabbixserver的IP地址，不同的是，前者是被动后者是主动。也就是说Server这个配置是用来允许192.168.31.225这个ip来我这取数据。而serverActive的192.168.31.225的意思是，客户端主动提交数据给他。<br>Hostname=XXX,这个定义的名字必须和web页面里面host的名字一样。<br><strong>启动zabbix_agentd:</strong></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">[root@server1 ~]# /etc/init.d/zabbix_agentd start</span><br><span class="line">Starting zabbix_agentd (via systemctl):                    [  OK  ]</span><br><span class="line">[root@server1 ~]# netstat -anpt | grep zabbix_agentd</span><br><span class="line">tcp        0      0 0.0.0.0:10050           0.0.0.0:*               LISTEN      12926/zabbix_agentd </span><br><span class="line">[root@server1 ~]# firewall-cmd --permanent --add-port=10050/tcp</span><br><span class="line">success</span><br><span class="line">[root@server1 ~]# firewall-cmd --reload </span><br><span class="line">success</span><br></pre></td></tr></table></figure><p>到此，zabbix3.2.1监控系统的基本环境安装完成。<br>实现zabbix添加监测项<br>添加对Linux主机的监控<br>在浏览器中打开：<a href="http://192.168.31.225/zabbix" target="_blank" rel="noopener">http://192.168.31.225/zabbix</a><br>登录zabbix，先在“配置”-“主机”里添加主机监控，监控os资源：内存，cpu，io，负载，带宽等.</p><p><strong>登录zabbix，先在“配置”-“主机”里单击”创建主机”</strong></p><p><img src="/2016/06/21/zabbix-jian-kong-xi-tong/%E5%9B%BE%E7%89%8737.png" alt="img"></p><p>点击”主机”标签，填写相关信息</p><p><img src="/2016/06/21/zabbix-jian-kong-xi-tong/%E5%9B%BE%E7%89%8738.png" alt="img"></p><p><img src="/2016/06/21/zabbix-jian-kong-xi-tong/%E5%9B%BE%E7%89%8739.png" alt="img"></p><p>注意：下图中的“主机名称”要和zabbix_agentd.conf文件中设置的“Hostname”后面的名称一致！<br>主机名称：192.168.31.250<br>群组：Linux servers<br>agent代理程序接口ip：192.168.31.250<br>已启用：勾选<br>其它选项默认即可<br>切换到模板</p><p><img src="/2016/06/21/zabbix-jian-kong-xi-tong/%E5%9B%BE%E7%89%8740.png" alt="img"></p><p>选择</p><p>选择：Template OS Linux</p><p>点添加</p><p><img src="/2016/06/21/zabbix-jian-kong-xi-tong/%E5%9B%BE%E7%89%8741.png" alt="img"></p><p>添加</p><p><img src="/2016/06/21/zabbix-jian-kong-xi-tong/%E5%9B%BE%E7%89%8742.png" alt="img"></p><p>至此，Zabbix监控Linux主机设置完成。</p><p><img src="/2016/06/21/zabbix-jian-kong-xi-tong/%E5%9B%BE%E7%89%8743.png" alt="img"></p><p>配置过一段时间后，观察下监控图效果出来了没：</p><p><img src="/2016/06/21/zabbix-jian-kong-xi-tong/%E5%9B%BE%E7%89%8744.png" alt="img"></p><p>zabbix3.0 server已自带mysql的模板了，只需配置好agent客户端，然后在web端给主机增加模板就行了。</p><h3 id="4-2-Zabbix-agent客户端操作"><a href="#4-2-Zabbix-agent客户端操作" class="headerlink" title="4.2 Zabbix_agent客户端操作"></a>4.2 Zabbix_agent客户端操作</h3><p>（1）首先在客户端的mysql里添加权限，即本机使用zabbix账号连接本地的mysql</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; grant all on *.* to zabbix@&apos;%&apos; identified by &quot;123456&quot;;</span><br><span class="line">mysql&gt; flush privileges;</span><br></pre></td></tr></table></figure><p>（2）在zabbix_agent服务目录下创建 .my.cnf 连接文件</p><p>zabbix安装目录是/usr/local/zabbix</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">[root@server1 ~]# cd /usr/local/zabbix/etc/</span><br><span class="line">[root@server1 ~]# cat .my.cnf </span><br><span class="line">[client]</span><br><span class="line">user=zabbix</span><br><span class="line">password=123456</span><br></pre></td></tr></table></figure><p>注意：<br>如果在数据库grant授权时，针对的是localhost，这个.my.cnf里面就不用加host参数了【如上配置】<br>但如果grant授权时针对的是本机的ip（如192.168.31.250），那么在.my.cnf文件里就要加上host参数进行指定了<br>即在.my.cnf文件就要加上：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">host=192.168.31.250</span><br><span class="line">socket= /usr/local/mysql/mysql.sock</span><br><span class="line">user=zabbix</span><br><span class="line">password=123456</span><br></pre></td></tr></table></figure><p>(3)配置MySQL的key文件</p><p>这个可以从zabbix3.2安装时的解压包里拷贝过来</p><p>从zabbix_server服务端安装时解压目录</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">/root/zabbix-3.2.1/conf/zabbix_agentd/userparameter_mysql.conf  拷贝到zabbix_agent客户端上的/usr/local/zabbix/etc/zabbix_agentd.conf.d/ 目录下的</span><br><span class="line"></span><br><span class="line">[root@server1 ~]# cd /usr/local/zabbix/etc/zabbix_agentd.conf.d/</span><br><span class="line">[root@server1 zabbix_agentd.conf.d]# pwd</span><br><span class="line">/usr/local/zabbix/etc/zabbix_agentd.conf.d</span><br><span class="line"># cp /root/zabbix-3.2.1/conf/zabbix_agentd/userparameter_mysql.conf ./</span><br><span class="line">[root@server1 zabbix_agentd.conf.d]# ls userparameter_mysql.conf </span><br><span class="line">userparameter_mysql.conf</span><br></pre></td></tr></table></figure><p>然后查看 userparameter_mysql.conf 文件，看到类似 HOME=/var/lib/zabbix 的路径设置，把路径全都替换为 /usr/local/zabbix/etc/，也就是上面的.my.cnf文件所在的目录路径。<br>另外，注意userparameter_mysql.conf 文件里的mysql命令路径（提前做好mysql的系统环境变量，以防mysql命令不被系统识别）</p><p>如下：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">[root@server1 zabbix_agentd.conf.d]# cat userparameter_mysql.conf </span><br><span class="line"># For all the following commands HOME should be set to the directory that has .my.cnf file with password information.</span><br><span class="line"></span><br><span class="line"># Flexible parameter to grab global variables. On the frontend side, use keys like mysql.status[Com_insert].</span><br><span class="line"># Key syntax is mysql.status[variable].</span><br><span class="line">UserParameter=mysql.status[*],echo &quot;show global status where Variable_name=&apos;$1&apos;;&quot; | HOME=/usr/local/zabbix/etc/ mysql -N | awk &apos;&#123;print $$2&#125;&apos;</span><br><span class="line"></span><br><span class="line"># Flexible parameter to determine database or table size. On the frontend side, use keys like mysql.size[zabbix,history,data].</span><br><span class="line"># Key syntax is mysql.size[&lt;database&gt;,&lt;table&gt;,&lt;type&gt;].</span><br><span class="line"># Database may be a database name or &quot;all&quot;. Default is &quot;all&quot;.</span><br><span class="line"># Table may be a table name or &quot;all&quot;. Default is &quot;all&quot;.</span><br><span class="line"># Type may be &quot;data&quot;, &quot;index&quot;, &quot;free&quot; or &quot;both&quot;. Both is a sum of data and index. Default is &quot;both&quot;.</span><br><span class="line"># Database is mandatory if a table is specified. Type may be specified always.</span><br><span class="line"># Returns value in bytes.</span><br><span class="line"># &apos;sum&apos; on data_length or index_length alone needed when we are getting this information for whole database instead of a single table</span><br><span class="line">UserParameter=mysql.size[*],bash -c &apos;echo &quot;select sum($(case &quot;$3&quot; in both|&quot;&quot;) echo &quot;data_length+index_length&quot;;; data|index) echo &quot;$3_length&quot;;; free) echo &quot;data_free&quot;;; esac)) from information_schema.tables$([[ &quot;$1&quot; = &quot;all&quot; || ! &quot;$1&quot; ]] || echo &quot; where table_schema=\&quot;$1\&quot;&quot;)$([[ &quot;$2&quot; = &quot;all&quot; || ! &quot;$2&quot; ]] || echo &quot;and table_name=\&quot;$2\&quot;&quot;);&quot; | HOME=/usr/local/zabbix/etc/ mysql -N&apos;</span><br><span class="line">UserParameter=mysql.ping,HOME=/usr/local/zabbix/etc/ mysqladmin ping | grep -c alive</span><br><span class="line">UserParameter=mysql.version,mysql -V</span><br></pre></td></tr></table></figure><p>（4）按照上面修改完之后检查一下，然后重启zabbix_agent</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">[root@server1 ~]# pkill -9 zabbix_agent</span><br><span class="line">[root@server1 ~]# netstat -anpt | grep zabbix_agent</span><br><span class="line">[root@server1 ~]# /usr/local/zabbix/sbin/zabbix_agentd </span><br><span class="line">[root@server1 ~]# netstat -anpt | grep zabbix_agent</span><br><span class="line">tcp   0      0 0.0.0.0:10050   0.0.0.0:*    LISTEN      15400/zabbix_agentd</span><br></pre></td></tr></table></figure><p>接着在zabbix_server服务端进行命令行测试［下面的192.168.31.250是客户端的ip］</p><p>若下面报错</p><blockquote><p>[root@localhost zabbix]# /usr/local/zabbix/bin/zabbix_get -s 192.168.31.250 -p 10050 -k “mysql.status[Uptime]”<br>sh: mysql: command not found</p></blockquote><p>解决方法：<br>在userparameter_mysql.conf中关于mysql命令前面添加绝对路径</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">[root@mysqla ~]#/usr/local/zabbix/bin/zabbix_get -s 192.168.31.250 -p 10050 -k &quot;mysql.status[Uptime]&quot;</span><br><span class="line">12593</span><br><span class="line">[root@mysqla ~]#</span><br></pre></td></tr></table></figure><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">如果出现类似这一串key的数字，就说明配置ok，服务端能监控到客户端的mysql数据了！</span><br><span class="line">成功啦，之后在监控界面增加主机对应的MySQL模板就ok了。</span><br><span class="line">注：zabbix_get命令介绍</span><br><span class="line">参数说明：</span><br><span class="line">-s --host：指定客户端主机名或者IP</span><br><span class="line">-p --port：客户端端口，默认10050</span><br><span class="line">-I --source-address：指定源IP，写上zabbix server的ip地址即可，一般留空，服务器如果有多ip的时候，你指定一个。</span><br><span class="line">-k --key：你想获取的key</span><br><span class="line">zabbix_get获取数据</span><br><span class="line">获取负载</span><br><span class="line"># zabbix_get -s 192.168.31.250 -p 10050 -k &quot;system.cpu.load[all,avg15]&quot;</span><br><span class="line">获取主机名</span><br><span class="line"># zabbix_get -s 192.168.31.250 -p 10050 -k &quot;system.hostname&quot;</span><br></pre></td></tr></table></figure><p>（5）登录zabbix监控界面，在“配置”-“模板”里可以看到自带的mysql监控模板</p><p><img src="/2016/06/21/zabbix-jian-kong-xi-tong/%E5%9B%BE%E7%89%8745.png" alt="img"></p><p>在相应主机监控配置里添加mysql的监控模版（zabbix自带的）即可。</p><p><img src="/2016/06/21/zabbix-jian-kong-xi-tong/%E5%9B%BE%E7%89%8746.png" alt="img"></p><p>下面是mysql监控项的效果图：</p><p>【1】监控mysql的带宽：在zabbix前端可以实时查看mysql发送接收的字节数。其中bytes received表示从所有客户端接收到的字节数，bytes sent表示发送给所有客户端的字节数。</p><p><img src="/2016/06/21/zabbix-jian-kong-xi-tong/%E5%9B%BE%E7%89%8747.png" alt="image-20191119104036453"></p><p>【2】监控mysql的操作状态：在zabbix前端可以实时查看各种SQL语句每秒钟的操作次数。</p><p><img src="/2016/06/21/zabbix-jian-kong-xi-tong/%E5%9B%BE%E7%89%8748.png" alt="img"></p><h2 id="5、zabbix3-2-1邮件报警设置"><a href="#5、zabbix3-2-1邮件报警设置" class="headerlink" title="5、zabbix3.2.1邮件报警设置"></a>5、zabbix3.2.1邮件报警设置</h2><p>Zabbix监控服务端、客户端都已经部署完成，被监控主机已经添加，Zabiix监控运行正常。</p><p>在Zabbix服务端设置邮件报警，当被监控主机宕机或者达到触发器预设值时，会自动发送报警邮件到指定邮箱。</p><p>具体操作：</p><p>以下操作在Zabbix监控服务端进行</p><h3 id="5-1-下载sendemail软件"><a href="#5-1-下载sendemail软件" class="headerlink" title="5.1 下载sendemail软件"></a>5.1 下载sendemail软件</h3><p>然后安装那两个依赖包，命令是：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">yum install perl-Net-SSLeay perl-IO-Socket-SSL -y</span><br></pre></td></tr></table></figure><p>解压软件，然后将sendemail复制到/usr/local/bin/目录下，并加上可执行权限，然后修改用户和群组。</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">[root@mysqla ~]# tar zxf sendEmail-v1.56.tar.gz </span><br><span class="line">[root@mysqla ~]# cd sendEmail-v1.56/</span><br><span class="line">[root@mysqla sendEmail-v1.56]# cp sendEmail /usr/local/bin/sendEmail</span><br><span class="line">[root@mysqla sendEmail-v1.56]# chown zabbix:zabbix /usr/local/bin/sendEmail</span><br><span class="line">[root@mysqla sendEmail-v1.56]# ll /usr/local/bin/sendEmail </span><br><span class="line">-rwxr-xr-x. 1 zabbix zabbix 80213 Nov 21 21:26 /usr/local/bin/sendEmail</span><br></pre></td></tr></table></figure><p>执行# /usr/local/bin/sendEmail -h查看sendEmail的帮助</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"># /usr/local/bin/sendEmail -f bpcyh1@126.com -t bpcyh1@126.com -s smtp.126.com -u &quot;hello&quot; -o message-content-type=html -o message-charset=utf8 -xu bpcyh1@126.com -xp 123abc -m &quot;abcfdd&quot;</span><br></pre></td></tr></table></figure><p>命令主要选项说明：</p><table><thead><tr><th>选项</th><th>描述</th></tr></thead><tbody><tr><td>/usr/local/bin/sendEmail</td><td>命令主程序</td></tr><tr><td>-f <a href="mailto:from@126.com" target="_blank" rel="noopener">from@126.com</a></td><td>发件人邮箱</td></tr><tr><td>-t <a href="mailto:to@126.com" target="_blank" rel="noopener">to@126.com</a></td><td>收件人邮箱</td></tr><tr><td>-s smtp.126.com</td><td>发件人邮箱的smtp服务器</td></tr><tr><td>-u “我是邮件主题”</td><td>邮件的标题</td></tr><tr><td>-o message-content-type=html</td><td>邮件内容的格式,html表示它是html格式</td></tr><tr><td>-o message-charset=utf8</td><td>邮件内容编码</td></tr><tr><td>-xu <a href="mailto:from@126.com" target="_blank" rel="noopener">from@126.com</a></td><td>发件人邮箱的用户名</td></tr><tr><td>-xp WEE78@12l$</td><td>发件人邮箱密码</td></tr><tr><td>-m “我是邮件内容”</td><td>邮件的具体内容</td></tr></tbody></table><p>进入/usr/local/zabbix/share/zabbix/alertscripts/目录<br>然后在这个目录下创建报警脚本sendmail.sh</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[root@mysqla alertscripts]# vi mail.sh</span><br></pre></td></tr></table></figure><p>下面是脚本内容（涂颜色部分是你的邮箱和密码，-f和-xu参数后面跟邮箱，-xp后面跟授权码）</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">#!/bin/bash</span><br><span class="line">to=$1</span><br><span class="line">subject=$2</span><br><span class="line">body=$3</span><br><span class="line">/usr/local/bin/sendEmail -o tls=auto -f bpcyh1@126.com -t &quot;$to&quot; -s smtp.126.com -u &quot;$subject&quot; -o message-content-type=html -o message-charset=utf8 -xu bpcyh1@126.com -xp 123abc -m &quot;$body&quot; </span><br><span class="line"></span><br><span class="line">[root@mysqla alertscripts]# chmod +x mail.sh</span><br></pre></td></tr></table></figure><p><strong>执行脚本测试发邮件</strong></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">[root@mysqla alertscripts]# ./mail.sh bpcyh1@126.com test 123</span><br><span class="line">*******************************************************************</span><br><span class="line"> Using the default of SSL_verify_mode of SSL_VERIFY_NONE for client</span><br><span class="line">is deprecated! Please set SSL_verify_mode to SSL_VERIFY_PEER</span><br><span class="line">together with SSL_ca_file|SSL_ca_path for verification.</span><br><span class="line"> If you really don&apos;t want to verify the certificate and keep the</span><br><span class="line">connection open to Man-In-The-Middle attacks please set</span><br><span class="line">SSL_verify_mode explicitly to SSL_VERIFY_NONE in your application.</span><br><span class="line">*******************************************************************</span><br><span class="line">at /usr/local/bin/sendEmail line 1906.</span><br><span class="line">invalid SSL_version specified at /usr/share/perl5/vendor_perl/IO/Socket/SSL.pm line 415</span><br></pre></td></tr></table></figure><p>注：进行发送邮件测试时，出现了第一个报错</p><p>原因是sendemail软件和perl5里面的ssl版本不兼容导致的，通过修改sendemail里面的内容可以解决这个问题。</p><p>解决方法：</p><p>在sendemail中1906行的内容，从</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">if (! IO::Socket::SSL-&gt;start_SSL($SERVER, SSL_version =&gt; &apos;SSLv3 TLSv1&apos;)) &#123;</span><br><span class="line">修改为</span><br><span class="line">if (! IO::Socket::SSL-&gt;start_SSL($SERVER)) &#123;</span><br></pre></td></tr></table></figure><p>即不指定SSL的版本，让程序来自己选择<br>不管你使用的是163/126邮箱还是qq邮箱，你都必须开通pop3服务，而且126/qq邮箱还要求使用第三方客户端发送邮件是必须使用授权码登录，使用账号密码验证时，会出现下面图片中的错误。</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sendEmail[5102]: ERROR =&gt; ERROR =&gt; SMTP-AUTH: Authentication to smtp.126.com:25 failed.</span><br></pre></td></tr></table></figure><p>至于邮箱的授权码，自己登录126邮箱去设置就好。<br>经过上面两个问题的处理后就可以正常发送邮件如下所示显示成功提示</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">[root@mysqla alertscripts]# ./mail.sh bpcyh1@126.com test 123</span><br><span class="line">Nov 21 22:50:47 mysqla sendEmail[5195]: Email was sent successfully!</span><br></pre></td></tr></table></figure><h3 id="5-2-zabbix-web端配置"><a href="#5-2-zabbix-web端配置" class="headerlink" title="5.2 zabbix web端配置"></a>5.2 zabbix web端配置</h3><p>上面的邮件脚本配置好后，就要在web端添加报警媒介，在web页面的管理，报警媒介类型页面，点击右边的创建媒体类型</p><p><img src="/2016/06/21/zabbix-jian-kong-xi-tong/%E5%9B%BE%E7%89%8749.png" alt="img"></p><p>进入创建页面，然后输入名称“邮件报警脚本”，类型选择脚本，名称选择mail.sh，点击添加按钮，添加三个脚本参数，分别是{ALERT.SENDTO},{ALERT.SUBJECT},{ALERT.MESAGE}，分别对于mail.sh中的to、subject和body。添加完成后点下面的添加按钮，我们的报警媒介就创建完成了</p><p><img src="/2016/06/21/zabbix-jian-kong-xi-tong/%E5%9B%BE%E7%89%8750.png" alt="img"></p><p><img src="/2016/06/21/zabbix-jian-kong-xi-tong/%E5%9B%BE%E7%89%8751.png" alt="img"></p><p>创建好报警媒介后，就需要将报警媒介关联到我们的用户。<strong>点击管理，用户，然后选择我们的用户admin也可新建一个用户</strong>，点击用户名就进入到用户配置界面。点击报警媒介，然后点添加，选择我们上一步创建的邮件报警脚本，输入收件人，选择报警时间和类型，然后点击添加，就将创建好的报警媒介关联到我们的用户上面了。</p><p><img src="/2016/06/21/zabbix-jian-kong-xi-tong/%E5%9B%BE%E7%89%8752.png" alt="img"></p><p><img src="/2016/06/21/zabbix-jian-kong-xi-tong/%E5%9B%BE%E7%89%8753.png" alt="img"></p><p>现在需要做的是，创建一个触发动作，即系统出现故障时，触发这个动作，然后给我们的邮箱发送报警邮件。<strong>点击配置，选择动作，然后点击右边的创建动作。</strong><br>在动作这一页名称中写入我们定义的动作名以及触发条件</p><p><img src="/2016/06/21/zabbix-jian-kong-xi-tong/%E5%9B%BE%E7%89%8754.png" alt="img"></p><p>设置“操作”</p><p><img src="/2016/06/21/zabbix-jian-kong-xi-tong/%E5%9B%BE%E7%89%8755.png" alt="img"></p><p><img src="/2016/06/21/zabbix-jian-kong-xi-tong/%E5%9B%BE%E7%89%8756.png" alt="img"></p><p>步骤是1-3,也即是从1开始到3结束。一旦故障发生，就是执行Email.sh脚本发生报警邮件给zabbix用户。<br>假如故障持续了1个小时，它也只发送3次，第1-3次（即前3次）邮箱发送给zabbix用户，时间间隔为0秒。<br>如果改成1-0，0是表示不限制.无限发送<br>设置“恢复操作”</p><p><img src="/2016/06/21/zabbix-jian-kong-xi-tong/%E5%9B%BE%E7%89%8757.png" alt="img"></p><p>添加好以后就可以看到我们添加的动作名，以及该动作已启用的状态。</p><p><img src="/2016/06/21/zabbix-jian-kong-xi-tong/%E5%9B%BE%E7%89%8758.png" alt="img"></p><p>报警测试</p><p>将192.16831.250服务器的zabbix_agent进程关闭。</p><p>发现可以正常收到故障报警邮件</p><p><img src="/2016/06/21/zabbix-jian-kong-xi-tong/%E5%9B%BE%E7%89%8759.png" alt="img"></p><p>最后，点击”报表“-&gt;”动作日志“,可以看到触发动作的次数（右边还看查看到邮件发送状态“已发送”）。</p><p><img src="/2016/06/21/zabbix-jian-kong-xi-tong/%E5%9B%BE%E7%89%8760.png" alt="img"></p></div><div><div><div style="text-align:center;color:#ccc;font-size:14px">-------------本文结束<i class="fa fa-paw"></i>感谢您的阅读-------------</div></div></div><div></div><footer class="post-footer"><div class="post-tags"><a href="/tags/%E7%9B%91%E6%8E%A7%E7%B3%BB%E7%BB%9F/" rel="tag"><i class="fa fa-tag"></i> 监控系统</a> <a href="/tags/Zabbix/" rel="tag"><i class="fa fa-tag"></i> Zabbix</a></div><div class="post-nav"><div class="post-nav-next post-nav-item"><a href="/2016/06/05/git-chang-yong-ming-ling/" rel="next" title="git常用命令"><i class="fa fa-chevron-left"></i> git常用命令</a></div><span class="post-nav-divider"></span><div class="post-nav-prev post-nav-item"><a href="/2016/06/25/linux-xi-tong-ji-chu-you-hua/" rel="prev" title="Linux系统基础优化">Linux系统基础优化 <i class="fa fa-chevron-right"></i></a></div></div></footer></div></article><div class="post-spread"><div class="jiathis_style"><span class="jiathis_txt">分享到：</span> <a class="jiathis_button_fav">收藏夹</a> <a class="jiathis_button_copy">复制网址</a> <a class="jiathis_button_email">邮件</a> <a class="jiathis_button_weixin">微信</a> <a class="jiathis_button_qzone">QQ空间</a> <a class="jiathis_button_tqq">腾讯微博</a> <a class="jiathis_button_douban">豆瓣</a> <a class="jiathis_button_share">一键分享</a> <a href="http://www.jiathis.com/share?uid=2140465" class="jiathis jiathis_txt jiathis_separator jtico jtico_jiathis" target="_blank">更多</a> <a class="jiathis_counter_style"></a></div><script type="text/javascript">var jiathis_config={data_track_clickback:!0,summary:"",shortUrl:!1,hideMore:!1}</script><script type="text/javascript" src="http://v3.jiathis.com/code/jia.js?uid=" charset="utf-8"></script></div></div></div></div><div class="sidebar-toggle"><div class="sidebar-toggle-line-wrap"><span class="sidebar-toggle-line sidebar-toggle-line-first"></span> <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span> <span class="sidebar-toggle-line sidebar-toggle-line-last"></span></div></div><aside id="sidebar" class="sidebar"><div id="sidebar-dimmer"></div><div class="sidebar-inner"><ul class="sidebar-nav motion-element"><li class="sidebar-nav-toc sidebar-nav-active" data-target="post-toc-wrap">文章目录</li><li class="sidebar-nav-overview" data-target="site-overview-wrap">站点概览</li></ul><section class="site-overview-wrap sidebar-panel"><div class="site-overview"><div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person"><img class="site-author-image" itemprop="image" src="/images/chen.png" alt="Zhongzhou Chen"><p class="site-author-name" itemprop="name">Zhongzhou Chen</p><p class="site-description motion-element" itemprop="description"></p></div><nav class="site-state motion-element"><div class="site-state-item site-state-posts"><a href="/archives/%7C%7C%20archive"><span class="site-state-item-count">312</span> <span class="site-state-item-name">日志</span></a></div><div class="site-state-item site-state-categories"><a href="/categories/index.html"><span class="site-state-item-count">84</span> <span class="site-state-item-name">分类</span></a></div><div class="site-state-item site-state-tags"><a href="/tags/index.html"><span class="site-state-item-count">180</span> <span class="site-state-item-name">标签</span></a></div></nav><div class="feed-link motion-element"><a href="/atom.xml" rel="alternate"><i class="fa fa-rss"></i> RSS</a></div></div></section><section class="post-toc-wrap motion-element sidebar-panel sidebar-panel-active"><div class="post-toc"><div class="post-toc-content"><ol class="nav"><li class="nav-item nav-level-2"><a class="nav-link" href="#1、Zabbix-简介"><span class="nav-text">1、Zabbix 简介</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#Zabbix的主要功能"><span class="nav-text">Zabbix的主要功能</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#zabbix重要组件说明"><span class="nav-text">zabbix重要组件说明</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#zabbix常用的监控架构平台"><span class="nav-text">zabbix常用的监控架构平台</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#zabbix的系统架构"><span class="nav-text">zabbix的系统架构</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#2、Zabbix部署前的LNMP环境部署"><span class="nav-text">2、Zabbix部署前的LNMP环境部署</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#2-1-安装编译工具及库文件"><span class="nav-text">2.1 安装编译工具及库文件</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#2-2-安装mysql5-7-13"><span class="nav-text">2.2 安装mysql5.7.13</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#2-3-安装nginx"><span class="nav-text">2.3 安装nginx</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#2-4-安装php"><span class="nav-text">2.4 安装php</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#2-5-测试LNMP"><span class="nav-text">2.5 测试LNMP</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#3、监控系统Zabbix-3-2-1的安装"><span class="nav-text">3、监控系统Zabbix-3.2.1的安装</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#4-、zabbix客户端的安装"><span class="nav-text">4 、zabbix客户端的安装</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#4-1-安装Zabbix，配置Zabbix-agent"><span class="nav-text">4.1 安装Zabbix，配置Zabbix agent:</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#4-2-Zabbix-agent客户端操作"><span class="nav-text">4.2 Zabbix_agent客户端操作</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#5、zabbix3-2-1邮件报警设置"><span class="nav-text">5、zabbix3.2.1邮件报警设置</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#5-1-下载sendemail软件"><span class="nav-text">5.1 下载sendemail软件</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#5-2-zabbix-web端配置"><span class="nav-text">5.2 zabbix web端配置</span></a></li></ol></li></ol></div></div></section><div class="back-to-top"><i class="fa fa-arrow-up"></i> <span id="scrollpercent"><span>0</span>%</span></div></div></aside></div></main><footer id="footer" class="footer"><div class="footer-inner"><script async src="https://dn-lbstatics.qbox.me/busuanzi/2.3/busuanzi.pure.mini.js"></script><div class="copyright">&copy; <span itemprop="copyrightYear">2021</span> <span class="with-love"><i class="fa fa-user"></i> </span><span class="author" itemprop="copyrightHolder">Zhongzhou Chen</span> <span class="post-meta-divider">|</span> <span class="post-meta-item-icon"><i class="fa fa-area-chart"></i> </span><span class="post-meta-item-text">Site words total count&#58;</span> <span title="Site words total count">738.6k</span></div><span class="post-meta-divider"></span></div></footer></div><script type="text/javascript">"[object Function]"!==Object.prototype.toString.call(window.Promise)&&(window.Promise=null)</script><script type="text/javascript" src="/lib/jquery/index.js?v=2.1.3"></script><script type="text/javascript" src="/lib/fastclick/lib/fastclick.min.js?v=1.0.6"></script><script type="text/javascript" src="/lib/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script><script type="text/javascript" src="/lib/velocity/velocity.min.js?v=1.2.1"></script><script type="text/javascript" src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script><script type="text/javascript" src="/lib/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script><script type="text/javascript" src="/js/src/utils.js?v=5.1.4"></script><script type="text/javascript" src="/js/src/motion.js?v=5.1.4"></script><style>.copy-btn{display:inline-block;padding:6px 12px;font-size:13px;font-weight:700;line-height:20px;color:#333;white-space:nowrap;vertical-align:middle;cursor:pointer;background-color:#eee;background-image:linear-gradient(#fcfcfc,#eee);border:1px solid #d5d5d5;border-radius:3px;user-select:none;outline:0}.highlight-wrap .copy-btn{transition:opacity .3s ease-in-out;opacity:0;padding:2px 6px;position:absolute;right:4px;top:8px}.highlight-wrap .copy-btn:focus,.highlight-wrap:hover .copy-btn{opacity:1}.highlight-wrap{position:relative}</style><script>$(".highlight").each(function(t,e){var n=$("<div>").addClass("highlight-wrap");$(e).after(n),n.append($("<button>").addClass("copy-btn").append("复制").on("click",function(t){var e=$(this).parent().find(".code").find(".line").map(function(t,e){return $(e).text()}).toArray().join("\n"),n=document.createElement("textarea");document.body.appendChild(n),n.style.position="absolute",n.style.top="0px",n.style.left="0px",n.value=e,n.select(),n.focus();var o=document.execCommand("copy");document.body.removeChild(n),o?$(this).text("复制成功"):$(this).text("复制失败"),$(this).blur()})).on("mouseleave",function(t){var e=$(this).find(".copy-btn");setTimeout(function(){e.text("复制")},300)}).append(e)})</script><script type="text/javascript" src="/js/src/affix.js?v=5.1.4"></script><script type="text/javascript" src="/js/src/schemes/pisces.js?v=5.1.4"></script><script type="text/javascript" src="/js/src/scrollspy.js?v=5.1.4"></script><script type="text/javascript" src="/js/src/post-details.js?v=5.1.4"></script><script type="text/javascript" src="/js/src/bootstrap.js?v=5.1.4"></script><script type="text/javascript">function proceedsearch(){$("body").append('<div class="search-popup-overlay local-search-pop-overlay"></div>').css("overflow","hidden"),$(".search-popup-overlay").click(onPopupClose),$(".popup").toggle();var t=$("#local-search-input");t.attr("autocapitalize","none"),t.attr("autocorrect","off"),t.focus()}var isfetched=!1,isXml=!0,search_path="search.xml";0===search_path.length?search_path="search.xml":/json$/i.test(search_path)&&(isXml=!1);var path="/"+search_path,onPopupClose=function(t){$(".popup").hide(),$("#local-search-input").val(""),$(".search-result-list").remove(),$("#no-result").remove(),$(".local-search-pop-overlay").remove(),$("body").css("overflow","")},searchFunc=function(t,e,o){"use strict";$("body").append('<div class="search-popup-overlay local-search-pop-overlay"><div id="search-loading-icon"><i class="fa fa-spinner fa-pulse fa-5x fa-fw"></i></div></div>').css("overflow","hidden"),$("#search-loading-icon").css("margin","20% auto 0 auto").css("text-align","center"),$.ajax({url:t,dataType:isXml?"xml":"json",async:!0,success:function(t){isfetched=!0,$(".popup").detach().appendTo(".header-inner");var n=isXml?$("entry",t).map(function(){return{title:$("title",this).text(),content:$("content",this).text(),url:$("url",this).text()}}).get():t,r=document.getElementById(e),s=document.getElementById(o),a=function(){var t=r.value.trim().toLowerCase(),e=t.split(/[\s\-]+/);e.length>1&&e.push(t);var o=[];if(t.length>0&&n.forEach(function(n){function r(e,o,n,r){for(var s=r[r.length-1],a=s.position,i=s.word,l=[],h=0;a+i.length<=n&&0!=r.length;){i===t&&h++,l.push({position:a,length:i.length});var p=a+i.length;for(r.pop();0!=r.length&&(s=r[r.length-1],a=s.position,i=s.word,p>a);)r.pop()}return c+=h,{hits:l,start:o,end:n,searchTextCount:h}}function s(t,e){var o="",n=e.start;return e.hits.forEach(function(e){o+=t.substring(n,e.position);var r=e.position+e.length;o+='<b class="search-keyword">'+t.substring(e.position,r)+"</b>",n=r}),o+=t.substring(n,e.end)}var a=!1,i=0,c=0,l=n.title.trim(),h=l.toLowerCase(),p=n.content.trim().replace(/<[^>]+>/g,""),u=p.toLowerCase(),f=decodeURIComponent(n.url),d=[],g=[];if(""!=l&&(e.forEach(function(t){function e(t,e,o){var n=t.length;if(0===n)return[];var r=0,s=[],a=[];for(o||(e=e.toLowerCase(),t=t.toLowerCase());(s=e.indexOf(t,r))>-1;)a.push({position:s,word:t}),r=s+n;return a}d=d.concat(e(t,h,!1)),g=g.concat(e(t,u,!1))}),(d.length>0||g.length>0)&&(a=!0,i=d.length+g.length)),a){[d,g].forEach(function(t){t.sort(function(t,e){return e.position!==t.position?e.position-t.position:t.word.length-e.word.length})});var v=[];0!=d.length&&v.push(r(l,0,l.length,d));for(var $=[];0!=g.length;){var C=g[g.length-1],m=C.position,x=C.word,w=m-20,y=m+80;0>w&&(w=0),y<m+x.length&&(y=m+x.length),y>p.length&&(y=p.length),$.push(r(p,w,y,g))}$.sort(function(t,e){return t.searchTextCount!==e.searchTextCount?e.searchTextCount-t.searchTextCount:t.hits.length!==e.hits.length?e.hits.length-t.hits.length:t.start-e.start});var T=parseInt("1");T>=0&&($=$.slice(0,T));var b="";b+=0!=v.length?"<li><a href='"+f+"' class='search-result-title'>"+s(l,v[0])+"</a>":"<li><a href='"+f+"' class='search-result-title'>"+l+"</a>",$.forEach(function(t){b+="<a href='"+f+'\'><p class="search-result">'+s(p,t)+"...</p></a>"}),b+="</li>",o.push({item:b,searchTextCount:c,hitCount:i,id:o.length})}}),1===e.length&&""===e[0])s.innerHTML='<div id="no-result"><i class="fa fa-search fa-5x" /></div>';else if(0===o.length)s.innerHTML='<div id="no-result"><i class="fa fa-frown-o fa-5x" /></div>';else{o.sort(function(t,e){return t.searchTextCount!==e.searchTextCount?e.searchTextCount-t.searchTextCount:t.hitCount!==e.hitCount?e.hitCount-t.hitCount:e.id-t.id});var a='<ul class="search-result-list">';o.forEach(function(t){a+=t.item}),a+="</ul>",s.innerHTML=a}};r.addEventListener("input",a),$(".local-search-pop-overlay").remove(),$("body").css("overflow",""),proceedsearch()}})};$(".popup-trigger").click(function(t){t.stopPropagation(),isfetched===!1?searchFunc(path,"local-search-input","local-search-result"):proceedsearch()}),$(".popup-btn-close").click(onPopupClose),$(".popup").click(function(t){t.stopPropagation()}),$(document).on("keyup",function(t){var e=27===t.which&&$(".search-popup").is(":visible");e&&onPopupClose()})</script><script type="text/javascript" src="/js/src/love.js"></script><script src="/live2dw/lib/L2Dwidget.min.js?094cbace49a39548bed64abff5988b05"></script><script>L2Dwidget.init({pluginRootPath:"live2dw/",pluginJsPath:"lib/",pluginModelPath:"assets/",tagMode:!1,log:!1,model:{jsonPath:"/live2dw/assets/shizuku.model.json"},display:{position:"right"},mobile:{show:!0,scale:.5},react:{opacityDefault:.7,opacityOnHover:.2}})</script></body></html><!-- rebuild by neat -->