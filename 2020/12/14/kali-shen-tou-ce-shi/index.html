<!-- build time:Mon Sep 13 2021 15:38:00 GMT+0800 (GMT+08:00) --><!DOCTYPE html><html class="theme-next gemini use-motion" lang="zh-Hans"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1"><script src="//cdn.bootcss.com/pace/1.0.2/pace.min.js"></script><link href="//cdn.bootcss.com/pace/1.0.2/themes/pink/pace-theme-flash.css" rel="stylesheet"><script></script><meta name="theme-color" content="#222"><style>.pace .pace-progress{background:#1E92FB;height:3px}.pace .pace-progress-inner{box-shadow:0 0 10px #1E92FB,0 0 5px #1E92FB}.pace .pace-activity{border-top-color:#1E92FB;border-left-color:#1E92FB}</style><meta http-equiv="Cache-Control" content="no-transform"><meta http-equiv="Cache-Control" content="no-siteapp"><meta name="google-site-verification" content="HGM141IpbHrSmnAmR6W_zE4bo9Z3f-yXLeHYT3bg1fk"><meta name="baidu-site-verification" content="code-5Ai1DA8e6T"><link href="/lib/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css"><link href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css"><link href="/css/main.css?v=5.1.4" rel="stylesheet" type="text/css"><link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png?v=5.1.4"><link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png?v=5.1.4"><link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png?v=5.1.4"><link rel="mask-icon" href="/images/logo.svg?v=5.1.4" color="#222"><meta name="keywords" content="Kali,渗透测试,"><link rel="alternate" href="/atom.xml" title="凡间的精灵" type="application/atom+xml"><meta name="description" content="使用 Kali 进行信息收集信息收集对于渗透测试前期来说是非常重要的。因为只有渗透测试者掌握了目标主机足够多的信息之后，才能更有效地对其进行漏洞检测，从而提高渗透测试的成功概率。一、发现主机1.1 扫描主机1.1.1 使用Nmap工具Nmap是一款非常强大的网络扫描和嗅探工具包。该工具主要有3个基本功能，第一是可以探测一组主机是否在线；第二是扫描主机端口，嗅探所提供的网络服务；第三是推断主机所用的"><meta name="keywords" content="Kali,渗透测试"><meta property="og:type" content="article"><meta property="og:title" content="信息收集"><meta property="og:url" content="http:&#x2F;&#x2F;chenzhonzhou.github.io&#x2F;2020&#x2F;12&#x2F;14&#x2F;kali-shen-tou-ce-shi&#x2F;index.html"><meta property="og:site_name" content="凡间的精灵"><meta property="og:description" content="使用 Kali 进行信息收集信息收集对于渗透测试前期来说是非常重要的。因为只有渗透测试者掌握了目标主机足够多的信息之后，才能更有效地对其进行漏洞检测，从而提高渗透测试的成功概率。一、发现主机1.1 扫描主机1.1.1 使用Nmap工具Nmap是一款非常强大的网络扫描和嗅探工具包。该工具主要有3个基本功能，第一是可以探测一组主机是否在线；第二是扫描主机端口，嗅探所提供的网络服务；第三是推断主机所用的"><meta property="og:locale" content="zh-Hans"><meta property="og:image" content="http:&#x2F;&#x2F;chenzhonzhou.github.io&#x2F;2020&#x2F;12&#x2F;14&#x2F;kali-shen-tou-ce-shi&#x2F;%E5%9B%BE%E7%89%871.png"><meta property="og:image" content="http:&#x2F;&#x2F;chenzhonzhou.github.io&#x2F;2020&#x2F;12&#x2F;14&#x2F;kali-shen-tou-ce-shi&#x2F;%E5%9B%BE%E7%89%872.png"><meta property="og:image" content="http:&#x2F;&#x2F;chenzhonzhou.github.io&#x2F;2020&#x2F;12&#x2F;14&#x2F;kali-shen-tou-ce-shi&#x2F;%E5%9B%BE%E7%89%873.png"><meta property="og:image" content="http:&#x2F;&#x2F;chenzhonzhou.github.io&#x2F;2020&#x2F;12&#x2F;14&#x2F;kali-shen-tou-ce-shi&#x2F;%E5%9B%BE%E7%89%874.png"><meta property="og:image" content="http:&#x2F;&#x2F;chenzhonzhou.github.io&#x2F;2020&#x2F;12&#x2F;14&#x2F;kali-shen-tou-ce-shi&#x2F;%E5%9B%BE%E7%89%875.png"><meta property="og:image" content="http:&#x2F;&#x2F;chenzhonzhou.github.io&#x2F;2020&#x2F;12&#x2F;14&#x2F;kali-shen-tou-ce-shi&#x2F;%E5%9B%BE%E7%89%876.png"><meta property="og:image" content="http:&#x2F;&#x2F;chenzhonzhou.github.io&#x2F;2020&#x2F;12&#x2F;14&#x2F;kali-shen-tou-ce-shi&#x2F;%E5%9B%BE%E7%89%877.png"><meta property="og:image" content="http:&#x2F;&#x2F;chenzhonzhou.github.io&#x2F;2020&#x2F;12&#x2F;14&#x2F;kali-shen-tou-ce-shi&#x2F;%E5%9B%BE%E7%89%878.png"><meta property="og:image" content="http:&#x2F;&#x2F;chenzhonzhou.github.io&#x2F;2020&#x2F;12&#x2F;14&#x2F;kali-shen-tou-ce-shi&#x2F;%E5%9B%BE%E7%89%879.png"><meta property="og:image" content="http:&#x2F;&#x2F;chenzhonzhou.github.io&#x2F;2020&#x2F;12&#x2F;14&#x2F;kali-shen-tou-ce-shi&#x2F;%E5%9B%BE%E7%89%8710.png"><meta property="og:image" content="http:&#x2F;&#x2F;chenzhonzhou.github.io&#x2F;2020&#x2F;12&#x2F;14&#x2F;kali-shen-tou-ce-shi&#x2F;%E5%9B%BE%E7%89%8711.png"><meta property="og:image" content="http:&#x2F;&#x2F;chenzhonzhou.github.io&#x2F;2020&#x2F;12&#x2F;14&#x2F;kali-shen-tou-ce-shi&#x2F;%E5%9B%BE%E7%89%8712.png"><meta property="og:image" content="http:&#x2F;&#x2F;chenzhonzhou.github.io&#x2F;2020&#x2F;12&#x2F;14&#x2F;kali-shen-tou-ce-shi&#x2F;%E5%9B%BE%E7%89%8713.png"><meta property="og:image" content="http:&#x2F;&#x2F;chenzhonzhou.github.io&#x2F;2020&#x2F;12&#x2F;14&#x2F;kali-shen-tou-ce-shi&#x2F;%E5%9B%BE%E7%89%8714.png"><meta property="og:image" content="http:&#x2F;&#x2F;chenzhonzhou.github.io&#x2F;2020&#x2F;12&#x2F;14&#x2F;kali-shen-tou-ce-shi&#x2F;%E5%9B%BE%E7%89%8715.png"><meta property="og:image" content="http:&#x2F;&#x2F;chenzhonzhou.github.io&#x2F;2020&#x2F;12&#x2F;14&#x2F;kali-shen-tou-ce-shi&#x2F;%E5%9B%BE%E7%89%8716.png"><meta property="og:image" content="http:&#x2F;&#x2F;chenzhonzhou.github.io&#x2F;2020&#x2F;12&#x2F;14&#x2F;kali-shen-tou-ce-shi&#x2F;%E5%9B%BE%E7%89%8717.png"><meta property="og:image" content="http:&#x2F;&#x2F;chenzhonzhou.github.io&#x2F;2020&#x2F;12&#x2F;14&#x2F;kali-shen-tou-ce-shi&#x2F;%E5%9B%BE%E7%89%8718.png"><meta property="og:image" content="http:&#x2F;&#x2F;chenzhonzhou.github.io&#x2F;2020&#x2F;12&#x2F;14&#x2F;kali-shen-tou-ce-shi&#x2F;%E5%9B%BE%E7%89%8719.png"><meta property="og:image" content="http:&#x2F;&#x2F;chenzhonzhou.github.io&#x2F;2020&#x2F;12&#x2F;14&#x2F;kali-shen-tou-ce-shi&#x2F;%E5%9B%BE%E7%89%8720.png"><meta property="og:image" content="http:&#x2F;&#x2F;chenzhonzhou.github.io&#x2F;2020&#x2F;12&#x2F;14&#x2F;kali-shen-tou-ce-shi&#x2F;%E5%9B%BE%E7%89%8721.png"><meta property="og:image" content="http:&#x2F;&#x2F;chenzhonzhou.github.io&#x2F;2020&#x2F;12&#x2F;14&#x2F;kali-shen-tou-ce-shi&#x2F;%E5%9B%BE%E7%89%8722.png"><meta property="og:updated_time" content="2020-12-15T07:43:30.855Z"><meta name="twitter:card" content="summary"><meta name="twitter:image" content="http:&#x2F;&#x2F;chenzhonzhou.github.io&#x2F;2020&#x2F;12&#x2F;14&#x2F;kali-shen-tou-ce-shi&#x2F;%E5%9B%BE%E7%89%871.png"><script type="text/javascript" id="hexo.configurations">var NexT=window.NexT||{},CONFIG={root:"/",scheme:"Gemini",version:"5.1.4",sidebar:{position:"left",display:"always",offset:12,b2t:!0,scrollpercent:!0,onmobile:!0},fancybox:!0,tabs:!0,motion:{enable:!0,async:!1,transition:{post_block:"fadeIn",post_header:"slideDownIn",post_body:"slideDownIn",coll_header:"slideLeftIn",sidebar:"slideUpIn"}},duoshuo:{userId:"0",author:"博主"},algolia:{applicationID:"",apiKey:"",indexName:"",hits:{per_page:10},labels:{input_placeholder:"Search for Posts",hits_empty:"We didn't find any results for the search: ${query}",hits_stats:"${hits} results found in ${time} ms"}}}</script><link rel="canonical" href="http://chenzhonzhou.github.io/2020/12/14/kali-shen-tou-ce-shi/"><title>信息收集 | 凡间的精灵</title><link rel="stylesheet" href="/css/prism-tomorrow.css" type="text/css"></head><body itemscope itemtype="http://schema.org/WebPage" lang="zh-Hans"><div class="container sidebar-position-left page-post-detail"><div class="headband"></div><header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader"><div class="header-inner"><div class="site-brand-wrapper"><div class="site-meta"><div class="custom-logo-site-title"><a href="/" class="brand" rel="start"><span class="logo-line-before"><i></i></span> <span class="site-title">凡间的精灵</span> <span class="logo-line-after"><i></i></span></a></div><p class="site-subtitle">凡尘落素一精灵</p></div><div class="site-nav-toggle"><button><span class="btn-bar"></span> <span class="btn-bar"></span> <span class="btn-bar"></span></button></div></div><nav class="site-nav"><ul id="menu" class="menu"><li class="menu-item menu-item-home"><a href="/" rel="section"><i class="menu-item-icon fa fa-fw fa-home"></i><br>首页</a></li><li class="menu-item menu-item-archives"><a href="/archives/" rel="section"><i class="menu-item-icon fa fa-fw fa-archive"></i><br>归档</a></li><li class="menu-item menu-item-categories"><a href="/categories" rel="section"><i class="menu-item-icon fa fa-fw fa-th"></i><br>分类</a></li><li class="menu-item menu-item-tags"><a href="/tags" rel="section"><i class="menu-item-icon fa fa-fw fa-tags"></i><br>标签</a></li><li class="menu-item menu-item-sitemap"><a href="/sitemap.xml" rel="section"><i class="menu-item-icon fa fa-fw fa-sitemap"></i><br>站点地图</a></li><li class="menu-item menu-item-search"><a href="javascript:;" class="popup-trigger"><i class="menu-item-icon fa fa-search fa-fw"></i><br>搜索</a></li></ul><div class="site-search"><div class="popup search-popup local-search-popup"><div class="local-search-header clearfix"><span class="search-icon"><i class="fa fa-search"></i> </span><span class="popup-btn-close"><i class="fa fa-times-circle"></i></span><div class="local-search-input-wrapper"><input autocomplete="off" placeholder="搜索..." spellcheck="false" type="text" id="local-search-input"></div></div><div id="local-search-result"></div></div></div></nav></div></header><main id="main" class="main"><div class="main-inner"><div class="content-wrap"><div id="content" class="content"><div id="posts" class="posts-expand"><article class="post post-type-normal" itemscope itemtype="http://schema.org/Article"><div class="post-block"><link itemprop="mainEntityOfPage" href="http://chenzhonzhou.github.io/2020/12/14/kali-shen-tou-ce-shi/"><span hidden itemprop="author" itemscope itemtype="http://schema.org/Person"><meta itemprop="name" content="Zhongzhou Chen"><meta itemprop="description" content=""><meta itemprop="image" content="/images/chen.png"></span><span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization"><meta itemprop="name" content="凡间的精灵"></span><header class="post-header"><h1 class="post-title" itemprop="name headline">信息收集</h1><div class="post-meta"><span class="post-time"><span class="post-meta-item-icon"><i class="fa fa-calendar-o"></i> </span><span class="post-meta-item-text">发表于</span> <time title="创建于" itemprop="dateCreated datePublished" datetime="2020-12-14T18:09:57+08:00">2020-12-14 </time></span><span class="post-category"><span class="post-meta-divider">|</span> <span class="post-meta-item-icon"><i class="fa fa-folder-o"></i> </span><span class="post-meta-item-text">分类于</span> <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95/" itemprop="url" rel="index"><span itemprop="name">渗透测试</span></a></span></span><div class="post-wordcount"><span class="post-meta-item-icon"><i class="fa fa-file-word-o"></i> </span><span class="post-meta-item-text">字数统计&#58;</span> <span title="字数统计">16.9k </span><span class="post-meta-divider">|</span> <span class="post-meta-item-icon"><i class="fa fa-clock-o"></i> </span><span class="post-meta-item-text">阅读时长 &asymp;</span> <span title="阅读时长">71</span></div></div></header><div class="post-body" itemprop="articleBody"><h1 id="使用-Kali-进行信息收集"><a href="#使用-Kali-进行信息收集" class="headerlink" title="使用 Kali 进行信息收集"></a>使用 Kali 进行信息收集</h1><p>信息收集对于渗透测试前期来说是非常重要的。因为只有渗透测试者掌握了目标主机足够多的信息之后，才能更有效地对其进行漏洞检测，从而提高渗透测试的成功概率。</p><h2 id="一、发现主机"><a href="#一、发现主机" class="headerlink" title="一、发现主机"></a>一、发现主机</h2><h3 id="1-1-扫描主机"><a href="#1-1-扫描主机" class="headerlink" title="1.1 扫描主机"></a>1.1 扫描主机</h3><h4 id="1-1-1-使用Nmap工具"><a href="#1-1-1-使用Nmap工具" class="headerlink" title="1.1.1 使用Nmap工具"></a>1.1.1 使用Nmap工具</h4><p>Nmap是一款非常强大的网络扫描和嗅探工具包。该工具主要有3个基本功能，第一是可以探测一组主机是否在线；第二是扫描主机端口，嗅探所提供的网络服务；第三是推断主机所用的操作系统。下面将介绍使用Nmap工具探测目标主机是否在线。其中，语法格式如下：</p><blockquote><p>nmap -sP [target]</p></blockquote><p>以上语法中的选项-sP，表示对目标主机实施Ping扫描；参数[target]用来指定扫描的目标地址。其中，该目标可以是主机名、IP地址（包括单个地址、多个地址或地址范围），以及网段等。</p><p>探测目标主机192.168.10.3是否在线。执行命令如下：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># nmap -sP 192.168.10.55</span></span><br><span class="line">Starting Nmap 7.91 ( https://nmap.org ) at 2020-12-11 14:59 CST</span><br><span class="line">Nmap scan report <span class="keyword">for</span> localhost (192.168.10.55)</span><br><span class="line">Host is up (0.00055s latency).</span><br><span class="line">Nmap <span class="keyword">done</span>: 1 IP address (1 host up) scanned <span class="keyword">in</span> 0.16 seconds</span><br></pre></td></tr></table></figure><p>探测192.168.10.0/24网段中活动的主机。执行命令如下：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># nmap -sP 192.168.10.0/24</span></span><br><span class="line">Starting Nmap 7.91 ( https://nmap.org ) at 2020-12-11 15:01 CST</span><br><span class="line">Nmap scan report <span class="keyword">for</span> localhost (192.168.10.1)</span><br><span class="line">Host is up (0.0054s latency).</span><br><span class="line">Nmap scan report <span class="keyword">for</span> localhost (192.168.10.9)</span><br><span class="line">Host is up (0.0033s latency).</span><br><span class="line">Nmap scan report <span class="keyword">for</span> localhost (192.168.10.10)</span><br><span class="line">Host is up (0.043s latency).</span><br><span class="line">Nmap scan report <span class="keyword">for</span> localhost (192.168.10.54)</span><br><span class="line">Host is up (0.021s latency).</span><br><span class="line">Nmap scan report <span class="keyword">for</span> localhost (192.168.10.74)</span><br><span class="line">Host is up (0.027s latency).</span><br><span class="line">Nmap <span class="keyword">done</span>: 256 IP addresses (5 hosts up) scanned <span class="keyword">in</span> 2.62 seconds</span><br></pre></td></tr></table></figure><p>从输出的最后一行信息可以看到，共扫描了256个主机。其中，活动的主机有5个。</p><h4 id="1-1-2-使用Netdiscover工具"><a href="#1-1-2-使用Netdiscover工具" class="headerlink" title="1.1.2 使用Netdiscover工具"></a>1.1.2 使用Netdiscover工具</h4><p>Netdiscover是一个支持主动和被动两种模式的ARP侦查工具。使用该工具可以在网络上扫描IP地址，检查在线主机。下面将介绍使用Netdiscover工具实施ARP主动扫描。语法格式如下：</p><blockquote><p>netdiscover -r [range]</p></blockquote><p>以上语法中的选项-r[range]用来指定扫描的网络范围。如果用户没有指定目标，将自动选择目标网络实施扫描。<br>使用Netdiscover工具扫描192.168.1.0/24网段内在线主机。执行命令如下：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># netdiscover -r 192.168.48.0/24</span></span><br><span class="line"> Currently scanning: 192.168.48.0/24   |   Screen View: Unique Hosts</span><br><span class="line">                                                                    </span><br><span class="line"> 4 Captured ARP Req/Rep packets, from 3 hosts.   Total size: 240    </span><br><span class="line"> _____________________________________________________________________________</span><br><span class="line">   IP            At MAC Address     Count     Len  MAC Vendor / Hostname      </span><br><span class="line"> -----------------------------------------------------------------------------</span><br><span class="line"> 192.168.48.254  00:50:56:fa:07:94      2     120  VMware, Inc.     </span><br><span class="line"> 192.168.48.1    00:50:56:c0:00:08      1      60  VMware, Inc.     </span><br><span class="line"> 192.168.48.2    00:50:56:f7:fd:b9      1      60  VMware, Inc.</span><br></pre></td></tr></table></figure><p>在以上输出信息中共显示了5列，分别是IP（IP地址）、At MAC Address（MAC地址）、Count（包数）、Len（长度）、MAC Vendor/Hostname（MAC地址生产厂商/主机名）。通过分析捕获到的包，可以知道当前局域网中活动的主机IP地址、MAC地址及MAC地址的生产厂商等。从IP列可以看到在线主机的地址。其中，在线的主机地址为192.168.1.1、192.168.1.3和192.168.1.43。而且，在输出信息的左上角可以看到，当前的扫描状态为Finished，即扫描完成。此时，按Ctrl+C组合键即可退 Netdiscover工具的扫描界面。</p><p>用户也可以不指定扫描范围，尽可能地发现多个在线主机。执行命令如下：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># netdiscover</span></span><br></pre></td></tr></table></figure><h3 id="1-2-监听发现主机"><a href="#1-2-监听发现主机" class="headerlink" title="1.2 监听发现主机"></a>1.2 监听发现主机</h3><p>监听就是不主动向目标发送数据包，仅监听网络中的数据包。在局域网中，一些协议将自动广播数据包，如ARP广播和DHCP广播。而广播包是局域网中的所有用户都可以接收到的数据包。因此，用户通过对这些数据包进行监听，可以探测网络中活动的主机。下面将介绍通过监听方式发现主机。</p><h4 id="1-2-1-ARP监听"><a href="#1-2-1-ARP监听" class="headerlink" title="1.2.1 ARP监听"></a>1.2.1 ARP监听</h4><p>ARP（Address Resolution Protocol，地址解析协议）是根据IP地址获取物理地址的一个TCP/IP协议。主机发送信息时，将包含目标IP地址的ARP请求广播到网络上的所有主机，并接收返回消息，以此确定目标的物理地址。所以，通过实施ARP监听，即可发现局域网中活动的主机。下面将介绍使用Netdiscover工具的被动模式实施ARP监听，以此来发现在线主机。其中，Netdiscover工具实施被动扫描的语法格式如下：</p><blockquote><p>netdiscover -p</p></blockquote><p>以上语法中的选项-p表示使用被动模式，即不发送任何数据包，仅嗅探。</p><p>使用Netdiscover工具实施被动扫描。执行命令如下：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># netdiscover -p</span></span><br><span class="line"> Currently scanning: (passive)   |   Screen View: Unique Hosts      </span><br><span class="line">                                                                    </span><br><span class="line"> 0 Captured ARP Req/Rep packets, from 3 hosts.   Total size: 2340      </span><br><span class="line"> _____________________________________________________________________________</span><br><span class="line">   IP            At MAC Address     Count     Len  MAC Vendor / Hostname      </span><br><span class="line"> -----------------------------------------------------------------------------</span><br><span class="line"> 192.168.48.254  00:50:56:fa:07:94      2     120  VMware, Inc.     </span><br><span class="line"> 192.168.48.1    00:50:56:c0:00:08      7      480  VMware, Inc.     </span><br><span class="line"> 192.168.48.2    00:50:56:f7:fd:b9      1      60  VMware, Inc.</span><br></pre></td></tr></table></figure><p>从输出的第1行信息中，可以看到正在使用被动模式（passive）实施扫描。从第2行信息中，可以看到嗅探到的包数、主机数及包大小。第3行以下的信息，则是嗅探到的包信息。从IP列可以看到探测到的在线主机。其中，在线的主机地址分别是192.168.10.1、192.168.10.2和192.168.10.254。</p><h4 id="1-2-2-DHCP监听"><a href="#1-2-2-DHCP监听" class="headerlink" title="1.2.2 DHCP监听"></a>1.2.2 DHCP监听</h4><p>DHCP（Dynamic Host Configuration Protocol，动态主机配置协议）是一个局域网的网络协议，其主要作用是实现内部网或网络服务供应商自动分配IP地址。当一个客户端需要获取一个IP地址时，将会发送广播包。然后，收到请求的DHCP服务器会提供一个可用的IP地址给客户端。所以，用户可以实施DHCP监听来判断网络中的在线主机。下面将介绍通过Nmap的broadcast-dhcp-discover脚本实施DHCP监听来发现主机。</p><p>Nmap的broadcast-dhcp-discover脚本能够用来发送一个DHCP Discover广播包，并显示响应包的具体信息。通过对响应包的信息进行分析，能够找到可分配的IP地址。其中，使用该脚本实施被动扫描的语法格式如下：</p><blockquote><p>nmap –script broadcast-dhcp-discover</p></blockquote><p>以上语法中的–script选项用来指定使用的脚本。</p><p>使用broadcast-dhcp-discover脚本向局域网中发送DHCP Discover广播包。执行命令如下：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># nmap --script broadcast-dhcp-discover</span></span><br><span class="line">Starting Nmap 7.91 ( https://nmap.org ) at 2020-12-11 15:16 CST</span><br><span class="line">Pre-scan script results:</span><br><span class="line">| broadcast-dhcp-discover: </span><br><span class="line">|   Response 1 of 1: </span><br><span class="line">|     IP Offered: 192.168.33.156          <span class="comment">#提供的IP地址</span></span><br><span class="line">|     DHCP Message Type: DHCPOFFER        <span class="comment">#DHCP消息类型</span></span><br><span class="line">|     Server Identifier: 192.168.33.254   <span class="comment">#服务器标识符</span></span><br><span class="line">|     IP Address Lease Time: 30m00s       <span class="comment">#IP地址释放时间</span></span><br><span class="line">|     Subnet Mask: 255.255.255.0          <span class="comment">#子网掩码</span></span><br><span class="line">|     Router: 192.168.33.2                <span class="comment">#路由地址</span></span><br><span class="line">|     Domain Name Server: 192.168.33.2    <span class="comment">#域名服务</span></span><br><span class="line">|     Domain Name: localdomain            <span class="comment">#域名</span></span><br><span class="line">|     Broadcast Address: 192.168.33.255   <span class="comment">#广播地址</span></span><br><span class="line">|     NetBIOS Name Server: 192.168.33.2   <span class="comment">#NetBIOS名称服务</span></span><br><span class="line">|     Renewal Time Value: 15m00s          <span class="comment">#更新时间值</span></span><br><span class="line">|_    Rebinding Time Value: 26m15s        <span class="comment">#第二次选择时间值</span></span><br><span class="line">WARNING: No targets were specified, so 0 hosts scanned.</span><br><span class="line">Nmap <span class="keyword">done</span>: 0 IP addresses (0 hosts up) scanned <span class="keyword">in</span> 10.62 seconds</span><br></pre></td></tr></table></figure><h2 id="二、域名分析"><a href="#二、域名分析" class="headerlink" title="二、域名分析"></a>二、域名分析</h2><p>域名（Domain Name）是由一串用点分隔的名字，用来表示Internet上某一台计算机或计算机组名称。它可以在数据传输时标识计算机的电子方位。通常情况下，外网的主机都是使用域名来标识的。如果要对外网的主机实施渗透测试，则需要对域名进行分析，以获取该域名的详细信息，如域名所有者信息、子域名、服务器地址等。</p><h3 id="2-1-域名基础信息"><a href="#2-1-域名基础信息" class="headerlink" title="2.1 域名基础信息"></a>2.1 域名基础信息</h3><p>当一个域名注册完成后，包含的基本信息，如域名是否已经被注册、域名注册商、域名所有者等。通过查看域名的WHOIS信息，即可获取到该域名的基础信息。</p><h4 id="2-1-1-使用WHOIS工具"><a href="#2-1-1-使用WHOIS工具" class="headerlink" title="2.1.1 使用WHOIS工具"></a>2.1.1 使用WHOIS工具</h4><p>WHOIS工具是用来查找并显示指定账号（或域名）的用户相关信息。其中，使用该工具查询域名信息的语法格式如下：</p><blockquote><p>whois [域名]</p></blockquote><p>使用WHOIS工具查询域名baidu.com的相关信息。执行命令如下：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># whois baidu.com</span></span><br><span class="line">   Domain Name: BAIDU.COM                          <span class="comment">#域名</span></span><br><span class="line">   Registry Domain ID: 11181110_DOMAIN_COM-VRSN    <span class="comment">#注册域名ID</span></span><br><span class="line">   Registrar WHOIS Server: whois.markmonitor.com   <span class="comment">#注册WHOIS服务器</span></span><br><span class="line">   Registrar URL: http://www.markmonitor.com       <span class="comment">#注册者URL</span></span><br><span class="line">   Updated Date: 2020-12-09T04:04:41Z              <span class="comment">#更新时间</span></span><br><span class="line">   Creation Date: 1999-10-11T11:05:17Z             <span class="comment">#创建时间</span></span><br><span class="line">   Registry Expiry Date: 2026-10-11T11:05:17Z      <span class="comment">#过期时间</span></span><br><span class="line">   Registrar: MarkMonitor Inc.                     <span class="comment">#注册人</span></span><br><span class="line">   Registrar IANA ID: 292                          <span class="comment">#注册者IANA ID</span></span><br><span class="line">   Registrar Abuse Contact Email: abusecomplaints@markmonitor.com <span class="comment">#注册者滥用电子邮箱联系人</span></span><br><span class="line">   Registrar Abuse Contact Phone: +1.2083895740    <span class="comment">#注册者滥用电话号码</span></span><br><span class="line">   Domain Status: clientDeleteProhibited https://icann.org/epp<span class="comment">#clientDeleteProhibited       #域名状态</span></span><br><span class="line">   Domain Status: clientTransferProhibited https://icann.org/epp<span class="comment">#clientTransferProhibited</span></span><br><span class="line">   Domain Status: clientUpdateProhibited https://icann.org/epp<span class="comment">#clientUpdateProhibited</span></span><br><span class="line">   Domain Status: serverDeleteProhibited https://icann.org/epp<span class="comment">#serverDeleteProhibited</span></span><br><span class="line">   Domain Status: serverTransferProhibited https://icann.org/epp<span class="comment">#serverTransferProhibited</span></span><br><span class="line">   Domain Status: serverUpdateProhibited https://icann.org/epp<span class="comment">#serverUpdateProhibited</span></span><br><span class="line">   Name Server: NS1.BAIDU.COM                      <span class="comment">#域名服务器</span></span><br><span class="line">   Name Server: NS2.BAIDU.COM</span><br><span class="line">   Name Server: NS3.BAIDU.COM</span><br><span class="line">   Name Server: NS4.BAIDU.COM</span><br><span class="line">   Name Server: NS7.BAIDU.COM</span><br><span class="line">   DNSSEC: unsigned</span><br><span class="line">   URL of the ICANN Whois Inaccuracy Complaint Form: https://www.icann.org/wicf/</span><br><span class="line">&gt;&gt;&gt; Last update of whois database: 2020-12-11T08:13:35Z &lt;&lt;&lt;    <span class="comment">#最后更新WHOIS数据库时间</span></span><br><span class="line">…//省略部分内容//…  </span><br><span class="line">&gt;&gt;&gt; Last update of WHOIS database: 2020-12-11T00:04:18-0800 &lt;&lt;&lt;</span><br><span class="line"></span><br><span class="line">For more information on WHOIS status codes, please visit:</span><br><span class="line">  https://www.icann.org/resources/pages/epp-status-codes</span><br><span class="line"></span><br><span class="line">If you wish to contact this domain’s Registrant, Administrative, or Technical</span><br><span class="line">contact, and such email address is not visible above, you may <span class="keyword">do</span> so via our web</span><br><span class="line">form, pursuant to ICANN’s Temporary Specification. To verify that you are not a</span><br><span class="line">robot, please enter your email address to receive a link to a page that</span><br><span class="line">facilitates email communication with the relevant contact(s).</span><br><span class="line"></span><br><span class="line">Web-based WHOIS:                                   <span class="comment">#基于Web的WHOIS信息</span></span><br><span class="line">  https://domains.markmonitor.com/whois</span><br><span class="line"></span><br><span class="line">If you have a legitimate interest <span class="keyword">in</span> viewing the non-public WHOIS details, send</span><br><span class="line">your request and the reasons <span class="keyword">for</span> your request to whoisrequest@markmonitor.com</span><br><span class="line">and specify the domain name <span class="keyword">in</span> the subject line. We will review that request and</span><br><span class="line">may ask <span class="keyword">for</span> supporting documentation and explanation.</span><br><span class="line"></span><br><span class="line">The data <span class="keyword">in</span> MarkMonitor’s WHOIS database is provided <span class="keyword">for</span> information purposes,</span><br><span class="line">and to assist persons <span class="keyword">in</span> obtaining information about or related to a domain</span><br><span class="line">name’s registration record. While MarkMonitor believes the data to be accurate,</span><br><span class="line">the data is provided <span class="string">"as is"</span> with no guarantee or warranties regarding its</span><br><span class="line">accuracy.</span><br><span class="line"></span><br><span class="line">By submitting a WHOIS query, you agree that you will use this data only <span class="keyword">for</span></span><br><span class="line">lawful purposes and that, under no circumstances will you use this data to:</span><br><span class="line">  (1) allow, <span class="built_in">enable</span>, or otherwise support the transmission by email, telephone,</span><br><span class="line">or facsimile of mass, unsolicited, commercial advertising, or spam; or</span><br><span class="line">  (2) <span class="built_in">enable</span> high volume, automated, or electronic processes that send queries,</span><br><span class="line">data, or email to MarkMonitor (or its systems) or the domain name contacts (or</span><br><span class="line">its systems).</span><br><span class="line"></span><br><span class="line">MarkMonitor reserves the right to modify these terms at any time.</span><br><span class="line"></span><br><span class="line">By submitting this query, you agree to abide by this policy.</span><br><span class="line"></span><br><span class="line">MarkMonitor Domain Management(TM)</span><br><span class="line">Protecting companies and consumers <span class="keyword">in</span> a digital world.</span><br><span class="line"></span><br><span class="line">Visit MarkMonitor at https://www.markmonitor.com</span><br><span class="line">Contact us at +1.8007459229</span><br><span class="line">In Europe, at +44.02032062220</span><br><span class="line">--</span><br></pre></td></tr></table></figure><p>从以上输出信息可以看到获取域名baidu.com的相关WHOIS信息。例如，注册商域名ID为11181110_DOMAIN_COM-VRSN，注册的WHOIS服务器为whois.markmonitor.com，创建时间为1999-10-11T11:05:17Z等。</p><h4 id="2-1-2-使用DMitry工具"><a href="#2-1-2-使用DMitry工具" class="headerlink" title="2.1.2 使用DMitry工具"></a>2.1.2 使用DMitry工具</h4><p>DMitry是一个一体化的信息收集工具。使用该工具可以收集WHOIS主机IP和域名信息、子域名、域名中包含的邮件地址等。其中，用于获取WHOIS信息的语法格式如下：</p><blockquote><p>dmitry -w [domain]</p></blockquote><p>以上语法中的选项及含义如下：</p><blockquote><p>-w：对指定的域名实施WHOIS查询。<br>domain：指定查询的目标域名。</p></blockquote><p>使用DMitry工具查询域名baidu.com的WHOIS信息。执行命令如下：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># dmitry -w baiud.com</span></span><br><span class="line">Deepmagic Information Gathering Tool</span><br><span class="line"><span class="string">"There be some deep magic going on"</span></span><br><span class="line"></span><br><span class="line">HostIP:103.231.13.42                                  <span class="comment">#主机IP地址</span></span><br><span class="line">HostName:baiud.com                                    <span class="comment">#主机名</span></span><br><span class="line"></span><br><span class="line">Gathered Inic-whois information <span class="keyword">for</span> baiud.com         <span class="comment">#生成的WHOIS信息</span></span><br><span class="line">---------------------------------</span><br><span class="line">   Domain Name: BAIUD.COM                             <span class="comment">#域名</span></span><br><span class="line">   Registry Domain ID: 103771190_DOMAIN_COM-VRSN      <span class="comment">#注册域名ID</span></span><br><span class="line">   Registrar WHOIS Server: whois.bizcn.com            <span class="comment">#注册WHOIS服务器</span></span><br><span class="line">   Registrar URL: http://www.bizcn.com                <span class="comment">#注册者URL</span></span><br><span class="line">   Updated Date: 2020-09-20T07:04:56Z                 <span class="comment">#更新时间</span></span><br><span class="line">   Creation Date: 2003-09-19T06:38:05Z                <span class="comment">#创建时间</span></span><br><span class="line">   Registry Expiry Date: 2021-09-19T06:38:05Z         <span class="comment">#过期时间</span></span><br><span class="line">   Registrar: Bizcn.com, Inc.                         <span class="comment">#注册者</span></span><br><span class="line">   Registrar IANA ID: 471                             <span class="comment">#注册者IANA ID</span></span><br><span class="line">   Registrar Abuse Contact Email:                     <span class="comment">#注册者滥用邮件联系人</span></span><br><span class="line">   Registrar Abuse Contact Phone:                     <span class="comment">#注册者滥用电话号码</span></span><br><span class="line">   Domain Status: clientDeleteProhibited https://icann.org/epp<span class="comment">#clientDeleteProhibited          #域名状态</span></span><br><span class="line">   Domain Status: clientTransferProhibited https://icann.org/epp<span class="comment">#clientTransferProhibited</span></span><br><span class="line">   Name Server: DNS1.PENDING-RENEWAL-DOMAIN.COM       <span class="comment">#域名服务器</span></span><br><span class="line">   Name Server: DNS2.PENDING-RENEWAL-DOMAIN.COM</span><br><span class="line">   DNSSEC: unsigned</span><br><span class="line">   URL of the ICANN Whois Inaccuracy Complaint Form: https://www.icann.org/wicf/</span><br><span class="line">&gt;&gt;&gt; Last update of whois database: 2020-12-11T08:23:07Z &lt;&lt;&lt;    <span class="comment">#最后更新WHOIS数据库时间</span></span><br><span class="line"></span><br><span class="line">For more information on Whois status codes, please visit https://icann.org/epp</span><br><span class="line"></span><br><span class="line">NOTICE: The expiration date displayed <span class="keyword">in</span> this record is the date the</span><br><span class="line">registrar<span class="string">'s sponsorship of the domain name registration in the registry is</span></span><br><span class="line"><span class="string">currently set to expire. This date does not necessarily reflect the expiration</span></span><br><span class="line"><span class="string">date of the domain name registrant'</span>s agreement with the sponsoring</span><br><span class="line">registrar.  Users may consult the sponsoring registrar<span class="string">'s Whois database to</span></span><br><span class="line"><span class="string">view the registrar'</span>s reported date of expiration <span class="keyword">for</span> this registration.</span><br><span class="line"></span><br><span class="line">TERMS OF USE: You are not authorized to access or query our Whois</span><br><span class="line">database through the use of electronic processes that are high-volume and</span><br><span class="line">automated except as reasonably necessary to register domain names or</span><br><span class="line">modify existing registrations; the Data <span class="keyword">in</span> VeriSign Global Registry</span><br><span class="line">Services<span class="string">' ("VeriSign") Whois database is provided by VeriSign for</span></span><br><span class="line"><span class="string">information purposes only, and to assist persons in obtaining information</span></span><br><span class="line"><span class="string">about or related to a domain name registration record. VeriSign does not</span></span><br><span class="line"><span class="string">guarantee its accuracy. By submitting a Whois query, you agree to abide</span></span><br><span class="line"><span class="string">by the following terms of use: You agree that you may use this Data only</span></span><br><span class="line"><span class="string">for lawful purposes and that under no circumstances will you use this Data</span></span><br><span class="line"><span class="string">to: (1) allow, enable, or otherwise support the transmission of mass</span></span><br><span class="line"><span class="string">unsolicited, commercial advertising or solicitations via e-mail, telephone,</span></span><br><span class="line"><span class="string">or facsimile; or (2) enable high volume, automated, electronic processes</span></span><br><span class="line"><span class="string">that apply to VeriSign (or its computer systems). The compilation,</span></span><br><span class="line"><span class="string">repackaging, dissemination or other use of this Data is expressly</span></span><br><span class="line"><span class="string">prohibited without the prior written consent of VeriSign. You agree not to</span></span><br><span class="line"><span class="string">use electronic processes that are automated and high-volume to access or</span></span><br><span class="line"><span class="string">query the Whois database except as reasonably necessary to register</span></span><br><span class="line"><span class="string">domain names or modify existing registrations. VeriSign reserves the right</span></span><br><span class="line"><span class="string">to restrict your access to the Whois database in its sole discretion to ensure</span></span><br><span class="line"><span class="string">operational stability.  VeriSign may restrict or terminate your access to the</span></span><br><span class="line"><span class="string">Whois database for failure to abide by these terms of use. VeriSign</span></span><br><span class="line"><span class="string">reserves the right to modify these terms at any time.</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">The Registry database contains ONLY .COM, .NET, .EDU domains and</span></span><br><span class="line"><span class="string">Registrars.</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">All scans completed, exiting</span></span><br></pre></td></tr></table></figure><p>从以上输出信息中可以看到，成功获取了域名baidu.com相关的WHOIS信息。</p><h3 id="2-2-查找子域名"><a href="#2-2-查找子域名" class="headerlink" title="2.2 查找子域名"></a>2.2 查找子域名</h3><p>子域名又称为子域（Subdomain），在域名系统等级中，它属于更高一层域的域。例如，<a href="http://www.baidu.com" target="_blank" rel="noopener">www.baidu.com</a> 和map.baidu.com是baidu.com的两个子域，而baidu.com则是顶级域.com的子域。通常情况下，一个子域名会包含主机名。例如，<a href="http://www.baidu.com" target="_blank" rel="noopener">www.baidu.com</a> 域名中，.com是顶级域名；baidu.com是一级域名；www是主机名，用来标识服务器。所以，baidu.com建立WWW服务器就是 <a href="http://www.baidu.com" target="_blank" rel="noopener">www.baidu.com</a> 。因此，通过查找子域名的方式，可以发现对应的主机。</p><h4 id="2-2-1-使用Dmitry工具"><a href="#2-2-1-使用Dmitry工具" class="headerlink" title="2.2.1 使用Dmitry工具"></a>2.2.1 使用Dmitry工具</h4><p>Dmitry工具可以用来查找子域名。但是，该工具是通过Google搜索引擎来查找子域名的。所以，对于国内的用户来说，需要使用VPN代理来实现。否则，将会出现网络连接错误的提示。如下：</p><blockquote><p>Searching Google.com:80…<br>Unable to connect: Socket Connect Error</p></blockquote><p>使用Dmitry工具查找子域名的语法格式如下：</p><blockquote><p>dmitry -s<domain>-o<file></file></domain></p></blockquote><p>以上语法中的选项及含义如下：</p><blockquote><p>-s：实施子域名查询。<br>-o：指定保存输出结果的文件。</p></blockquote><p>使用Dmitry工具查找域名baidu.com的子域名。执行命令如下：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># dmitry -s baidu.com -o subdomain</span></span><br><span class="line">Deepmagic Information Gathering Tool</span><br><span class="line"><span class="string">"There be some deep magic going on"</span></span><br><span class="line">Writing output to <span class="string">'subdomain.txt'</span>                  <span class="comment">#输出到subdomain.txt文件</span></span><br><span class="line">HostIP:123.125.114.144                             <span class="comment">#主机IP地址</span></span><br><span class="line">HostName:baidu.com                                                                <span class="comment">#主机名</span></span><br><span class="line">Gathered Subdomain information <span class="keyword">for</span> baidu.com       <span class="comment">#收集子域名</span></span><br><span class="line">---------------------------------</span><br><span class="line">Searching Google.com:80...</span><br><span class="line">HostName:www.baidu.com</span><br><span class="line">HostIP:119.63.197.151</span><br><span class="line">HostName:yun.baidu.com</span><br><span class="line">…//省略部分内容//…</span><br><span class="line">HostName:pay.baidu.com</span><br><span class="line">HostIP:220.181.33.88</span><br><span class="line">HostName:b2b.baidu.com</span><br><span class="line">HostIP:157.255.77.23</span><br><span class="line">Searching Altavista.com:80...</span><br><span class="line">Found 64 possible subdomain(s) <span class="keyword">for</span> host baidu.com, Searched 0 pages </span><br><span class="line">containing 0 results</span><br><span class="line">All scans completed, exiting</span><br></pre></td></tr></table></figure><p>从以上输出信息可以看到查找到域名baidu.com的所有子域名及对应的IP地址。</p><h4 id="2-2-2-在线查询"><a href="#2-2-2-在线查询" class="headerlink" title="2.2.2 在线查询"></a>2.2.2 在线查询</h4><p>用户还可以用在线查询方式查找子域名。其中，在线查询子域名的地址为 <a href="https://phpinfo.me/domain/" target="_blank" rel="noopener">https://phpinfo.me/domain/</a> 。当用户在浏览器中成功访问该地址后，将显示如下图所示的界面。</p><p><img src="/2020/12/14/kali-shen-tou-ce-shi/%E5%9B%BE%E7%89%871.png" alt="图片1"></p><p>在文本框中输入要查询的域名。然后，单击“开始”按钮，即可查找对应的子域名。例如，这里查找域名baidu.com的子域名，结果如下图所示。</p><p><img src="/2020/12/14/kali-shen-tou-ce-shi/%E5%9B%BE%E7%89%872.png" alt="图片2"></p><p>从该界面可以看到找到的所有子域名，如 <a href="http://www.baidu.com" target="_blank" rel="noopener">www.baidu.com</a> 、mail.baidu.com和pop.baidu.com等。</p><h3 id="2-3-发现服务器"><a href="#2-3-发现服务器" class="headerlink" title="2.3 发现服务器"></a>2.3 发现服务器</h3><p>域名虽然方便人们记忆，但是网络中的计算机之间只能互相认识IP地址。所以，就需要根据域名查询对应的主机。在域名服务器中，通过域名记录来标识不同的主机，如A记录、MX记录、NS记录等。其中，A记录表示一台主机；MX记录表示邮件服务器；NS表示DNS服务器。其中，每个域名记录都包含一个IP地址。用户通过探测域名服务器，可以确定域名对应的IP地址。下面将介绍发现服务器的方法。</p><h4 id="2-3-1-使用Dnsenum工具"><a href="#2-3-1-使用Dnsenum工具" class="headerlink" title="2.3.1 使用Dnsenum工具"></a>2.3.1 使用Dnsenum工具</h4><p>Dnsenum是一款域名信息收集工具，它能够通过谷歌或者字典文件猜测可能存在的域名，以及对一个网段进行反向查询。它可以查询网站的主机地址信息、域名服务器和邮件交换记录等。其中，使用该工具收集域名信息的语法格式如下：</p><blockquote><p>dnsenum -w<domain></domain></p></blockquote><p>使用Dnsenum枚举子域名baidu.com的信息。执行命令如下：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># dnsenum -w baidu.com</span></span><br><span class="line">dnsenum VERSION:1.2.4</span><br><span class="line"></span><br><span class="line">-----   baidu.com   -----</span><br><span class="line"></span><br><span class="line">Host<span class="string">'s addresses:                               #主机的地址</span></span><br><span class="line"><span class="string">__________________</span></span><br><span class="line"><span class="string">baidu.com.                            5        IN    A        220.181.57.216</span></span><br><span class="line"><span class="string">baidu.com.                            5        IN    A        123.125.114.144</span></span><br><span class="line"><span class="string">Wildcard detection using: uyvdfbpavvhg          #使用了泛域名解析</span></span><br><span class="line"><span class="string">_______________________________________</span></span><br><span class="line"><span class="string">uyvdfbpavvhg.baidu.com.               5        IN    A        221.204.244.41</span></span><br><span class="line"><span class="string">uyvdfbpavvhg.baidu.com.               5        IN    A        221.204.244.40</span></span><br><span class="line"><span class="string">uyvdfbpavvhg.baidu.com.               5        IN    A        221.204.244.36</span></span><br><span class="line"><span class="string">uyvdfbpavvhg.baidu.com.               5        IN    A        221.204.244.37</span></span><br><span class="line"><span class="string">!!!!!!!!!!!!!!!!!!!!!!!!!!!!</span></span><br><span class="line"><span class="string"> Wildcards detected, all subdomains will point to the same IP address</span></span><br><span class="line"><span class="string"> Omitting results containing 221.204.244.41, 221.204.244.40, 221.204.244.36, 221.204.244.37.</span></span><br><span class="line"><span class="string"> Maybe you are using OpenDNS servers.</span></span><br><span class="line"><span class="string">!!!!!!!!!!!!!!!!!!!!!!!!!!!!</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">Name Servers:                                   #域名服务器</span></span><br><span class="line"><span class="string">______________</span></span><br><span class="line"><span class="string">ns3.baidu.com.                        5        IN    A        112.80.248.64</span></span><br><span class="line"><span class="string">ns7.baidu.com.                        5        IN    A        180.76.76.92</span></span><br><span class="line"><span class="string">dns.baidu.com.                        5        IN    A        110.242.68.134</span></span><br><span class="line"><span class="string">ns2.baidu.com.                        5        IN    A        220.181.33.31</span></span><br><span class="line"><span class="string">ns4.baidu.com.                        5        IN    A        14.215.178.80</span></span><br><span class="line"><span class="string">                                                                 </span></span><br><span class="line"><span class="string">Mail (MX) Servers:                              #邮件服务器    </span></span><br><span class="line"><span class="string">___________________    </span></span><br><span class="line"><span class="string">mx.maillb.baidu.com.                  5        IN    A        111.202.115.85</span></span><br><span class="line"><span class="string">mx50.baidu.com.                       5        IN    A        180.76.13.18</span></span><br><span class="line"><span class="string">mx.n.shifen.com.                      5        IN    A        61.135.165.120</span></span><br><span class="line"><span class="string">mx.n.shifen.com.                      5        IN    A        111.202.115.85</span></span><br><span class="line"><span class="string">jpmx.baidu.com.                       5        IN    A        61.208.132.13</span></span><br><span class="line"><span class="string">mx1.baidu.com.                        5        IN    A        220.181.50.185</span></span><br><span class="line"><span class="string">mx1.baidu.com.                        5        IN    A        61.135.165.120</span></span><br></pre></td></tr></table></figure><p>从以上输出信息可以看到，获取到了子域名 <a href="http://www.baidu.com" target="_blank" rel="noopener">www.baidu.com</a> 的IP地址。</p><h4 id="2-3-2-使用Nslookup工具"><a href="#2-3-2-使用Nslookup工具" class="headerlink" title="2.3.2 使用Nslookup工具"></a>2.3.2 使用Nslookup工具</h4><p>Nslookup是由微软发布的用于对DNS服务器进行检测和排错的命令工具。该工具可以用来查询DNS记录，验证域名解析是否正常。在发生网络故障的时候，该工具还可以用来诊断网络问题。通过实施域名解析，可以获取对应服务器的IP地址。其中，该工具的语法格式如下：</p><blockquote><p>nslookup domain</p></blockquote><p>其中，参数domain用来指定查询的域名。</p><p>使用Nslookup对域名 <a href="http://www.baidu.com" target="_blank" rel="noopener">www.baidu.com</a> 进行解析。执行命令如下：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># nslookup www.baidu.com   </span></span><br><span class="line">Server:         192.168.48.2</span><br><span class="line">Address:        192.168.48.2<span class="comment">#53</span></span><br><span class="line"></span><br><span class="line">Non-authoritative answer:</span><br><span class="line">www.baidu.com   canonical name = www.a.shifen.com.</span><br><span class="line">Name:   www.a.shifen.com</span><br><span class="line">Address: 110.242.68.4</span><br><span class="line">Name:   www.a.shifen.com</span><br><span class="line">Address: 110.242.68.3</span><br></pre></td></tr></table></figure><p>从输出的信息可以看到，成功解析了域名 <a href="http://www.baidu.com" target="_blank" rel="noopener">www.baidu.com</a> 。从显示的结果可以看到，该域名对应的地址为110.242.68.4和110.242.68.3。而且还可以看到，域名 <a href="http://www.baidu.com" target="_blank" rel="noopener">www.baidu.com</a> 的别名(canonical name)为 <a href="http://www.a.shifen.com" target="_blank" rel="noopener">www.a.shifen.com</a> 。</p><p>使用Nslookup实施域名查询时，默认查询的是A记录。用户还可以在交互模式，使用set type=value指定查询的域名记录值。其中，指定的域名记录值可以是A、NS、MX、CNAME和PTR等。例如，使用Nslookup获取域名baidu.com的NS名字服务器记录，如下：</p><p>（1）启动Nslookup工具进入交互模式。执行命令如下：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># nslookup</span></span><br><span class="line">&gt;</span><br></pre></td></tr></table></figure><p>看到命令行提示符显示为&gt;，则表示成功进入了Nslookup的交互模式。<br>（2）设置查询的类型为NS记录。执行命令如下：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&gt; <span class="built_in">set</span> <span class="built_in">type</span>=ns</span><br></pre></td></tr></table></figure><p>（3）输入要查询的域名。执行命令如下：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">&gt; baidu.com</span><br><span class="line">Server:         192.168.48.2</span><br><span class="line">Address:        192.168.48.2<span class="comment">#53</span></span><br><span class="line"></span><br><span class="line">Non-authoritative answer:</span><br><span class="line">baidu.com       nameserver = ns2.baidu.com.</span><br><span class="line">baidu.com       nameserver = dns.baidu.com.</span><br><span class="line">baidu.com       nameserver = ns7.baidu.com.</span><br><span class="line">baidu.com       nameserver = ns4.baidu.com.</span><br><span class="line">baidu.com       nameserver = ns3.baidu.com.</span><br><span class="line"></span><br><span class="line">Authoritative answers can be found from:</span><br></pre></td></tr></table></figure><p>从输出的信息可以看到域名baidu.com的所有NS服务器，如dns.baidu.com和ns2.baidu.com等。如果用户不查询其他记录，可使用exit命令退出交互模式。</p><h4 id="2-3-3-使用Ping命令"><a href="#2-3-3-使用Ping命令" class="headerlink" title="2.3.3 使用Ping命令"></a>2.3.3 使用Ping命令</h4><p>Ping命令可以用来检查网络是否连通，可以很好地帮助用户分析和判断网络故障。对于一个域名，通常可以指定多个IP地址。所以，当用户借助一些工具查询域名信息时，将获取多个地址信息。此时，用户无法确定目标服务器使用的是哪个地址。用户通过使用Ping命令，则可以判断出目前正在使用的IP地址，进而确定该目标主机。其中，Ping命令的语法格式如下：</p><blockquote><p>ping -c [count] [target]</p></blockquote><p>以上语法中，选项-c用来指定发送的Ping包数；参数[target]用来指定目标主机的地址，其中，该目标主机地址可以是主机名、IP地址或域名。在Windows系统中，Ping命令仅发送并响应4个包就停止Ping。在Linux系统中，默认将会一直执行Ping命令，需要用户按Ctrl+C组合键停止Ping。</p><p>使用Ping命令探测域名 <a href="http://www.baidu.com" target="_blank" rel="noopener">www.baidu.com</a> 的IP地址，并指定仅发送4个探测包。执行命令如下：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># ping -c 4 www.baidu.com                                      1 ⨯</span></span><br><span class="line">PING www.a.shifen.com (110.242.68.4) 56(84) bytes of data.</span><br><span class="line">64 bytes from 110.242.68.4 (110.242.68.4): icmp_seq=1 ttl=128 time=14.0 ms</span><br><span class="line">64 bytes from 110.242.68.4 (110.242.68.4): icmp_seq=2 ttl=128 time=16.1 ms</span><br><span class="line">64 bytes from 110.242.68.4 (110.242.68.4): icmp_seq=3 ttl=128 time=33.0 ms</span><br><span class="line">64 bytes from 110.242.68.4 (110.242.68.4): icmp_seq=4 ttl=128 time=14.7 ms</span><br><span class="line"></span><br><span class="line">--- www.a.shifen.com ping statistics ---</span><br><span class="line">4 packets transmitted, 4 received, 0% packet loss, time 3011ms</span><br><span class="line">rtt min/avg/max/mdev = 14.005/19.459/33.021/7.867 ms</span><br></pre></td></tr></table></figure><p>从以上输出的信息可以看到，成功收到了目标主机响应的包。从响应的包信息中可以看到，目标主机使用的IP地址为110.242.68.4。</p><h2 id="三、扫描端口"><a href="#三、扫描端口" class="headerlink" title="三、扫描端口"></a>三、扫描端口</h2><p>通过扫描端口，可以发现目标主机中运行的程序。然后，再对这些程序进行信息收集，以获取其漏洞信息，并实施渗透测试。本节将介绍端口的概念及实施端口扫描的方法。</p><h3 id="3-1-端口简介"><a href="#3-1-端口简介" class="headerlink" title="3.1 端口简介"></a>3.1 端口简介</h3><p>在计算机中，“端口”的英文是Port。在网络技术中，端口有好几种意思。这里所指的端口不是物理意义上的端口，而是特指TCP/IP协议中的端口。它是逻辑意义上的端口。在TCP/IP协议中，最常用的协议是TCP和UDP协议。由于TCP和UDP两个协议是独立的，因此各自的端口号也相互独立。例如，TCP有235端口，UDP也可以有235端口，两者并不冲突。下面将介绍端口的作用及常用的端口。</p><ol><li><p>端口的作用<br>用户都知道一台主机对应一个IP地址，可以提供多个服务，如Web服务和FTP服务等。如果只有一个IP，无法区分不同的网络服务，所以使用“IP+端口号”来区分不同的服务。</p></li><li><p>端口的定义<br>端口号是标识主机内唯一的一个进程，“IP+端口号”就可以标识网络中的唯一进程。在网络开发的Socket编程中，IP+端口号就是套接字。端口号是由16位二进制数字编号，范围是0～65535。但是，这些端口并不是可以随便使用的，一些端口已经被占用。例如，Web服务器的端口为80，FTP服务的端口为21等。所以，端口被进行了分类，并规定了用户可以使用的端口范围。</p></li><li><p>端口的分类<br>端口的分类方法很多，这里将按照是服务端使用还是客户端使用进行分类。其中，服务端使用的端口号又可以分为预留端口号和注册端口号。如下：</p><p>·预留端口号：该类端口的取值范围为0～1023。其中，这些端口在用户编程的时候不能使用，是一些程序固定使用的。只有超级用户权限的应用才允许被分配一个预留端口号。例如，WWW服务默认端口为80，FTP服务默认端口为21等。不过，用户也可以为这些网络服务指定其他端口号。但是有些系统协议使用固定的端口号，是不能被改变的。例如，139端口专门用于NetBIOS与TCP/IP之间的通信，不能被手动改变。</p><p>·注册端口号：该类端口的范围为1024～49151，就是用户平时编写服务器使用的端口号范围。这些端口在没有被服务器资源占用的时候，也可以供用户端动态选用。<br>客户端使用的端口号又叫临时端口号，取值范围为49152～65535。其中，这部分是客户端进程运行时动态选择的范围。</p></li><li><p>常用端口<br>在前面提到，一些网络服务的端口都是固定的，所以将列出一些常见的TCP/IP端口，如下表所示。</p></li></ol><table><thead><tr><th align="left">端口号码 / 层</th><th align="left">名称</th><th align="left">注释</th></tr></thead><tbody><tr><td align="left">1</td><td align="left">tcpmux</td><td align="left">TCP 端口服务多路复用</td></tr><tr><td align="left">5</td><td align="left">rje</td><td align="left">远程作业入口</td></tr><tr><td align="left">7</td><td align="left">echo</td><td align="left">Echo 服务</td></tr><tr><td align="left">9</td><td align="left">discard</td><td align="left">用于连接测试的空服务</td></tr><tr><td align="left">11</td><td align="left">systat</td><td align="left">用于列举连接了的端口的系统状态</td></tr><tr><td align="left">13</td><td align="left">daytime</td><td align="left">给请求主机发送日期和时间</td></tr><tr><td align="left">17</td><td align="left">qotd</td><td align="left">给连接了的主机发送每日格言</td></tr><tr><td align="left">18</td><td align="left">msp</td><td align="left">消息发送协议</td></tr><tr><td align="left">19</td><td align="left">chargen</td><td align="left">字符生成服务；发送无止境的字符流</td></tr><tr><td align="left">20</td><td align="left">ftp-data</td><td align="left">FTP 数据端口</td></tr><tr><td align="left">21</td><td align="left">ftp</td><td align="left">文件传输协议（FTP）端口；有时被文件服务协议（FSP）使用</td></tr><tr><td align="left">22</td><td align="left">ssh</td><td align="left">安全 Shell（SSH）服务</td></tr><tr><td align="left">23</td><td align="left">telnet</td><td align="left">Telnet 服务</td></tr><tr><td align="left">25</td><td align="left">smtp</td><td align="left">简单邮件传输协议（SMTP）</td></tr><tr><td align="left">37</td><td align="left">time</td><td align="left">时间协议</td></tr><tr><td align="left">39</td><td align="left">rlp</td><td align="left">资源定位协议</td></tr><tr><td align="left">42</td><td align="left">nameserver</td><td align="left">互联网名称服务</td></tr><tr><td align="left">43</td><td align="left">nicname</td><td align="left">WHOIS 目录服务</td></tr><tr><td align="left">49</td><td align="left">tacacs</td><td align="left">用于基于 TCP/IP 验证和访问的终端访问控制器访问控制系统</td></tr><tr><td align="left">50</td><td align="left">re-mail-ck</td><td align="left">远程邮件检查协议</td></tr><tr><td align="left">53</td><td align="left">domain</td><td align="left">域名服务（如 BIND）</td></tr><tr><td align="left">63</td><td align="left">whois++</td><td align="left">WHOIS++，被扩展了的 WHOIS 服务</td></tr><tr><td align="left">67</td><td align="left">bootps</td><td align="left">引导协议（BOOTP）服务；还被动态主机配置协议（DHCP）服务使用</td></tr><tr><td align="left">68</td><td align="left">bootpc</td><td align="left">Bootstrap（BOOTP）客户；还被动态主机配置协议（DHCP）客户使用</td></tr><tr><td align="left">69</td><td align="left">tftp</td><td align="left">小文件传输协议（TFTP）</td></tr><tr><td align="left">70</td><td align="left">gopher</td><td align="left">Gopher 互联网文档搜寻和检索</td></tr><tr><td align="left">71</td><td align="left">netrjs-1</td><td align="left">远程作业服务</td></tr><tr><td align="left">72</td><td align="left">netrjs-2</td><td align="left">远程作业服务</td></tr><tr><td align="left">73</td><td align="left">netrjs-3</td><td align="left">远程作业服务</td></tr><tr><td align="left">73</td><td align="left">netrjs-4</td><td align="left">远程作业服务</td></tr><tr><td align="left">79</td><td align="left">finger</td><td align="left">用于用户联系信息的 Finger 服务</td></tr><tr><td align="left">80</td><td align="left">http</td><td align="left">用于万维网（WWW）服务的超文本传输协议（HTTP）</td></tr><tr><td align="left">88</td><td align="left">kerberos</td><td align="left">Kerberos 网络验证系统</td></tr><tr><td align="left">95</td><td align="left">supdup</td><td align="left">Telnet 协议扩展</td></tr><tr><td align="left">101</td><td align="left">hostname</td><td align="left">SRI-NIC 机器上的主机名服务</td></tr><tr><td align="left">102</td><td align="left">iso-tsap</td><td align="left">ISO 开发环境（ISODE）网络应用</td></tr><tr><td align="left">105</td><td align="left">csnet-ns</td><td align="left">邮箱名称服务器；也被 CSO 名称服务器使用</td></tr><tr><td align="left">107</td><td align="left">rtelnet</td><td align="left">远程 Telnet</td></tr><tr><td align="left">109</td><td align="left">pop2</td><td align="left">邮局协议版本2</td></tr><tr><td align="left">110</td><td align="left">pop3</td><td align="left">邮局协议版本3</td></tr><tr><td align="left">111</td><td align="left">sunrpc</td><td align="left">用于远程命令执行的远程过程调用（RPC）协议，被网络文件系统（NFS）使用</td></tr><tr><td align="left">113</td><td align="left">auth</td><td align="left">验证和身份识别协议</td></tr><tr><td align="left">115</td><td align="left">sftp</td><td align="left">安全文件传输协议（SFTP）服务</td></tr><tr><td align="left">117</td><td align="left">uucp-path</td><td align="left">Unix 到 Unix 复制协议（UUCP）路径服务</td></tr><tr><td align="left">119</td><td align="left">nntp</td><td align="left">用于 USENET 讨论系统的网络新闻传输协议（NNTP）</td></tr><tr><td align="left">123</td><td align="left">ntp</td><td align="left">网络时间协议（NTP）</td></tr><tr><td align="left">137</td><td align="left">netbios-ns</td><td align="left">在红帽企业 Linux 中被 Samba 使用的 NETBIOS 名称服务</td></tr><tr><td align="left">138</td><td align="left">netbios-dgm</td><td align="left">在红帽企业 Linux 中被 Samba 使用的 NETBIOS 数据报服务</td></tr><tr><td align="left">139</td><td align="left">netbios-ssn</td><td align="left">在红帽企业 Linux 中被 Samba 使用的NET BIOS 会话服务</td></tr><tr><td align="left">143</td><td align="left">imap</td><td align="left">互联网消息存取协议（IMAP）</td></tr><tr><td align="left">161</td><td align="left">snmp</td><td align="left">简单网络管理协议（SNMP）</td></tr><tr><td align="left">162</td><td align="left">snmptrap</td><td align="left">SNMP 的陷阱</td></tr><tr><td align="left">163</td><td align="left">cmip-man</td><td align="left">通用管理信息协议（CMIP）</td></tr><tr><td align="left">164</td><td align="left">cmip-agent</td><td align="left">通用管理信息协议（CMIP）</td></tr><tr><td align="left">174</td><td align="left">mailq</td><td align="left">MAILQ</td></tr><tr><td align="left">177</td><td align="left">xdmcp</td><td align="left">X 显示管理器控制协议</td></tr><tr><td align="left">178</td><td align="left">nextstep</td><td align="left">NeXTStep 窗口服务器</td></tr><tr><td align="left">179</td><td align="left">bgp</td><td align="left">边界网络协议</td></tr><tr><td align="left">191</td><td align="left">prospero</td><td align="left">Cliffod Neuman 的 Prospero 服务</td></tr><tr><td align="left">194</td><td align="left">irc</td><td align="left">互联网中继聊天（IRC）</td></tr><tr><td align="left">199</td><td align="left">smux</td><td align="left">SNMP UNIX 多路复用</td></tr><tr><td align="left">201</td><td align="left">at-rtmp</td><td align="left">AppleTalk 选路</td></tr><tr><td align="left">202</td><td align="left">at-nbp</td><td align="left">AppleTalk 名称绑定</td></tr><tr><td align="left">204</td><td align="left">at-echo</td><td align="left">AppleTalk echo 服务</td></tr><tr><td align="left">206</td><td align="left">at-zis</td><td align="left">AppleTalk 区块信息</td></tr><tr><td align="left">209</td><td align="left">qmtp</td><td align="left">快速邮件传输协议（QMTP）</td></tr><tr><td align="left">210</td><td align="left">z39.50</td><td align="left">NISO Z39.50 数据库</td></tr><tr><td align="left">213</td><td align="left">ipx</td><td align="left">互联网络分组交换协议（IPX），被 Novell Netware 环境常用的数据报协议</td></tr><tr><td align="left">220</td><td align="left">imap3</td><td align="left">互联网消息存取协议版本3</td></tr><tr><td align="left">245</td><td align="left">link</td><td align="left">LINK</td></tr><tr><td align="left">347</td><td align="left">fatserv</td><td align="left">Fatmen 服务器</td></tr><tr><td align="left">363</td><td align="left">rsvp_tunnel</td><td align="left">RSVP 隧道</td></tr><tr><td align="left">369</td><td align="left">rpc2portmap</td><td align="left">Coda 文件系统端口映射器</td></tr><tr><td align="left">370</td><td align="left">codaauth2</td><td align="left">Coda 文件系统验证服务</td></tr><tr><td align="left">372</td><td align="left">ulistproc</td><td align="left">UNIX Listserv</td></tr><tr><td align="left">389</td><td align="left">ldap</td><td align="left">轻型目录存取协议（LDAP）</td></tr><tr><td align="left">427</td><td align="left">svrloc</td><td align="left">服务位置协议（SLP）</td></tr><tr><td align="left">434</td><td align="left">mobileip-agent</td><td align="left">可移互联网协议（IP）代理</td></tr><tr><td align="left">435</td><td align="left">mobilip-mn</td><td align="left">可移互联网协议（IP）管理器</td></tr><tr><td align="left">443</td><td align="left">https</td><td align="left">安全超文本传输协议（HTTP）</td></tr><tr><td align="left">444</td><td align="left">snpp</td><td align="left">小型网络分页协议</td></tr><tr><td align="left">445</td><td align="left">microsoft-ds</td><td align="left">通过 TCP/IP 的服务器消息块（SMB）</td></tr><tr><td align="left">464</td><td align="left">kpasswd</td><td align="left">Kerberos 口令和钥匙改换服务</td></tr><tr><td align="left">468</td><td align="left">photuris</td><td align="left">Photuris 会话钥匙管理协议</td></tr><tr><td align="left">487</td><td align="left">saft</td><td align="left">简单不对称文件传输（SAFT）协议</td></tr><tr><td align="left">488</td><td align="left">gss-http</td><td align="left">用于 HTTP 的通用安全服务（GSS）</td></tr><tr><td align="left">496</td><td align="left">pim-rp-disc</td><td align="left">用于协议独立的多址传播（PIM）服务的会合点发现（RP-DISC）</td></tr><tr><td align="left">500</td><td align="left">isakmp</td><td align="left">互联网安全关联和钥匙管理协议（ISAKMP）</td></tr><tr><td align="left">535</td><td align="left">iiop</td><td align="left">互联网内部对象请求代理协议（IIOP）</td></tr><tr><td align="left">538</td><td align="left">gdomap</td><td align="left">GNUstep 分布式对象映射器（GDOMAP）</td></tr><tr><td align="left">546</td><td align="left">dhcpv6-client</td><td align="left">动态主机配置协议（DHCP）版本6客户</td></tr><tr><td align="left">547</td><td align="left">dhcpv6-server</td><td align="left">动态主机配置协议（DHCP）版本6服务</td></tr><tr><td align="left">554</td><td align="left">rtsp</td><td align="left">实时流播协议（RTSP）</td></tr><tr><td align="left">563</td><td align="left">nntps</td><td align="left">通过安全套接字层的网络新闻传输协议（NNTPS）</td></tr><tr><td align="left">565</td><td align="left">whoami</td><td align="left">whoami</td></tr><tr><td align="left">587</td><td align="left">submission</td><td align="left">邮件消息提交代理（MSA）</td></tr><tr><td align="left">610</td><td align="left">npmp-local</td><td align="left">网络外设管理协议（NPMP）本地 / 分布式排队系统（DQS）</td></tr><tr><td align="left">611</td><td align="left">npmp-gui</td><td align="left">网络外设管理协议（NPMP）GUI / 分布式排队系统（DQS）</td></tr><tr><td align="left">612</td><td align="left">hmmp-ind</td><td align="left">HMMP 指示 / DQS</td></tr><tr><td align="left">631</td><td align="left">ipp</td><td align="left">互联网打印协议（IPP）</td></tr><tr><td align="left">636</td><td align="left">ldaps</td><td align="left">通过安全套接字层的轻型目录访问协议（LDAPS）</td></tr><tr><td align="left">674</td><td align="left">acap</td><td align="left">应用程序配置存取协议（ACAP）</td></tr><tr><td align="left">694</td><td align="left">ha-cluster</td><td align="left">用于带有高可用性的群集的心跳服务</td></tr><tr><td align="left">749</td><td align="left">kerberos-adm</td><td align="left">Kerberos 版本5（v5）的“kadmin”数据库管理</td></tr><tr><td align="left">750</td><td align="left">kerberos-iv</td><td align="left">Kerberos 版本4（v4）服务</td></tr><tr><td align="left">765</td><td align="left">webster</td><td align="left">网络词典</td></tr><tr><td align="left">767</td><td align="left">phonebook</td><td align="left">网络电话簿</td></tr><tr><td align="left">873</td><td align="left">rsync</td><td align="left">rsync 文件传输服务</td></tr><tr><td align="left">992</td><td align="left">telnets</td><td align="left">通过安全套接字层的 Telnet（TelnetS）</td></tr><tr><td align="left">993</td><td align="left">imaps</td><td align="left">通过安全套接字层的互联网消息存取协议（IMAPS）</td></tr><tr><td align="left">994</td><td align="left">ircs</td><td align="left">通过安全套接字层的互联网中继聊天（IRCS）</td></tr><tr><td align="left">995</td><td align="left">pop3s</td><td align="left">通过安全套接字层的邮局协议版本3（POPS3）</td></tr></tbody></table><h3 id="3-2-实施端口扫描"><a href="#3-2-实施端口扫描" class="headerlink" title="3.2 实施端口扫描"></a>3.2 实施端口扫描</h3><p>当用户对端口的概念了解清楚后，就可以实施端口扫描了。下面将介绍使用Nmap和DMitry工具实施端口扫描。</p><h4 id="3-2-1-使用Nmap工具"><a href="#3-2-1-使用Nmap工具" class="headerlink" title="3.2.1 使用Nmap工具"></a>3.2.1 使用Nmap工具</h4><p>使用Nmap工具实施端口扫描，可以识别6种端口状态，分别是open（开放的）、closed（关闭的）、filtered（被过滤的）、unfiltered（未被过滤的）、open/filtered（开放或者被过滤的）和closed/filtered（关闭或者被过滤的）。如果要使用Nmap工具实施端口扫描，则需要了解每个端口状态的含义。下面将分别介绍这6种端口状态的具体含义。</p><p>·open（开放的）：应用程序正在该端口接收TCP连接或者UDP报文。安全意识强的人们知道，每个开放的端口都是攻击的入口。攻击者或者入侵测试者想要发现开放的端口，而管理员则试图关闭它们或者用防火墙保护它们以免妨碍合法用户使用。非安全扫描可能对开放的端口也感兴趣，因为它们显示了网络上哪些服务可供使用。</p><p>·closed（关闭的）：关闭的端口对于Nmap也是可访问的（它接收Nmap的探测报文并作出响应），但没有应用程序在其上监听。它们可以显示该IP地址（主机发现或者ping扫描）的主机正在运行，也对部分操作系统的探测有所帮助。因为关闭的端口是可访问的，也许过一会儿有一些端口又开放了。系统管理员可能会用防火墙封锁这样的端口。这样，它们就会被显示为被过滤的状态。</p><p>·filtered（被过滤的）：由于包过滤阻止探测报文到达端口，Nmap无法确定该端口是否开放。过滤可能来自专业的防火墙设备、路由器规则或者主机上的软件防火墙。有时候它们响应ICMP错误消息，如类型3代码13（无法到达目标:通信被管理员禁止），但更普遍的是过滤器只是丢弃探测帧，不做任何响应。Nmap会重试若干次，检测探测包是否是由于网络阻塞而丢弃的。这会导致扫描速度明显变慢。</p><p>·unfiltered（未被过滤的）：未被过滤状态意味着端口可访问，但Nmap不能确定它是开放还是关闭。用户只有通过映射防火墙规则集的ACK扫描，才会把端口分类到这种状态。使用其他类型的扫描（如窗口扫描、SYN扫描或者FIN扫描）来扫描未被过滤的端口，可以帮助确定端口是否开放。</p><p>·open/filtered（开放或者被过滤的）：当无法确定端口是开放还是被过滤的时，Nmap就把该端口划分成这种状态。开放的端口不响应就是这种情况。没有响应也可能意味着报文过滤器丢弃了该探测报文及引起的任何响应报文。因此，Nmap无法确定该端口是开放的还是被过滤的。UDP、IP协议、FIN、Null和Xmas扫描可能把端口归入此类。</p><p>·closed/filtered（关闭或者被过滤的）：该状态用于Nmap不能确定端口是关闭的还是被过滤的。它只会出现在IPID Idle扫描中。</p><p>使用Nmap实施端口扫描的语法格式如下：</p><blockquote><p>nmap -p<range>[target]</range></p></blockquote><p>以上语法中，选项-p用来指定扫描的端口。其中，指定的端口可以是单个端口、多个端口或端口范围。当指定多个扫描端口时，端口之间使用逗号分隔。默认情况下，Nmap扫描的端口范围为1～1000。</p><p>对目标主机192.168.10.54实施端口扫描。执行命令如下：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># nmap 192.168.10.54      </span></span><br><span class="line">Starting Nmap 7.91 ( https://nmap.org ) at 2020-12-11 17:47 CST</span><br><span class="line">Nmap scan report <span class="keyword">for</span> localhost (192.168.10.54)</span><br><span class="line">Host is up (0.016s latency).</span><br><span class="line">Not shown: 991 filtered ports</span><br><span class="line">PORT     STATE SERVICE</span><br><span class="line">21/tcp   open  ftp</span><br><span class="line">80/tcp   open  http</span><br><span class="line">111/tcp  open  rpcbind</span><br><span class="line">139/tcp  open  netbios-ssn</span><br><span class="line">445/tcp  open  microsoft-ds</span><br><span class="line">3000/tcp open  ppp</span><br><span class="line">3690/tcp open  svn</span><br><span class="line">8080/tcp open  http-proxy</span><br><span class="line">9100/tcp open  jetdirect</span><br><span class="line"></span><br><span class="line">Nmap <span class="keyword">done</span>: 1 IP address (1 host up) scanned <span class="keyword">in</span> 7.49 seconds</span><br></pre></td></tr></table></figure><p>从输出的信息可以看到，Nmap工具默认扫描了1000个端口。其中，991个端口是关闭的，9个端口是开放的。例如，开放的端口有21、80和445等。</p><p>指定端口范围为1～50，对目标主机实施端口扫描。执行命令如下：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># nmap -p 1-50 192.168.10.54 </span></span><br><span class="line">Starting Nmap 7.91 ( https://nmap.org ) at 2020-12-11 17:49 CST</span><br><span class="line">Nmap scan report <span class="keyword">for</span> localhost (192.168.10.54)</span><br><span class="line">Host is up (0.0082s latency).</span><br><span class="line">Not shown: 49 filtered ports</span><br><span class="line">PORT   STATE SERVICE</span><br><span class="line">21/tcp open  ftp</span><br><span class="line"></span><br><span class="line">Nmap <span class="keyword">done</span>: 1 IP address (1 host up) scanned <span class="keyword">in</span> 1.65 seconds</span><br></pre></td></tr></table></figure><p>从输出的结果可以看到，扫描了端口范围为1～50之间的端口。其中，49个端口是关闭的；1个端口是开放的。</p><p>指定扫描目标主机的21和23端口。执行命令如下：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># nmap -p 21,23 192.168.10.54</span></span><br><span class="line">Starting Nmap 7.91 ( https://nmap.org ) at 2020-12-11 17:51 CST</span><br><span class="line">Nmap scan report <span class="keyword">for</span> localhost (192.168.10.54)</span><br><span class="line">Host is up (0.0050s latency).</span><br><span class="line"></span><br><span class="line">PORT   STATE    SERVICE</span><br><span class="line">21/tcp open     ftp</span><br><span class="line">23/tcp filtered telnet</span><br><span class="line"></span><br><span class="line">Nmap <span class="keyword">done</span>: 1 IP address (1 host up) scanned <span class="keyword">in</span> 1.41 seconds</span><br></pre></td></tr></table></figure><p>从输出的信息可以看到，在目标主机上开放了21号端口；23号端口是关闭的。</p><h4 id="3-2-2-使用DMitry工具"><a href="#3-2-2-使用DMitry工具" class="headerlink" title="3.2.2 使用DMitry工具"></a>3.2.2 使用DMitry工具</h4><p>DMitry工具提供了一个-p选项，可以实施端口扫描。其中，用来实施端口扫描的语法格式如下：</p><blockquote><p>dmitry -p [host]</p></blockquote><p>使用DMitry扫描目标主机192.168.29.136上开放的端口。执行命令如下：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># dmitry -p 192.168.10.54</span></span><br><span class="line">Deepmagic Information Gathering Tool</span><br><span class="line"><span class="string">"There be some deep magic going on"</span></span><br><span class="line"></span><br><span class="line">HostIP:192.168.10.54</span><br><span class="line">HostName:localhost</span><br><span class="line"></span><br><span class="line">Gathered TCP Port information <span class="keyword">for</span> 192.168.10.54</span><br><span class="line">---------------------------------</span><br><span class="line"></span><br><span class="line"> Port           State</span><br><span class="line"></span><br><span class="line">21/tcp          open</span><br><span class="line">80/tcp          open</span><br><span class="line">111/tcp         open</span><br><span class="line">139/tcp         open</span><br><span class="line"></span><br><span class="line">Portscan Finished: Scanned 150 ports, 0 ports were <span class="keyword">in</span> state closed</span><br><span class="line"></span><br><span class="line">All scans completed, exiting</span><br></pre></td></tr></table></figure><p>从输出的信息可以看到目标主机上开放的所有端口。从输出的倒数第二行信息可以看到，共扫描了150个端口，0个端口是关闭的。</p><h2 id="四、识别操作系统"><a href="#四、识别操作系统" class="headerlink" title="四、识别操作系统"></a>四、识别操作系统</h2><p>通过识别操作系统，可以确定目标主机的系统类型。这样，渗透测试者可以有针对性地对目标系统的程序实施漏洞探测，以节省不必要浪费的时间。本节将介绍识别操作系统的方法。</p><h3 id="4-1-基于TTL识别"><a href="#4-1-基于TTL识别" class="headerlink" title="4.1 基于TTL识别"></a>4.1 基于TTL识别</h3><p>TTL（Time To Live，生存时间），该字段指定IP包被路由器丢弃之前允许通过的最大网段数量。其中，不同操作系统类型响应的TTL值不同。所以，用户可以使用Ping命令进行系统识别。为了使用户能够快速地确定一个目标系统的类型，这里将给出各个操作系统的初始TTL值列表，如下表所示。</p><table><thead><tr><th>操作系统</th><th>TTL值</th></tr></thead><tbody><tr><td>UNIX及类UNIX操作系统</td><td>255</td></tr><tr><td>Compaq Tru64 5.0</td><td>64</td></tr><tr><td>Windows XP-32bit</td><td>128</td></tr><tr><td>Linux Kernel 2.2.x &amp; 2.4.x</td><td>64</td></tr><tr><td>FreeBSD 4.1, 4.0, 3.4、Sun Solaris 2.5.1, 2.6, 2.7, 2.8、OpenBSD 2.6, 2.7/ NetBSD、IIP UX 10.20</td><td>255</td></tr><tr><td>WIndows 95/98/98SE、Windows ME</td><td>32</td></tr><tr><td>Windows NT4 WRKS、Windows NT4 Server、Windows 2000、Windows XP/7/8/10</td><td>128</td></tr></tbody></table><p>使用Ping测试目标主机192.168.29.131的操作系统类型。其中，该目标主机的操作系统类型为Kali Linux。执行命令如下：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># ping -c 4 192.168.10.54</span></span><br><span class="line">PING 192.168.10.54 (192.168.10.54) 56(84) bytes of data.</span><br><span class="line">64 bytes from 192.168.10.54: icmp_seq=1 ttl=64 time=0.149 ms</span><br><span class="line">64 bytes from 192.168.10.54: icmp_seq=2 ttl=64 time=0.179 ms</span><br><span class="line">64 bytes from 192.168.10.54: icmp_seq=3 ttl=64 time=0.228 ms</span><br><span class="line">64 bytes from 192.168.10.54: icmp_seq=4 ttl=64 time=0.232 ms</span><br><span class="line"></span><br><span class="line">--- 192.168.10.54 ping statistics ---</span><br><span class="line">4 packets transmitted, 4 received, 0% packet loss, time 2999ms</span><br><span class="line">rtt min/avg/max/mdev = 0.149/0.197/0.232/0.034 ms</span><br></pre></td></tr></table></figure><p>从输出的信息可以看到，响应包中的TTL值为64。由此可以推断出，该主机是一个Linux操作系统。</p><p>使用Ping测试目标主机192.168.100.160的操作系统类型。其中，该目标主机的操作系统类型为Windows。执行命令如下：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># ping -c 4 192.168.100.160</span></span><br><span class="line">PING 192.168.100.160 (192.168.100.160) 56(84) bytes of data.</span><br><span class="line">64 bytes from 192.168.100.160: icmp_seq=1 ttl=128 time=2.72 ms</span><br><span class="line">64 bytes from 192.168.100.160: icmp_seq=2 ttl=128 time=2.66 ms</span><br><span class="line">64 bytes from 192.168.100.160: icmp_seq=3 ttl=128 time=5.81 ms</span><br><span class="line">64 bytes from 192.168.100.160: icmp_seq=4 ttl=128 time=2.17 ms</span><br><span class="line"></span><br><span class="line">--- 192.168.100.160 ping statistics ---</span><br><span class="line">4 packets transmitted, 4 received, 0% packet loss, time 3005ms</span><br><span class="line">rtt min/avg/max/mdev = 2.178/3.343/5.811/1.440 ms</span><br></pre></td></tr></table></figure><p>从输出的信息可以看到，该响应包中的TTL值为128。由此可以说明，这是一个Windows操作系统。</p><p><strong>提示：</strong>如果本地主机到目标经过的路由器太多，判断的结果可能不是很准确。</p><h3 id="4-2-使用NMAP识别"><a href="#4-2-使用NMAP识别" class="headerlink" title="4.2 使用NMAP识别"></a>4.2 使用NMAP识别</h3><p>由于TTL只是一种模糊判断，所以得出的结果不一定准确。NMAP工具提供了可以探测操作系统的功能。所以，下面将介绍使用NMAP识别操作系统类型。<br>使用NMAP识别操作系统的语法格式如下：</p><blockquote><p>nmap -O [target]</p></blockquote><p>使用NMAP探测目标主机192.168.100.160的操作系统类型。执行命令如下：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># nmap -O 192.168.100.160</span></span><br><span class="line">Starting Nmap 7.91 ( https://nmap.org ) at 2020-12-11 18:25 CST</span><br><span class="line">Nmap scan report <span class="keyword">for</span> localhost (192.168.100.160)</span><br><span class="line">Host is up (0.60s latency).</span><br><span class="line">Not shown: 990 closed ports</span><br><span class="line">PORT     STATE    SERVICE</span><br><span class="line">135/tcp  open     msrpc</span><br><span class="line">139/tcp  open     netbios-ssn</span><br><span class="line">389/tcp  open     ldap</span><br><span class="line">443/tcp  open     https</span><br><span class="line">445/tcp  open     microsoft-ds</span><br><span class="line">514/tcp  filtered shell</span><br><span class="line">902/tcp  open     iss-realsecure</span><br><span class="line">912/tcp  open     apex-mesh</span><br><span class="line">4000/tcp open     remoteanything</span><br><span class="line">5357/tcp open     wsdapi</span><br><span class="line">Device <span class="built_in">type</span>: general purpose                           <span class="comment">#设备类型</span></span><br><span class="line">Running: Microsoft Windows XP|7|2012                   <span class="comment">#正在运行的系统</span></span><br><span class="line">OS CPE: cpe:/o:microsoft:windows_xp::sp3 cpe:/o:microsoft:windows_7 cpe:/o:microsoft:windows_server_2012    <span class="comment">#操作系统CPE</span></span><br><span class="line">OS details: Microsoft Windows XP SP3, Microsoft Windows XP SP3 or Windows 7 or Windows Server 2012          <span class="comment">#操作系统详细信息</span></span><br><span class="line">Network Distance: 1 hop                                <span class="comment">#网络距离</span></span><br><span class="line">OS detection performed. Please report any incorrect results at https://nmap.org/submit/ .</span><br><span class="line">Nmap <span class="keyword">done</span>: 1 IP address (1 host up) scanned <span class="keyword">in</span> 126.04 seconds</span><br></pre></td></tr></table></figure><p>从输出的信息可以看到，识别出目标主机的操作系统类型为Microsoft Windows 7/2008/8.1。虽然无法确定具体是哪个版本，但是显示了更接近的系统版本。</p><h2 id="五、识别服务"><a href="#五、识别服务" class="headerlink" title="五、识别服务"></a>五、识别服务</h2><p>识别服务主要是探测服务的版本信息。通常情况下，在一些旧版本中可能存在漏洞。如果存在漏洞，用户可以对该主机实施渗透，进而获取其他重要信息。</p><h3 id="5-1-使用Nmap工具"><a href="#5-1-使用Nmap工具" class="headerlink" title="5.1 使用Nmap工具"></a>5.1 使用Nmap工具</h3><p>在Nmap工具中提供了一个-sV选项，可以用来识别服务的版本。下面将介绍使用该选项对服务进行识别。其中，使用Nmap识别服务版本的语法格式如下：<br>nmap -sV [host]<br>以上语法中的选项-sV表示实施服务版本探测。</p><p>识别目标主机192.168.10.54上的所有开放服务及版本。执行命令如下：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># nmap -sV 192.168.10.54 </span></span><br><span class="line">Starting Nmap 7.91 ( https://nmap.org ) at 2020-12-11 18:33 CST</span><br><span class="line">Nmap scan report <span class="keyword">for</span> localhost (192.168.10.54)</span><br><span class="line">Host is up (0.0059s latency).</span><br><span class="line">Not shown: 991 filtered ports</span><br><span class="line">PORT     STATE SERVICE     VERSION</span><br><span class="line">21/tcp   open  ftp         vsftpd 3.0.2</span><br><span class="line">80/tcp   open  http        nginx 1.12.2</span><br><span class="line">111/tcp  open  rpcbind     2-4 (RPC <span class="comment">#100000)</span></span><br><span class="line">139/tcp  open  netbios-ssn Samba smbd 4.6.2</span><br><span class="line">445/tcp  open  netbios-ssn Samba smbd 4.6.2</span><br><span class="line">3000/tcp open  ppp?</span><br><span class="line">3690/tcp open  svnserve    Subversion</span><br><span class="line">8080/tcp open  http        Jetty 9.4.z-SNAPSHOT</span><br><span class="line">9100/tcp open  jetdirect?</span><br><span class="line">1 service unrecognized despite returning data. If you know the service/version, please submit the following fingerprint at https://nmap.org/cgi-bin/submit.cgi?new-service :</span><br><span class="line">SF-Port3000-TCP:V=7.91%I=7%D=12/11%Time=5FD34B20%P=x86_64-pc-linux-gnu%r(G</span><br></pre></td></tr></table></figure><p>从以上输出信息中可以看到识别出的服务相关信息。在输出的信息中包括4列，分别是PORT（端口）、STATE（状态）、SERVICE（服务）和VERSION（版本）。分析每列信息，可以获取对应服务的相关信息。例如，TCP端口21对应的服务为FTP，版本为vsftpd 3.0.2。从倒数第1行中还可以看到，目标主机的主机名为TEST-PC，操作系统类型为Linux。</p><h3 id="5-2-使用Amap工具"><a href="#5-2-使用Amap工具" class="headerlink" title="5.2 使用Amap工具"></a>5.2 使用Amap工具</h3><p>Amap是一款识别网络服务的渗透测试工具集，包括amap和amapcrap两个工具。其中，amap工具用来尝试识别非常用端口上运行的应用程序；amapcrap工具通过发送触发数据包，并在响应字符串列表中查找响应来识别基于非ASCII编码的应用程序。</p><h4 id="5-2-1-使用amapcrap工具"><a href="#5-2-1-使用amapcrap工具" class="headerlink" title="5.2.1 使用amapcrap工具"></a>5.2.1 使用amapcrap工具</h4><p>amapcrap工具可以将随机数据发送到UDP、TCP或SSL端口，来获取非法响应信息。其中，获取到的信息将写入到appdefs.trig和appdefs.resp文件，便于Amap下一步检测。其中，使用该工具识别服务信息的语法格式如下：</p><blockquote><p>amapcrap -n<connects>-m &lt;0ab&gt; [host] [port] -v</connects></p></blockquote><p>以上语法中的选项及含义如下：</p><blockquote><p>-n<connects>：设置最大连接数，默认为无限制。<br>-m 0ab：设置发送的伪随机数。其中，0表示空字节；a表示字母+空格；b表示二进制。<br>-v：详细模式。</connects></p></blockquote><p>使用amapcrap工具探测80端口的应用程序。执行命令如下：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># amapcrap -n 20 -m a 192.168.10.54 80 -v   </span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Starting AmapCrap on 192.168.10.54 port 80</span></span><br><span class="line"><span class="comment"># Writing a "+" for every 10 connect attempts</span></span><br><span class="line"><span class="comment"># </span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Put this line into appdefs.trig:</span></span><br><span class="line">PROTOCOL_NAME::tcp:0:<span class="string">"nayfvlkzryzoaafaza cgzjhmx jccqpcmvxyevnasaatfaqg tnxavhytr vfoys\r\n"</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Put this line into appdefs.resp:</span></span><br><span class="line">PROTOCOL_NAME::tcp::<span class="string">"HTTP/1.1 400 Bad Request\r\nServer: nginx/1.12.2\r\nDate: Fri, 11 Dec 2020 10:50:08 GMT\r\nContent-Type: text/html\r\nContent-Length: 173\r\nConnection: close\r\n\r\n&lt;html&gt;\r\n&lt;head&gt;&lt;title&gt;400 Bad Request&lt;/title&gt;&lt;/head&gt;\r\n&lt;body bgcolor="</span>white<span class="string">"&gt;\r\n&lt;center&gt;&lt;h1&gt;400 Bad Request&lt;/h1&gt;&lt;/center&gt;\r\n&lt;hr&gt;&lt;center&gt;nginx/1.12.2&lt;/center&gt;\r\n&lt;/body&gt;\r\n&lt;/html&gt;\r\n"</span></span><br></pre></td></tr></table></figure><p>从以上输出信息可以看到探测到的服务相关信息。从显示的结果中可以看到，分别将获取到的信息写入了appdefs.trig和appdefs.resp触发文件。当用户使用Amap工具识别服务时，将会使用这两个文件来获取信息。</p><h4 id="5-2-2-使用amap工具"><a href="#5-2-2-使用amap工具" class="headerlink" title="5.2.2 使用amap工具"></a>5.2.2 使用amap工具</h4><p>amap工具可以尝试识别一些运行在非正常端口上的应用程序。其中，使用该工具识别服务信息的语法格式如下：</p><blockquote><p>amap -bqv [host] [port]</p></blockquote><p>以上语法中的选项及含义如下：</p><blockquote><p>-b：显示接收的服务标识信息。<br>-q：不显示关闭端口。<br>-v：输出详细信息。</p></blockquote><p>使用amap工具对目标主机192.168.10.54上的80号端口服务实施扫描。执行命令如下：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># amap -bqv 192.168.10.54 80             </span></span><br><span class="line">Using trigger file /etc/amap/appdefs.trig ... loaded 30 triggers</span><br><span class="line">Using response file /etc/amap/appdefs.resp ... loaded 346 responses</span><br><span class="line">Using trigger file /etc/amap/appdefs.rpc ... loaded 450 triggers</span><br><span class="line"></span><br><span class="line">amap v5.4 (www.thc.org/thc-amap) started at 2020-12-11 18:52:12 - APPLICATION MAPPING mode</span><br><span class="line"></span><br><span class="line">Total amount of tasks to perform <span class="keyword">in</span> plain connect mode: 23</span><br><span class="line">Protocol on 192.168.10.54:80/tcp (by trigger ssl) matches http - banner: HTTP/1.1 400 Bad Request\r\nServer nginx/1.12.2\r\nDate Mon, 14 Dec 2020 095857 GMT\r\nContent-Type text/html\r\nContent-Length 173\r\nConnection close\r\n\r\n&lt;html&gt;\r\n&lt;head&gt;&lt;title&gt;400 Bad Request&lt;/title&gt;&lt;/head&gt;\r\n&lt;body bgcolor=<span class="string">"white"</span>&gt;\r\n&lt;center&gt;&lt;h1&gt;</span><br><span class="line">Protocol on 192.168.10.54:80/tcp (by trigger http) matches http-apache-2 - banner: HTTP/1.1 200 OK\r\nServer nginx/1.12.2\r\nDate Mon, 14 Dec 2020 095857 GMT\r\nContent-Type text/html\r\nContent-Length 3700\r\nLast-Modified Fri, 10 May 2019 080840 GMT\r\nConnection close\r\nETag <span class="string">"5cd53188-e74"</span>\r\nAccept-Ranges bytes\r\n\r\n&lt;!DOCTYPE ht</span><br><span class="line">Waiting <span class="keyword">for</span> timeout on 2 connections ...</span><br><span class="line"></span><br><span class="line">amap v5.4 finished at 2020-12-11 18:52:12</span><br></pre></td></tr></table></figure><p>从输出的信息中可以看到，80号端口匹配的服务有http或http-apache2。从显示的标识信息中可以看到，目标主机上运行的Web服务是Nginx，版本为1.12.2。在输出的前3行信息中，可以看到amap工具使用了两个触发器文件和一个响应文件。其中，文件名分别是appdefs.trig、appdefs.resp和appdefs.rpc。</p><h2 id="六、收集服务信息"><a href="#六、收集服务信息" class="headerlink" title="六、收集服务信息"></a>六、收集服务信息</h2><p>一些特殊服务可以提供额外的信息。例如，SMB服务可以提供文件系统结构；SNMP服务可以提供目标主机相关信息。</p><h3 id="6-1-SMB服务"><a href="#6-1-SMB服务" class="headerlink" title="6.1 SMB服务"></a>6.1 SMB服务</h3><p>SMB（Server Message Block，服务器信息块）是一种IBM协议，用于在计算机间共享文件、打印机、串口等。SMB协议可以工作在TCP/IP协议之上，也可以工作在其他网络协议（如NetBEUI）之上。通过获取SMB服务的共享文件夹信息，可以了解目标主机的文件系统结构。</p><p>smbclient是一个SMB服务的客户端工具，可以用来访问SMB服务中的共享文件。其中，smbclient工具的语法格式如下：</p><blockquote><p>smbclient -L<server ip>-U<username></username></server></p></blockquote><p>以上语法中的选项及含义如下：</p><blockquote><p>-L<server ip>：用来指定SMB服务器地址。<br>-U<username>：用来指定登录SMB服务的用户名。</username></server></p></blockquote><p>访问Linux系统中的SMB服务。执行命令如下：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">root@daxueba:～<span class="comment"># smbclient -L 192.168.10.54 -U root</span></span><br><span class="line">Enter WORKGROUP\root<span class="string">'s password:</span></span><br></pre></td></tr></table></figure><p>输入SMB服务用户登录的密码将显示如下所示的信息：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">    Sharename         Type      Comment</span><br><span class="line">    ---------        -----      -------</span><br><span class="line">    <span class="built_in">print</span>$                  Disk      Printer Drivers</span><br><span class="line">    share                   Disk      Share folder</span><br><span class="line">    IPC$                    IPC       IPC Service (Samba 4.9.2-Debian)</span><br><span class="line">Reconnecting with SMB1 <span class="keyword">for</span> workgroup listing.</span><br><span class="line">    Server               Comment</span><br><span class="line">    ---------                 -------</span><br><span class="line">    Workgroup            Master</span><br><span class="line">    ---------                 -------</span><br></pre></td></tr></table></figure><p>从以上输出信息可以看到目标SMB中共享的文件。其中，Sharename表示共享文件名，Type表示硬盘类型，Comment是共享文件的描述。从以上的Comment列可以看到共享的IPC服务版本为Samba 4.9.2-Debian。由此可以说明，该目标主机的操作系统类型为Linux，则该共享文件为Linux文件系统类型。</p><p>如果目标主机的操作系统是Windows，文件名列将显示共享文件夹的盘符。如下：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">root@daxueba:～<span class="comment"># smbclient -L 192.168.10.131 -U Test </span></span><br><span class="line">Enter WORKGROUP\Test<span class="string">'s password: </span></span><br><span class="line"><span class="string">    Sharename         Type      Comment</span></span><br><span class="line"><span class="string">    ---------         ----      -------</span></span><br><span class="line"><span class="string">    ADMIN$                        Disk      远程管理</span></span><br><span class="line"><span class="string">    C$                      Disk      默认共享</span></span><br><span class="line"><span class="string">    E$                      Disk      默认共享</span></span><br><span class="line"><span class="string">    IPC$                    IPC       远程 IPC</span></span><br><span class="line"><span class="string">    share                   Disk      </span></span><br><span class="line"><span class="string">    Users                   Disk      </span></span><br><span class="line"><span class="string">Reconnecting with SMB1 for workgroup listing.</span></span><br><span class="line"><span class="string">    Server               Comment</span></span><br><span class="line"><span class="string">    ---------            -------</span></span><br><span class="line"><span class="string">    Workgroup            Master</span></span><br><span class="line"><span class="string">    ---------            -------</span></span><br></pre></td></tr></table></figure><p>从以上输出结果的文件名中可以看到，默认共享的磁盘有C盘和E盘。只有在Windows系统中，文件夹才是以盘符形式来划分磁盘的。由此可以判断出，该共享文件夹为Windows系统类型。</p><h3 id="6-2-SNMP服务"><a href="#6-2-SNMP服务" class="headerlink" title="6.2 SNMP服务"></a>6.2 SNMP服务</h3><p>SNMP（Simple Network Management Protocol，简单网络管理协议）是由一组网络管理的标准组成，包含一个应用层协议和一组资源对象。该协议被网络管理系统所使用，用以监测网络设备上任何值得管理员所关注的情况。通过利用该服务，可以获取主机信息。下面将介绍使用snmpcheck工具获取主机信息。<br>snmpcheck工具可以用来枚举SNMP设备，以获取目标主机信息。其中，该工具的语法格式如下：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">snmp-check [target]</span><br></pre></td></tr></table></figure><p>使用snmp-check工具通过SNMP协议获取192.168.10.56主机信息。执行命令如下：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">root@daxueba:～<span class="comment"># snmp-check 192.168.10.56</span></span><br><span class="line">snmpcheck.rb v1.9 - SNMP enumerator</span><br><span class="line">Copyright (c) 2005-2015 by Matteo Cantoni (www.nothink.org)</span><br><span class="line">[+] Try to connect to 192.168.1.101:161 using SNMPv1 and community <span class="string">'public'</span></span><br></pre></td></tr></table></figure><p>从输出的信息可以看到，尝试连接目标主机192.168.10.56的161端口。当连接成功后，即可获取该主机的系统信息。由于输出的信息较多，这里将依次讲解每个部分。如下：</p><ol><li><p>获取系统信息，如主机名、操作系统类型及架构。结果如下：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"> [*] System information</span><br><span class="line"> -----------------------------------------------------------</span><br><span class="line"> Host IP address               : 192.168.10.56                                    <span class="comment">#目标主机的IP地址</span></span><br><span class="line"> Hostname                    : WIN-RKPKQFBLG6C                                    <span class="comment">#主机名</span></span><br><span class="line"> Description                 : Hardware: x86 Family 6 Model 42 Stepping 7 AT/AT </span><br><span class="line">COMPATIBLE - Software: Windows Version 6.1 (Build 7601 Multiprocessor Free)       <span class="comment">#描述信息</span></span><br><span class="line"> Contact                                  : -                                     <span class="comment">#联系</span></span><br><span class="line"> Location                           : -                                           <span class="comment">#位置</span></span><br><span class="line"></span><br><span class="line"> Uptime snmp                       : 01:51:45.01                                  <span class="comment">#SNMP服务运行的时间</span></span><br><span class="line"> Uptime system                      : 189 days, 3:31:29.10                        <span class="comment">#目标系统运行的时间</span></span><br><span class="line"> System date                        : 2019-12-5 17:13:10.7                         <span class="comment">#当前目标系统的时间</span></span><br><span class="line"> Domain                        : WORKGROUP                                        <span class="comment">#工作组</span></span><br></pre></td></tr></table></figure><p>从输出的信息中可以看到该系统的主机名为WIN-RKPKQFBLG6C、x86架构、Windows系统等信息。</p></li><li><p>获取用户账户信息。结果如下：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"> [*] User accounts</span><br><span class="line"> -------------------------------------------------------------------</span><br><span class="line">Administrator</span><br><span class="line"> Guest</span><br></pre></td></tr></table></figure><p>输出的信息显示了该系统中有两个用户，分别是Administrator和Guest。</p></li><li><p>获取网络信息，如TTL值、TCP段和数据元。结果如下：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"> [*] Network information</span><br><span class="line"> ------------------------------------------------------------------</span><br><span class="line">IP forwarding enabled         : no                                           <span class="comment">#是否启用IP转发</span></span><br><span class="line"> Default TTL                   : 128                                         <span class="comment">#默认TTL值</span></span><br><span class="line"> TCP segments received        : 19092                                        <span class="comment">#收到TCP段</span></span><br><span class="line"> TCP segments sent            : 5964                                         <span class="comment">#发送TCP段        </span></span><br><span class="line"> TCP segments retrans.        : 0                                            <span class="comment">#重发TCP段</span></span><br><span class="line"> Input datagrams               : 37878                                       <span class="comment">#输入数据元</span></span><br><span class="line"> Delivered datagrams          : 38486                                        <span class="comment">#传输的数据元</span></span><br><span class="line"> Output datagrams                : 16505                                     <span class="comment">#输出数据元</span></span><br></pre></td></tr></table></figure><p>以上信息显示了该目标系统中网络的相关信息，如默认TTL值、收到TCP段、发送TCP段及重发TCP段等。</p></li><li><p>获取网络接口信息，如接口状态、速率、IP地址和子网掩码等。结果如下：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"> [*] Network interfaces</span><br><span class="line"> ------------------------------------------------------------------、</span><br><span class="line">Interface                         : [ up ] Software Loopback Interface 1    <span class="comment">#接口描述信息</span></span><br><span class="line">  Id                              : 1                                       <span class="comment">#接口ID</span></span><br><span class="line">  Mac Address                    : :::::                                    <span class="comment">#MAC地址</span></span><br><span class="line">  Type                           : softwareLoopback                         <span class="comment">#接口类型</span></span><br><span class="line">  Speed                          : 1073 Mbps                                <span class="comment">#接口速度</span></span><br><span class="line">  MTU                             : 1500                                    <span class="comment">#最大传输单元</span></span><br><span class="line">  In octets                       : 0                                       <span class="comment">#8位字节输入</span></span><br><span class="line">  Out octets                      : 0                                       <span class="comment">#8位字节输出</span></span><br><span class="line">  Interface                       : [ up ] WAN Miniport (SSTP)</span><br><span class="line">  Id                                : 2</span><br><span class="line">  Mac Address                     : :::::</span><br><span class="line">  Type                            : unknown</span><br><span class="line">  Speed                           : 1073 Mbps</span><br><span class="line">  MTU                              : 4091</span><br><span class="line">  In octets                       : 0</span><br><span class="line">  Out octets                      : 0</span><br><span class="line">......</span><br><span class="line">Interface                         : [ up ] WAN Miniport (IPv6)-QoS Packet Scheduler-0000</span><br><span class="line">  Id                               : 32</span><br><span class="line">  Mac Address                     : cc:f5:20:52:41:53</span><br><span class="line">  Type                             : ethernet-csmacd</span><br><span class="line">  Speed                            : 1073 Mbps</span><br><span class="line">  MTU                              : 1500</span><br><span class="line">  In octets                       : 0</span><br><span class="line">  Out octets                      : 0</span><br></pre></td></tr></table></figure><p>以上信息中显示了loopback接口的相关信息。包括它的速率、IP地址、子网掩码和最大传输单元。</p></li><li><p>获取网络IP信息。结果如下：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">[*] Network IP:</span><br><span class="line"> Id                    IP Address            Netmask           Broadcast   </span><br><span class="line"> 1                     127.0.0.1             255.0.0.0          1       </span><br><span class="line"> 13                    192.168.10.56         255.255.255.0      1        </span><br><span class="line"> 10                    192.168.10.101        255.255.255.0      1        </span><br><span class="line"> 23                    192.168.10.1          255.255.255.0      1</span><br></pre></td></tr></table></figure><p>以上显示的信息，表示当前目标主机中所有的网络接口地址信息。从以上输出信息中，可以看到共有4个接口。其中，IP地址分别是127.0.0.1、192.168.10.56、192.168.10.101、192.168.10.1。</p></li><li><p>获取路由信息，如目标地址、下一跳地址、子网掩码和路径长度值。结果如下：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">[*] Routing information</span><br><span class="line">------------------------------------------------------------------</span><br><span class="line"> Destination               Next hop                    Mask                  Metric </span><br><span class="line"> 0.0.0.0                   192.168.10.1                0.0.0.0               20 </span><br><span class="line"> 127.0.0.1                 127.0.0.1                   255.255.255.255       109 </span><br><span class="line"> 192.168.10.1              192.168.10.1                255.255.255.0         276</span><br></pre></td></tr></table></figure><p>以上信息表示目标系统的一个路由表信息。该路由表包括目的地址、下一跳地址、子网掩码及距离。</p></li><li><p>获取监听的TCP端口，如监听的TCP端口号有135、139等。结果如下：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">[*] Listening TCP ports and connections</span><br><span class="line">--------------------------------------------------------------------</span><br><span class="line"> Local address        Local port             Remote address              Remote port          State</span><br><span class="line">   0.0.0.0              135                   0.0.0.0                     0                     listen</span><br><span class="line">   0.0.0.0              443                   0.0.0.0                     0                     listen</span><br><span class="line">   0.0.0.0              902                   0.0.0.0                     0                     listen</span><br><span class="line">   0.0.0.0              912                   0.0.0.0                     0                     listen</span><br><span class="line">   192.168.10.56        49878                 192.168.10.62               80                    timeWait</span><br><span class="line">   192.168.10.56        139                   192.168.10.203              80                    timeWait</span><br></pre></td></tr></table></figure><p>以上信息表示两台主机建立TCP连接后的信息，包括本地地址、本地端口、远端主机地址、远端主机端口和状态。</p></li><li><p>获取监听UDP端口信息，如监听的UDP端口有123、161、4500、500和5355等。结果如下：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">[*] Listening UDP ports</span><br><span class="line">------------------------------------------------------------------</span><br><span class="line">     Local Address                   Port</span><br><span class="line">      0.0.0.0                         123</span><br><span class="line">      0.0.0.0                         161</span><br><span class="line">      0.0.0.0                         4500</span><br><span class="line">      0.0.0.0                         500</span><br><span class="line">      0.0.0.0                         5355</span><br><span class="line">      127.0.0.1                       1900</span><br><span class="line">      127.0.0.1                       51030 </span><br><span class="line">      192.168.10.56                   137</span><br><span class="line">      192.168.10.56                   138 </span><br><span class="line">      192.168.10.56                   1900 </span><br><span class="line">      192.168.10.56                   52087</span><br></pre></td></tr></table></figure><p>以上信息表示目标主机中已开启的UDP端口号。</p></li><li><p>获取网络服务信息，如分布式组件对象模型服务、DHCP客户端，以及DNS客户端等。结果如下：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"> [*] Network services</span><br><span class="line"> ------------------------------------------------------------------</span><br><span class="line">Application Experience</span><br><span class="line"> Background Intelligent Transfer Service</span><br><span class="line"> Base Filtering Engine</span><br><span class="line"> COM+ Event System</span><br><span class="line"> COM+ System Application</span><br><span class="line"> Computer Browser</span><br><span class="line"> Cryptographic Services</span><br><span class="line"> DCOM Server Process Launcher</span><br><span class="line"> DHCP Client</span><br><span class="line"> DNS Client</span><br><span class="line"> ......</span><br></pre></td></tr></table></figure><p>以上信息显示了目标主机中所安装的服务。由于篇幅的原因，这里只列出了少部分服务。</p></li><li><p>获取进程信息，如进程ID、进程名和进程类型等。结果如下：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"> [*] Processes</span><br><span class="line"> --------------------------------------------------------------------</span><br><span class="line">Id            Status                     Name                  Path                    Parameters          </span><br><span class="line">1             running                    System Idle Process                                             </span><br><span class="line">4             running                    System                                                          </span><br><span class="line">340           running                    svchost.exe                                                     </span><br><span class="line">380           running                    smss.exe              \SystemRoot\System32\                      </span><br><span class="line">608           running                    MsMpEng.exe                                                     </span><br><span class="line">644           running                    csrss.exe             %SystemRoot%\system32\</span><br><span class="line">ObjectDirectory=\Windows SharedSection=1024,20480,768 Windows=On SubSystem</span><br><span class="line">Type=Windows ServerDll=basesrv,1 ServerDll=winsrv:User</span><br><span class="line">  680                   running               wininit.exe                      </span><br><span class="line">......</span><br></pre></td></tr></table></figure><p>从以上显示的信息可以看到共5列，分别是ID号、状态、进程名、路径和参数。由于篇幅的原因，这里仅简单列举了几个进程的相关信息。</p></li><li><p>获取存储信息，如设备ID、设备类型和文件系统类型等。结果如下：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"> [*] Storage information</span><br><span class="line"> -------------------------------------------------------------------</span><br><span class="line">Description                   : [<span class="string">"C:\\ Label:  Serial Number 7ec046bb"</span>]                                                                                                                                        <span class="comment">#描述信息</span></span><br><span class="line">  Device id                    : [<span class="comment">#&lt;SNMP::Integer:0x00000001d2bf80 @value=1&gt;]                                                                                                                                  #设备ID</span></span><br><span class="line">  Filesystem <span class="built_in">type</span>            : [<span class="string">"unknown"</span>]                                       <span class="comment">#文件系统类型</span></span><br><span class="line">  Device unit                 : [<span class="comment">#&lt;SNMP::Integer:0x00000001d28740 @value=4096&gt;]                                                                                                                                #设备单元</span></span><br><span class="line">  Memory size                 : 119.24 GB                                        <span class="comment">#内存总共大小</span></span><br><span class="line">  Memory used                 : 71.51 GB                                         <span class="comment">#已用内存大小</span></span><br><span class="line">  Description                 : [<span class="string">"D:\\ Label:  Serial Number 6af7072d"</span>]                                                                                                                                        <span class="comment">#描述信息</span></span><br><span class="line">  Device id                    : [<span class="comment">#&lt;SNMP::Integer:0x00000001d0a6c8 @value=2&gt;]                                                                                                                                  #设备ID</span></span><br><span class="line">  Filesystem <span class="built_in">type</span>            : [<span class="string">"unknown"</span>]                                       <span class="comment">#文件系统类型</span></span><br><span class="line">  Device unit                 : [<span class="comment">#&lt;SNMP::Integer:0x00000001d01dc0 @value=4096&gt;]                                                                                                                                #设备单元</span></span><br><span class="line">  Memory size                 : 3725.90 GB                                       <span class="comment">#内存总共大小</span></span><br><span class="line">  Memory used                 : 436.99 GB                                        <span class="comment">#已用内存大小</span></span><br><span class="line">  Description                 : [<span class="string">"E:\\"</span>]</span><br><span class="line">  Device id                    : [<span class="comment">#&lt;SNMP::Integer:0x00000001c15fd8 @value=3&gt;]</span></span><br><span class="line">  Filesystem <span class="built_in">type</span>            : [<span class="string">"unknown"</span>]</span><br><span class="line">  Device unit                 : [<span class="comment">#&lt;SNMP::Integer:0x00000001c0f930 @value=0&gt;]</span></span><br><span class="line">  Memory size                 : 0 bytes</span><br><span class="line">    Memory used                 : 0 bytes</span><br><span class="line">  Description                 : [<span class="string">"F:\\"</span>]</span><br><span class="line">  Device id                    : [<span class="comment">#&lt;SNMP::Integer:0x00000001bf2bc8 @value=4&gt;]</span></span><br><span class="line">  Filesystem <span class="built_in">type</span>            : [<span class="string">"unknown"</span>]</span><br><span class="line">  Device unit                 : [<span class="comment">#&lt;SNMP::Integer:0x00000001beb530 @value=0&gt;]</span></span><br><span class="line">  Memory size                 : 0 bytes</span><br><span class="line">  Memory used                 : 0 bytes</span><br><span class="line">  Description                 : [<span class="string">"Virtual Memory"</span>]</span><br><span class="line">  Device id                    : [<span class="comment">#&lt;SNMP::Integer:0x00000001bdccb0 @value=5&gt;]</span></span><br><span class="line">  Filesystem <span class="built_in">type</span>            : [<span class="string">"unknown"</span>]</span><br><span class="line">  Device unit                 : [<span class="comment">#&lt;SNMP::Integer:0x00000001bd62c0 @value=65536&gt;]</span></span><br><span class="line">  Memory size                 : 31.97 GB</span><br><span class="line">  Memory used                 : 7.12 GB</span><br><span class="line">  Description                 : [<span class="string">"Physical Memory"</span>]</span><br><span class="line">  Device id                    : [<span class="comment">#&lt;SNMP::Integer:0x00000001bb07a0 @value=6&gt;]</span></span><br><span class="line">  Filesystem <span class="built_in">type</span>            : [<span class="string">"unknown"</span>]</span><br><span class="line">  Device unit             : [<span class="comment">#&lt;SNMP::Integer:0x00000001ba49a0 @value=65536&gt;]</span></span><br><span class="line">  Memory size                   : 15.98 GB</span><br><span class="line">  Memory used                   : 7.57 GB</span><br></pre></td></tr></table></figure><p>该部分显示了系统中所有磁盘的信息。其中包括设备ID、文件系统类型、总空间大小及已用空间大小等。</p></li><li><p>获取文件系统信息，如索引、挂载点、远程挂载点及访问权限等。结果如下：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">[*] File system information:</span><br><span class="line"> Index                         : 1</span><br><span class="line"> Mount point                   : </span><br><span class="line"> Remote mount point            : -</span><br><span class="line"> Access                        : 1</span><br><span class="line"> Bootable                      : 1</span><br></pre></td></tr></table></figure><p>以上显示了当前目标主机的文件系统信息。从以上信息中可以看到，包括文件系统的索引、挂载点及访问权限等。</p></li><li><p>获取设备信息，如设备ID号、类型和状态等。结果如下：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"> [*] Devices information</span><br><span class="line"> -------------------------------------------------------------------</span><br><span class="line">    Id              Type             Status           Descr</span><br><span class="line">     1               Printer          Running          TP Output Gateway</span><br><span class="line">    10               Network          Unknown          WAN Miniport (L2TP)</span><br><span class="line">    11               Network          Unknown          WAN Miniport (PPTP)</span><br><span class="line">    12               Network          Unknown          WAN Miniport (PPPOE)</span><br><span class="line">......</span><br><span class="line">     6               Printer          Running          Microsoft Shared Fax Driver</span><br><span class="line">     7               Processor        Running          Intel</span><br><span class="line">     8               Network          Unknown          Software Loopback Interface 1</span><br><span class="line">     9               Network          Unknown          WAN Miniport (SSTP)</span><br></pre></td></tr></table></figure><p>以上信息显示了该系统中所有设备相关信息，如打印设备、网络设备和处理器等。</p></li><li><p>获取软件组件信息，如.Net框架、Visual C++2008等。显示结果如下：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">[*] Software components</span><br><span class="line">---------------------------------------------------------------------</span><br><span class="line"> Index     Name                </span><br><span class="line"> 1          Microsoft .NET Framework 4 Client Profile</span><br><span class="line"> 2          Microsoft .NET Framework 4 Client Profile </span><br><span class="line"> 3          Microsoft .NET Framework 4 Extended</span><br><span class="line"> 4          Microsoft .NET Framework 4 Extended </span><br><span class="line"> 5          Microsoft Security Essentials</span><br><span class="line"> 6          Microsoft Visual Studio 2010 Tools <span class="keyword">for</span> Office Runtime (x64)</span><br><span class="line"> 7          WinRAR 5.21 (64-λ) </span><br><span class="line"> 8          VMware Workstation  </span><br><span class="line"> 9          Microsoft Visual C++ 2010  x64 Redistributable - 10.0.40219</span><br><span class="line"> 10         Microsoft Visual C++ 2008 Redistributable - x64 9.0.30729.4148</span><br></pre></td></tr></table></figure><p>以上信息表示该主机中安装了Micosoft.NET Framework 4、Microsoft Security Essentials、Microsoft Visual Studio 2010及Visual C++2008库等。</p></li></ol><h2 id="七、信息分析和整理"><a href="#七、信息分析和整理" class="headerlink" title="七、信息分析和整理"></a>七、信息分析和整理</h2><p>通过使用前面介绍的方法，可以收集到目标主机的大量信息。为了方便后续实施渗透测试，用户需要将这些信息进行整理和分析。此时，用户可以借助Maltego工具来对信息进行分析和整理。</p><h3 id="7-1-配置Maltego"><a href="#7-1-配置Maltego" class="headerlink" title="7.1 配置Maltego"></a>7.1 配置Maltego</h3><p>Maltego是一款非常强大的信息收集工具。它不仅可以自动收集所需信息，还可以将收集的信息可视化，用一种图像化的方式将结果展现给用户。Kali Linux默认已经安装了Maltego工具所以用户可以直接使用。但是，在使用该工具之前，需要做一个简单的配置，如注册账号和选择启动模式等。下面将介绍对Maltego工具的配置。</p><h4 id="7-1-1-注册账号"><a href="#7-1-1-注册账号" class="headerlink" title="7.1.1 注册账号"></a>7.1.1 注册账号</h4><p>当用户使用Maltego工具时，需要登录其官网。所以，在启动该工具之前，需要先注册一个账号。其中，注册账号的地址如下：<br><a href="https://www.paterva.com/web7/community/community.php" target="_blank" rel="noopener">https://www.paterva.com/web7/community/community.php</a></p><p><code>提示：Maltego官网是一个国外网站。所以，国内用户在注册账号时，可能会发现没有显示验证码，当出现这种情况时，建议换个网络，或者过段时间再访问。</code></p><p>注册完成后，前往注册账号时使用的邮箱将会收到一份邮件，登录邮箱，将用户账户激活。</p><p>激活用户后，下载并安装Maltego程序。</p><h4 id="7-1-2-设置Maltego模式"><a href="#7-1-2-设置Maltego模式" class="headerlink" title="7.1.2 设置Maltego模式"></a>7.1.2 设置Maltego模式</h4><p>Maltego提供了两种模式，分别是Normal Privacy Mode（普通隐私模式）和Stealth Privacy Mode（隐蔽隐私模式）。其中，Normal Privacy Mode模式可以获取更多的信息。而且，允许用户直接使用互联网中的数据，如实体图片和Web站点信息；Stealth Privacy Mode模式更多用来简单分析信息，尤其是当前计算机没有网络时使用。使用这种模式，将无法直接从互联网中获取数据。所以为了能够获取更多信息，建议选择Normal Privacy Mode模式。下面将介绍具体设置Maltego模式的方法。</p><p>设置Maltego的模式为Normal Privacy Mode。具体操作步骤如下：</p><ol><li><p>在图形界面的菜单栏中依次选择“应用程序”|“信息收集”|maltego命令，将显示Maltego产品选择对话框，如下图所示。</p><p><img src="/2020/12/14/kali-shen-tou-ce-shi/%E5%9B%BE%E7%89%873.png" alt="图片3"></p></li><li><p>在该对话框中显示了可以使用的Maltego产品，包括Maltego One、Maltego XL、Maltego Classic、Maltego CE(Free)和Maltego CaseFile(Free)。其中，Maltego XL、Maltego Classic是收费的；Maltego CE和Maltego CaseFile是免费的。这里将选择免费的Maltego工具，所以单击Maltego CE(Free)下面的运行按钮，将显示如下图所示的对话框。</p><p><img src="/2020/12/14/kali-shen-tou-ce-shi/%E5%9B%BE%E7%89%874.png" alt="图片4"></p></li><li><p>该对话框显示了许可协议信息。选择Accept复选框，然后单击Next按钮，将显示登录对话框，如下图所示。</p><p><img src="/2020/12/14/kali-shen-tou-ce-shi/%E5%9B%BE%E7%89%875.png" alt="图片5"></p></li><li><p>在该对话框中输入前面注册的账户信息（邮件地址、密码和验证码），登录Maltego服务器。然后单击Next按钮，将显示登录结果，如下图所示。</p><p><img src="/2020/12/14/kali-shen-tou-ce-shi/%E5%9B%BE%E7%89%876.png" alt="图片6"></p></li><li><p>该对话框显示了登录的结果。从该对话框中可以看到登录的用户名、邮箱地址及登录时间等信息。后续步骤只需要单击Next按钮，即可完成安装。</p></li></ol><h3 id="7-2-使用Maltego工具"><a href="#7-2-使用Maltego工具" class="headerlink" title="7.2 使用Maltego工具"></a>7.2 使用Maltego工具</h3><p>通过前面的配置，Maltego工具可以正常使用了。用户可以使用Maltego工具，将前面收集到的信息进行整理并分析。而且，还可以使用Maltego的Transforms来获取更多的信息。在Maltego中提供了大量的实体，用来表示信息节点。例如，域名信息可以使用Domain实体表示一个域名。下面来介绍使用Maltego工具整理并分析信息的方法。</p><h4 id="7-2-1-整理及分析主机信息"><a href="#7-2-1-整理及分析主机信息" class="headerlink" title="7.2.1 整理及分析主机信息"></a>7.2.1 整理及分析主机信息</h4><p>通过前面的信息收集，可知局域网中活动的主机、主机开放的端口、服务及操作系统类型。下面将介绍通过IP地址实体来整理及分析主机信息。</p><p>使用Maltego工具整理主机信息并分析。具体操作步骤如下：</p><ol><li><p>启动Maltego工具，将显示如下图所示的界面。</p><p><img src="/2020/12/14/kali-shen-tou-ce-shi/%E5%9B%BE%E7%89%877.png" alt="图片7"></p></li></ol><ol start="2"><li><p>在该界面左侧栏中显示了所有可用的实体。这里将选择IP地址实体，整理收集的主机相关信息。选择IPv4 Address实体，并拖拽到图表中，将显示如下图所示的界面。</p><p><img src="/2020/12/14/kali-shen-tou-ce-shi/%E5%9B%BE%E7%89%878.png" alt="图片8"></p></li></ol><ol start="3"><li><p>从该界面中可以看到，在图表中添加了一个IP地址实体，默认该实体的IP地址为74.207.243.85。此时，用户可以修改该地址为用户探测到的活动主机地址，如192.168.29.136。用户通过双击实体的IP地址，或者修改属性IP Address值修改该实体的地址，如下图所示。</p><p><img src="/2020/12/14/kali-shen-tou-ce-shi/%E5%9B%BE%E7%89%879.png" alt="图片9"></p></li></ol><ol start="4"><li><p>从该界面中可以看到，成功修改了IP地址实体的值。此时，用户以同样的方式，将端口（Port）和服务（Service）实体拖拽到图表中，整理该主机的相关信息，如下图所示。</p><p><img src="/2020/12/14/kali-shen-tou-ce-shi/%E5%9B%BE%E7%89%8710.png" alt="图片10"></p></li></ol><ol start="5"><li><p>从该界面可以看到添加的端口和服务实体。其中，端口默认属性值为0；服务默认属性值为80/Apache 9。用户可以根据自己收集的信息修改实体属性值。通过整理前面收集的信息可知该主机开放的端口有21、22、80、135和139，对应的服务为FTP、SSH、HTTP、msrpc和netbios-ssn等。这里将这些信息进行整理后，显示界面如下图所示。</p><p><img src="/2020/12/14/kali-shen-tou-ce-shi/%E5%9B%BE%E7%89%8711.png" alt="图片11"></p></li></ol><ol start="6"><li><p>此时，将收集到的信息都整理出来了。为了方便分析及查看更直观，用户可以通过连接线将它们之间的关系关联起来。例如，这里将主机IP地址与端口之间使用连接线连接起来。在IP地址实体（192.168.29.136）附近单击鼠标，将会延伸出一根线条，然后单击端口实体即可。此时，将会弹出一个对话框，如下图所示。</p><p><img src="/2020/12/14/kali-shen-tou-ce-shi/%E5%9B%BE%E7%89%8712.png" alt="图片12"></p></li></ol><ol start="7"><li><p>该对话框中的信息是用来设置连接线的，如Label（标签）、Color（颜色）、Style（线条风格）和Thickness（线条粗细）等。这里将设置线条的标签为port、颜色为红色，其他选项使用默认值。</p></li><li><p>单击OK按钮，即可看到添加的连接线，如下图所示。</p><p><img src="/2020/12/14/kali-shen-tou-ce-shi/%E5%9B%BE%E7%89%8713.png" alt="图片13"></p></li></ol><ol start="9"><li><p>从该界面中可以看到，成功将IP地址实体和端口实体建立了关系。用户使用同样的方法，可以将其他实体之间的关系用连接线连接起来，并通过标签标记实体信息，如下图所示。</p><p><img src="/2020/12/14/kali-shen-tou-ce-shi/%E5%9B%BE%E7%89%8714.png" alt="图片14"></p></li></ol><ol start="10"><li>从该界面可以更直观地看到收集的信息，使用起来也更方便。此时，用户还可以使用Maltego提供的Transforms来收集更多的信息，如IP所有者信息、网络信息和历史信息等。</li></ol><h4 id="7-2-1-整理并分析域名信息"><a href="#7-2-1-整理并分析域名信息" class="headerlink" title="7.2.1 整理并分析域名信息"></a>7.2.1 整理并分析域名信息</h4><p>通过分析前面收集的信息，可知收集到的域名WHOIS信息、子域名及服务器信息等。</p><p>使用Maltego工具整理域名信息并分析。具体操作步骤如下：</p><ol><li><p>在Maltego中打开一个新的图表，避免与前面的信息混淆。单击菜单栏中的新建图表按钮，即可打开一个新的图表，如下图所示。</p><p><img src="/2020/12/14/kali-shen-tou-ce-shi/%E5%9B%BE%E7%89%8715.png" alt="图片15"></p></li></ol><ol start="2"><li><p>从该界面可以看到打开了一个新的图表，其名称为New Graph(2)。这里选择域名实体（Domain）来整理并分析域名信息。在实体面板中选择Domain实体并拖拽到图表中，然后修改该实体的域名为baidu.com，如下图所示。</p><p><img src="/2020/12/14/kali-shen-tou-ce-shi/%E5%9B%BE%E7%89%8716.png" alt="图片16"></p></li></ol><ol start="3"><li><p>通过分析前面收集的信息，可以看到获取了该域名的WHOIS信息、子域名及服务器信息。例如，这里整理收集到域名baidu.com的子域名。其中，找到的子域名有<a href="http://www.baidu.com" target="_blank" rel="noopener">www.baidu.com</a> 、news.baidu.com和map.baidu.com等。其中，用来表示子域名的实体名为DNS Name。所以，在实体列表中选择DNS Name实体并拖拽到图表中，然后修改该实体名为对应的子域名，如下图所示。</p><p><img src="/2020/12/14/kali-shen-tou-ce-shi/%E5%9B%BE%E7%89%8717.png" alt="图片17"></p></li></ol><ol start="4"><li><p>从该界面可以看到整理的子域名信息。同样，用户可以使用连接线将它们建立连接，如下图所示。</p><p><img src="/2020/12/14/kali-shen-tou-ce-shi/%E5%9B%BE%E7%89%8718.png" alt="图片18"></p></li></ol><ol start="5"><li>从该界面可以看到，对收集的域名进行了整理。而且，可以很直观地看到域名baidu.com对应的所有子域名。此时，用户使用Maltego的Transform还可以收集该域名及子域名更多的信息，如域名注册商、子域名和WHOIS信息等。</li></ol><h4 id="7-2-3-使用Transform收集信息"><a href="#7-2-3-使用Transform收集信息" class="headerlink" title="7.2.3 使用Transform收集信息"></a>7.2.3 使用Transform收集信息</h4><p>Maltego提供了大量的Transform，可以用来收集更多的信息。这里将以域名实体为例，获取更多的信息。</p><p>使用Transform收集域名baidu.com相关的信息。具体操作步骤如下：</p><ol><li><p>选择Domain实体拖拽到一个新的图表中，并修改域名为baidu.com，如下图所示。</p><p><img src="/2020/12/14/kali-shen-tou-ce-shi/%E5%9B%BE%E7%89%8719.png" alt="图片19"></p></li></ol><ol start="2"><li><p>选择域名实体并单击右键，将显示所有可用的Transform列表，如下图所示。</p><p><img src="/2020/12/14/kali-shen-tou-ce-shi/%E5%9B%BE%E7%89%8720.png" alt="图片20"></p></li></ol><ol start="3"><li><p>从该界面可以看到，针对域名实体可以使用的Transform集，如Shodan、ThreatMiner和Farsight DNSDB等。如果用户想要查看所有Transform，单击All Transforms选项，即可看到所有的Transform；如果想查看某个Transform集，则单击对应的Transform即可。这里单击All Transforms选项，展开所有Transform列表，如下图所示。</p><p><img src="/2020/12/14/kali-shen-tou-ce-shi/%E5%9B%BE%E7%89%8721.png" alt="图片21"></p></li></ol><ol start="4"><li><p>此时，用户选择任意一个Transform，即可获取对应的信息。例如，使用To Domain[Find other TLDs]这个Transform，查找该域名的其他顶级域。在上图中单击To Domain[Find other TLDs]选项，即可获取所有的其他顶级域，如下图所示。</p><p><img src="/2020/12/14/kali-shen-tou-ce-shi/%E5%9B%BE%E7%89%8722.png" alt="图片22"></p></li></ol><ol start="5"><li>从该界面可以看到，成功收集到了域名baidu.com的其他顶级域名，如baidu.actor、baidu.al及baidu.at等。</li></ol></div><div><div><div style="text-align:center;color:#ccc;font-size:14px">-------------本文结束<i class="fa fa-paw"></i>感谢您的阅读-------------</div></div></div><div></div><footer class="post-footer"><div class="post-tags"><a href="/tags/Kali/" rel="tag"><i class="fa fa-tag"></i> Kali</a> <a href="/tags/%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95/" rel="tag"><i class="fa fa-tag"></i> 渗透测试</a></div><div class="post-nav"><div class="post-nav-next post-nav-item"><a href="/2020/12/03/prometheus-jian-kong-rabbitmq/" rel="next" title="Prometheus 监控 Rabbitmq"><i class="fa fa-chevron-left"></i> Prometheus 监控 Rabbitmq</a></div><span class="post-nav-divider"></span><div class="post-nav-prev post-nav-item"><a href="/2020/12/15/kali-sao-miao-lou-dong/" rel="prev" title="扫描漏洞">扫描漏洞 <i class="fa fa-chevron-right"></i></a></div></div></footer></div></article><div class="post-spread"><div class="jiathis_style"><span class="jiathis_txt">分享到：</span> <a class="jiathis_button_fav">收藏夹</a> <a class="jiathis_button_copy">复制网址</a> <a class="jiathis_button_email">邮件</a> <a class="jiathis_button_weixin">微信</a> <a class="jiathis_button_qzone">QQ空间</a> <a class="jiathis_button_tqq">腾讯微博</a> <a class="jiathis_button_douban">豆瓣</a> <a class="jiathis_button_share">一键分享</a> <a href="http://www.jiathis.com/share?uid=2140465" class="jiathis jiathis_txt jiathis_separator jtico jtico_jiathis" target="_blank">更多</a> <a class="jiathis_counter_style"></a></div><script type="text/javascript">var jiathis_config={data_track_clickback:!0,summary:"",shortUrl:!1,hideMore:!1}</script><script type="text/javascript" src="http://v3.jiathis.com/code/jia.js?uid=" charset="utf-8"></script></div></div></div></div><div class="sidebar-toggle"><div class="sidebar-toggle-line-wrap"><span class="sidebar-toggle-line sidebar-toggle-line-first"></span> <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span> <span class="sidebar-toggle-line sidebar-toggle-line-last"></span></div></div><aside id="sidebar" class="sidebar"><div id="sidebar-dimmer"></div><div class="sidebar-inner"><ul class="sidebar-nav motion-element"><li class="sidebar-nav-toc sidebar-nav-active" data-target="post-toc-wrap">文章目录</li><li class="sidebar-nav-overview" data-target="site-overview-wrap">站点概览</li></ul><section class="site-overview-wrap sidebar-panel"><div class="site-overview"><div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person"><img class="site-author-image" itemprop="image" src="/images/chen.png" alt="Zhongzhou Chen"><p class="site-author-name" itemprop="name">Zhongzhou Chen</p><p class="site-description motion-element" itemprop="description"></p></div><nav class="site-state motion-element"><div class="site-state-item site-state-posts"><a href="/archives/%7C%7C%20archive"><span class="site-state-item-count">283</span> <span class="site-state-item-name">日志</span></a></div><div class="site-state-item site-state-categories"><a href="/categories/index.html"><span class="site-state-item-count">84</span> <span class="site-state-item-name">分类</span></a></div><div class="site-state-item site-state-tags"><a href="/tags/index.html"><span class="site-state-item-count">164</span> <span class="site-state-item-name">标签</span></a></div></nav><div class="feed-link motion-element"><a href="/atom.xml" rel="alternate"><i class="fa fa-rss"></i> RSS</a></div></div></section><section class="post-toc-wrap motion-element sidebar-panel sidebar-panel-active"><div class="post-toc"><div class="post-toc-content"><ol class="nav"><li class="nav-item nav-level-1"><a class="nav-link" href="#使用-Kali-进行信息收集"><span class="nav-text">使用 Kali 进行信息收集</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#一、发现主机"><span class="nav-text">一、发现主机</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#1-1-扫描主机"><span class="nav-text">1.1 扫描主机</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#1-1-1-使用Nmap工具"><span class="nav-text">1.1.1 使用Nmap工具</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#1-1-2-使用Netdiscover工具"><span class="nav-text">1.1.2 使用Netdiscover工具</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#1-2-监听发现主机"><span class="nav-text">1.2 监听发现主机</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#1-2-1-ARP监听"><span class="nav-text">1.2.1 ARP监听</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#1-2-2-DHCP监听"><span class="nav-text">1.2.2 DHCP监听</span></a></li></ol></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#二、域名分析"><span class="nav-text">二、域名分析</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#2-1-域名基础信息"><span class="nav-text">2.1 域名基础信息</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#2-1-1-使用WHOIS工具"><span class="nav-text">2.1.1 使用WHOIS工具</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#2-1-2-使用DMitry工具"><span class="nav-text">2.1.2 使用DMitry工具</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#2-2-查找子域名"><span class="nav-text">2.2 查找子域名</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#2-2-1-使用Dmitry工具"><span class="nav-text">2.2.1 使用Dmitry工具</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#2-2-2-在线查询"><span class="nav-text">2.2.2 在线查询</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#2-3-发现服务器"><span class="nav-text">2.3 发现服务器</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#2-3-1-使用Dnsenum工具"><span class="nav-text">2.3.1 使用Dnsenum工具</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#2-3-2-使用Nslookup工具"><span class="nav-text">2.3.2 使用Nslookup工具</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#2-3-3-使用Ping命令"><span class="nav-text">2.3.3 使用Ping命令</span></a></li></ol></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#三、扫描端口"><span class="nav-text">三、扫描端口</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#3-1-端口简介"><span class="nav-text">3.1 端口简介</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#3-2-实施端口扫描"><span class="nav-text">3.2 实施端口扫描</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#3-2-1-使用Nmap工具"><span class="nav-text">3.2.1 使用Nmap工具</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#3-2-2-使用DMitry工具"><span class="nav-text">3.2.2 使用DMitry工具</span></a></li></ol></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#四、识别操作系统"><span class="nav-text">四、识别操作系统</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#4-1-基于TTL识别"><span class="nav-text">4.1 基于TTL识别</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#4-2-使用NMAP识别"><span class="nav-text">4.2 使用NMAP识别</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#五、识别服务"><span class="nav-text">五、识别服务</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#5-1-使用Nmap工具"><span class="nav-text">5.1 使用Nmap工具</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#5-2-使用Amap工具"><span class="nav-text">5.2 使用Amap工具</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#5-2-1-使用amapcrap工具"><span class="nav-text">5.2.1 使用amapcrap工具</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#5-2-2-使用amap工具"><span class="nav-text">5.2.2 使用amap工具</span></a></li></ol></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#六、收集服务信息"><span class="nav-text">六、收集服务信息</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#6-1-SMB服务"><span class="nav-text">6.1 SMB服务</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#6-2-SNMP服务"><span class="nav-text">6.2 SNMP服务</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#七、信息分析和整理"><span class="nav-text">七、信息分析和整理</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#7-1-配置Maltego"><span class="nav-text">7.1 配置Maltego</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#7-1-1-注册账号"><span class="nav-text">7.1.1 注册账号</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#7-1-2-设置Maltego模式"><span class="nav-text">7.1.2 设置Maltego模式</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#7-2-使用Maltego工具"><span class="nav-text">7.2 使用Maltego工具</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#7-2-1-整理及分析主机信息"><span class="nav-text">7.2.1 整理及分析主机信息</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#7-2-1-整理并分析域名信息"><span class="nav-text">7.2.1 整理并分析域名信息</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#7-2-3-使用Transform收集信息"><span class="nav-text">7.2.3 使用Transform收集信息</span></a></li></ol></li></ol></li></ol></li></ol></div></div></section><div class="back-to-top"><i class="fa fa-arrow-up"></i> <span id="scrollpercent"><span>0</span>%</span></div></div></aside></div></main><footer id="footer" class="footer"><div class="footer-inner"><script async src="https://dn-lbstatics.qbox.me/busuanzi/2.3/busuanzi.pure.mini.js"></script><div class="copyright">&copy; <span itemprop="copyrightYear">2021</span> <span class="with-love"><i class="fa fa-user"></i> </span><span class="author" itemprop="copyrightHolder">Zhongzhou Chen</span> <span class="post-meta-divider">|</span> <span class="post-meta-item-icon"><i class="fa fa-area-chart"></i> </span><span class="post-meta-item-text">Site words total count&#58;</span> <span title="Site words total count">597.5k</span></div><span class="post-meta-divider"></span></div></footer></div><script type="text/javascript">"[object Function]"!==Object.prototype.toString.call(window.Promise)&&(window.Promise=null)</script><script type="text/javascript" src="/lib/jquery/index.js?v=2.1.3"></script><script type="text/javascript" src="/lib/fastclick/lib/fastclick.min.js?v=1.0.6"></script><script type="text/javascript" src="/lib/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script><script type="text/javascript" src="/lib/velocity/velocity.min.js?v=1.2.1"></script><script type="text/javascript" src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script><script type="text/javascript" src="/lib/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script><script type="text/javascript" src="/js/src/utils.js?v=5.1.4"></script><script type="text/javascript" src="/js/src/motion.js?v=5.1.4"></script><script type="text/javascript" src="/js/src/affix.js?v=5.1.4"></script><script type="text/javascript" src="/js/src/schemes/pisces.js?v=5.1.4"></script><script type="text/javascript" src="/js/src/scrollspy.js?v=5.1.4"></script><script type="text/javascript" src="/js/src/post-details.js?v=5.1.4"></script><script type="text/javascript" src="/js/src/bootstrap.js?v=5.1.4"></script><script type="text/javascript">function proceedsearch(){$("body").append('<div class="search-popup-overlay local-search-pop-overlay"></div>').css("overflow","hidden"),$(".search-popup-overlay").click(onPopupClose),$(".popup").toggle();var t=$("#local-search-input");t.attr("autocapitalize","none"),t.attr("autocorrect","off"),t.focus()}var isfetched=!1,isXml=!0,search_path="search.xml";0===search_path.length?search_path="search.xml":/json$/i.test(search_path)&&(isXml=!1);var path="/"+search_path,onPopupClose=function(t){$(".popup").hide(),$("#local-search-input").val(""),$(".search-result-list").remove(),$("#no-result").remove(),$(".local-search-pop-overlay").remove(),$("body").css("overflow","")},searchFunc=function(t,e,o){"use strict";$("body").append('<div class="search-popup-overlay local-search-pop-overlay"><div id="search-loading-icon"><i class="fa fa-spinner fa-pulse fa-5x fa-fw"></i></div></div>').css("overflow","hidden"),$("#search-loading-icon").css("margin","20% auto 0 auto").css("text-align","center"),$.ajax({url:t,dataType:isXml?"xml":"json",async:!0,success:function(t){isfetched=!0,$(".popup").detach().appendTo(".header-inner");var n=isXml?$("entry",t).map(function(){return{title:$("title",this).text(),content:$("content",this).text(),url:$("url",this).text()}}).get():t,r=document.getElementById(e),s=document.getElementById(o),a=function(){var t=r.value.trim().toLowerCase(),e=t.split(/[\s\-]+/);e.length>1&&e.push(t);var o=[];if(t.length>0&&n.forEach(function(n){function r(e,o,n,r){for(var s=r[r.length-1],a=s.position,i=s.word,l=[],h=0;a+i.length<=n&&0!=r.length;){i===t&&h++,l.push({position:a,length:i.length});var p=a+i.length;for(r.pop();0!=r.length&&(s=r[r.length-1],a=s.position,i=s.word,p>a);)r.pop()}return c+=h,{hits:l,start:o,end:n,searchTextCount:h}}function s(t,e){var o="",n=e.start;return e.hits.forEach(function(e){o+=t.substring(n,e.position);var r=e.position+e.length;o+='<b class="search-keyword">'+t.substring(e.position,r)+"</b>",n=r}),o+=t.substring(n,e.end)}var a=!1,i=0,c=0,l=n.title.trim(),h=l.toLowerCase(),p=n.content.trim().replace(/<[^>]+>/g,""),u=p.toLowerCase(),f=decodeURIComponent(n.url),d=[],g=[];if(""!=l&&(e.forEach(function(t){function e(t,e,o){var n=t.length;if(0===n)return[];var r=0,s=[],a=[];for(o||(e=e.toLowerCase(),t=t.toLowerCase());(s=e.indexOf(t,r))>-1;)a.push({position:s,word:t}),r=s+n;return a}d=d.concat(e(t,h,!1)),g=g.concat(e(t,u,!1))}),(d.length>0||g.length>0)&&(a=!0,i=d.length+g.length)),a){[d,g].forEach(function(t){t.sort(function(t,e){return e.position!==t.position?e.position-t.position:t.word.length-e.word.length})});var v=[];0!=d.length&&v.push(r(l,0,l.length,d));for(var $=[];0!=g.length;){var C=g[g.length-1],m=C.position,x=C.word,w=m-20,y=m+80;0>w&&(w=0),y<m+x.length&&(y=m+x.length),y>p.length&&(y=p.length),$.push(r(p,w,y,g))}$.sort(function(t,e){return t.searchTextCount!==e.searchTextCount?e.searchTextCount-t.searchTextCount:t.hits.length!==e.hits.length?e.hits.length-t.hits.length:t.start-e.start});var T=parseInt("1");T>=0&&($=$.slice(0,T));var b="";b+=0!=v.length?"<li><a href='"+f+"' class='search-result-title'>"+s(l,v[0])+"</a>":"<li><a href='"+f+"' class='search-result-title'>"+l+"</a>",$.forEach(function(t){b+="<a href='"+f+'\'><p class="search-result">'+s(p,t)+"...</p></a>"}),b+="</li>",o.push({item:b,searchTextCount:c,hitCount:i,id:o.length})}}),1===e.length&&""===e[0])s.innerHTML='<div id="no-result"><i class="fa fa-search fa-5x" /></div>';else if(0===o.length)s.innerHTML='<div id="no-result"><i class="fa fa-frown-o fa-5x" /></div>';else{o.sort(function(t,e){return t.searchTextCount!==e.searchTextCount?e.searchTextCount-t.searchTextCount:t.hitCount!==e.hitCount?e.hitCount-t.hitCount:e.id-t.id});var a='<ul class="search-result-list">';o.forEach(function(t){a+=t.item}),a+="</ul>",s.innerHTML=a}};r.addEventListener("input",a),$(".local-search-pop-overlay").remove(),$("body").css("overflow",""),proceedsearch()}})};$(".popup-trigger").click(function(t){t.stopPropagation(),isfetched===!1?searchFunc(path,"local-search-input","local-search-result"):proceedsearch()}),$(".popup-btn-close").click(onPopupClose),$(".popup").click(function(t){t.stopPropagation()}),$(document).on("keyup",function(t){var e=27===t.which&&$(".search-popup").is(":visible");e&&onPopupClose()})</script><script type="text/javascript" src="/js/src/clipboard.min.js"></script><script type="text/javascript" src="/js/src/clipboard-use.js"></script><script type="text/javascript" src="/js/src/love.js"></script><script src="/live2dw/lib/L2Dwidget.min.js?094cbace49a39548bed64abff5988b05"></script><script>L2Dwidget.init({pluginRootPath:"live2dw/",pluginJsPath:"lib/",pluginModelPath:"assets/",tagMode:!1,log:!1,model:{jsonPath:"/live2dw/assets/shizuku.model.json"},display:{position:"right"},mobile:{show:!0,scale:.5},react:{opacityDefault:.7,opacityOnHover:.2}})</script></body></html><!-- rebuild by neat -->